
EnvironmentNameNotFound: Could not find conda environment: snakemake
You can list all discoverable environments with `conda info --envs`.


Building DAG of jobs...
Unlocked working directory.
Config file config/config.default.yaml is extended by additional config specified via the command line.
Config file /dss/dssfs02/lwp-dss-0001/pn39ci/pn39ci-dss-0000/MA_Git/config/config.scenarios.low.yaml is extended by additional config specified via the command line.
Assuming unrestricted shared filesystem usage.
host: teramem2
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job                                                 count
------------------------------------------------  -------
add_brownfield                                         36
add_electricity                                         1
add_existing_baseyear                                   4
add_transmission_projects_and_dlr                       1
all                                                     1
base_network                                            1
build_ammonia_production                                1
build_biomass_potentials                               10
build_central_heating_temperature_profiles              1
build_clustered_population_layouts                      1
build_cop_profiles                                      1
build_daily_heat_demand                                 1
build_district_heat_share                              10
build_electricity_demand                                1
build_electricity_demand_base                           1
build_energy_totals                                     1
build_existing_heating_distribution                     1
build_gas_input_locations                               1
build_gas_network                                       1
build_heat_totals                                       1
build_hourly_heat_demand                                1
build_hydro_profile                                     1
build_industrial_distribution_key                       1
build_industrial_energy_demand_per_country_today        1
build_industrial_energy_demand_per_node                10
build_industrial_energy_demand_per_node_today           1
build_industrial_production_per_country                 1
build_industrial_production_per_country_tomorrow       10
build_industrial_production_per_node                   10
build_industry_sector_ratios                            1
build_industry_sector_ratios_intermediate              10
build_population_layouts                                1
build_population_weighted_energy_totals                 2
build_powerplants                                       1
build_renewable_profiles                                6
build_salt_cavern_potentials                            1
build_shapes                                            1
build_ship_raster                                       1
build_shipping_demand                                   1
build_solar_thermal_profiles                            1
build_temperature_profiles                              1
build_transmission_projects                             1
build_transport_demand                                  1
cluster_gas_network                                     1
cluster_network                                         1
determine_availability_matrix                           6
make_summary                                            4
plot_hydrogen_network                                  40
plot_power_network                                     40
plot_power_network_clustered                            1
plot_summary                                            4
prepare_network                                         1
prepare_sector_network                                 40
simplify_network                                        1
solve_sector_network_myopic                            40
time_aggregation                                        1
total                                                 321

Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 08:20:06 2024]
localrule build_electricity_demand:
    input: data/electricity_demand_raw.csv, data/load_synthetic_raw.csv
    output: resources/electricity_demand.csv
    log: logs/build_electricity_demand.log
    jobid: 22
    reason: Missing output files: resources/electricity_demand.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=5000, mem_mib=4769

[Sat Sep 21 08:20:06 2024]
localrule build_gas_network:
    input: data/gas_network/scigrid-gas/data/IGGIELGN_PipeSegments.geojson
    output: resources/gas_network.csv
    log: logs/build_gas_network.log
    jobid: 30
    reason: Missing output files: resources/gas_network.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=4000, mem_mib=3815

INFO:__main__:Linearly interpolate gaps of size 3 and less.
INFO:__main__:Filling larger gaps by copying time-slices of period '1w'.
INFO:__main__:Supplement missing data with synthetic data.
[Sat Sep 21 08:20:18 2024]
Finished job 22.
1 of 321 steps (0.3%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:20:18 2024]
localrule build_ship_raster:
    input: data/shipdensity_global.zip, cutouts/europe-2013-sarah3-era5.nc
    output: resources/shipdensity_raster.tif
    log: logs/build_ship_raster.log
    jobid: 9
    benchmark: benchmarks/build_ship_raster
    reason: Missing output files: resources/shipdensity_raster.tif
    resources: tmpdir=/tmp/go73lez2, mem_mb=5000, mem_mib=4769

Matplotlib is building the font cache; this may take a moment.
WARNING:pyogrio._io:Skipping field country_code: unsupported OGR type: 5
[Sat Sep 21 08:20:37 2024]
Finished job 30.
2 of 321 steps (1%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:20:37 2024]
localrule build_shapes:
    input: data/naturalearth/ne_10m_admin_0_countries_deu.shp, data/eez/World_EEZ_v12_20231025_LR/eez_v12_lowres.gpkg, data/nuts/NUTS_RG_03M_2013_4326_LEVL_3.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/bundle/nama_10r_3gdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls
    output: resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/europe_shape.geojson, resources/nuts3_shapes.geojson
    log: logs/build_shapes.log
    jobid: 11
    reason: Missing output files: resources/europe_shape.geojson, resources/nuts3_shapes.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    resources: tmpdir=/tmp/go73lez2, mem_mb=1500, mem_mib=1431

INFO:pyogrio._io:Created 34 records
INFO:pyogrio._io:Created 25 records
INFO:pyogrio._io:Created 1 records
INFO:pyogrio._io:Created 1,383 records
[Sat Sep 21 08:20:47 2024]
Finished job 11.
3 of 321 steps (1%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:20:47 2024]
localrule build_ammonia_production:
    input: data/myb1-2022-nitro-ert.xlsx
    output: resources/ammonia_production.csv
    log: logs/build_ammonia_production.log
    jobid: 66
    benchmark: benchmarks/build_ammonia_production
    reason: Missing output files: resources/ammonia_production.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:20:51 2024]
Finished job 66.
4 of 321 steps (1%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:20:51 2024]
localrule build_hydro_profile:
    input: resources/country_shapes.geojson, data/eia_hydro_annual_generation.csv, data/eia_hydro_annual_capacity.csv, data/era5-annual-runoff-per-country.csv, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_hydro.nc
    log: logs/build_hydro_profile.log
    jobid: 43
    reason: Missing output files: resources/profile_hydro.nc; Input files updated by another job: resources/country_shapes.geojson
    resources: tmpdir=/tmp/go73lez2, mem_mb=5000, mem_mib=4769

WARNING:country_converter.country_converter:Eurasia not found in regex
INFO:atlite.convert:Convert and aggregate 'runoff'.
[Sat Sep 21 08:21:15 2024]
Finished job 9.
5 of 321 steps (2%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:21:15 2024]
localrule build_industry_sector_ratios:
    input: resources/ammonia_production.csv, data/jrc-idees-2021
    output: resources/industry_sector_ratios.csv
    log: logs/build_industry_sector_ratios.log
    jobid: 65
    benchmark: benchmarks/build_industry_sector_ratios
    reason: Missing output files: resources/industry_sector_ratios.csv; Input files updated by another job: resources/ammonia_production.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:21:23 2024]
Finished job 65.
6 of 321 steps (2%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:21:23 2024]
localrule base_network:
    input: data/osm-prebuilt/0.4/links.csv, data/osm-prebuilt/0.4/transformers.csv, data/osm-prebuilt/0.4/lines.csv, data/osm-prebuilt/0.4/buses.csv, data/osm-prebuilt/0.4/converters.csv, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/europe_shape.geojson
    output: resources/networks/base.nc, resources/regions_onshore.geojson, resources/regions_offshore.geojson
    log: logs/base_network.log
    jobid: 18
    benchmark: benchmarks/base_network
    reason: Missing output files: resources/regions_offshore.geojson, resources/networks/base.nc, resources/regions_onshore.geojson; Input files updated by another job: resources/europe_shape.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    resources: tmpdir=/tmp/go73lez2, mem_mb=1500, mem_mib=1431

INFO:__main__:Creating base network using osm-prebuilt v0.4.
INFO:__main__:Removing buses outside of range AC 200.0 - 750.0 V
INFO:__main__:Removing 0 unconnected network components with less than nan buses. In total 0 buses.
INFO:pyogrio._io:Created 5,442 records
INFO:pyogrio._io:Created 1,072 records
INFO:pypsa.io:Exported network 'base.nc' contains: links, transformers, buses, shapes, carriers, lines
[Sat Sep 21 08:22:01 2024]
Finished job 18.
7 of 321 steps (2%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:22:01 2024]
localrule build_transmission_projects:
    input: resources/networks/base.nc, resources/offshore_shapes.geojson, resources/europe_shape.geojson, data/transmission_projects/tyndp2020, data/transmission_projects/nep, data/transmission_projects/manual
    output: resources/transmission_projects/new_lines.csv, resources/transmission_projects/new_links.csv, resources/transmission_projects/adjust_lines.csv, resources/transmission_projects/adjust_links.csv, resources/transmission_projects/new_buses.csv
    log: logs/build_transmission_projects.log
    jobid: 20
    benchmark: benchmarks/build_transmission_projects
    reason: Missing output files: resources/transmission_projects/new_buses.csv, resources/transmission_projects/adjust_links.csv, resources/transmission_projects/new_links.csv, resources/transmission_projects/adjust_lines.csv, resources/transmission_projects/new_lines.csv; Input files updated by another job: resources/networks/base.nc, resources/europe_shape.geojson, resources/offshore_shapes.geojson
    resources: tmpdir=/tmp/go73lez2, mem_mb=4000, mem_mib=3815

INFO:pypsa.io:Imported network base.nc has buses, carriers, lines, links, shapes, transformers
INFO:root:Processing new lines projects from tyndp2020.
WARNING:__main__:Found new lines similar to existing lines:
{'TYNDP2020_32': '196723099-b', 'TYNDP2020_38': '209262460', 'TYNDP2020_39': '191187235', 'TYNDP2020_51': '875518342', 'TYNDP2020_58': '368921913', 'TYNDP2020_66': '178621799', 'TYNDP2020_93': '208243244', 'TYNDP2020_120': '881636336', 'TYNDP2020_135': '418614532', 'TYNDP2020_30': '1001117406', 'TYNDP2020_52': '862050701-2', 'TYNDP2020_60': '856645981'}
 Lines are assumed to be duplicated and will be ignored.
INFO:root:Processing new links projects from tyndp2020.
WARNING:__main__:Found new lines similar to existing lines:
{'TYNDP2020_29': 'relation/3391794', 'TYNDP2020_30': 'relation/9982798', 'TYNDP2020_36': 'relation/2127794'}
 Lines are assumed to be duplicated and will be ignored.
INFO:root:Processing new lines projects from nep.
INFO:root:Processing new links projects from nep.
WARNING:__main__:Found new lines similar to existing lines:
{'DC1': 'TYNDP2020_23', 'DC3': 'TYNDP2020_1', 'DC4': 'TYNDP2020_2'}
 Lines are assumed to be duplicated and will be ignored.
INFO:root:Processing new links projects from manual.
[Sat Sep 21 08:22:30 2024]
Finished job 43.
8 of 321 steps (2%) done
Select jobs to execute...
Waiting for more resources.
[Sat Sep 21 08:22:31 2024]
Finished job 20.
9 of 321 steps (3%) done
Execute 1 jobs...

[Sat Sep 21 08:22:32 2024]
localrule build_population_layouts:
    input: resources/nuts3_shapes.geojson, /dss/dssfs02/lwp-dss-0001/pn39ci/pn39ci-dss-0000/input_files/API_SP.URB.TOTL.IN.ZS_DS2_en_csv_v2_1978.csv, cutouts/europe-2013-sarah3-era5.nc
    output: resources/pop_layout_total.nc, resources/pop_layout_urban.nc, resources/pop_layout_rural.nc
    log: logs/build_population_layouts.log
    jobid: 47
    benchmark: benchmarks/build_population_layouts
    reason: Missing output files: resources/pop_layout_urban.nc, resources/pop_layout_rural.nc, resources/pop_layout_total.nc; Input files updated by another job: resources/nuts3_shapes.geojson
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/geopandas/geoseries.py:720: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  val = getattr(super(), mtd)(*args, **kwargs)
[Sat Sep 21 08:22:50 2024]
Finished job 47.
10 of 321 steps (3%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:22:50 2024]
localrule build_industrial_production_per_country:
    input: data/ch_industrial_production_per_subsector.csv, resources/ammonia_production.csv, data/jrc-idees-2021, data/eurostat/Balances-April2023
    output: resources/industrial_production_per_country.csv
    log: logs/build_industrial_production_per_country.log
    jobid: 69
    benchmark: benchmarks/build_industrial_production_per_country
    reason: Missing output files: resources/industrial_production_per_country.csv; Input files updated by another job: resources/ammonia_production.csv
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

Build industry production:   0%|          | 0/34 [00:00<?, ? country/s]Build industry production:   3%|▎         | 1/34 [00:04<02:18,  4.19s/ country]Build industry production:   9%|▉         | 3/34 [00:07<01:12,  2.33s/ country]Build industry production:  12%|█▏        | 4/34 [00:07<00:48,  1.62s/ country]Build industry production:  15%|█▍        | 5/34 [00:10<01:01,  2.13s/ country]Build industry production:  18%|█▊        | 6/34 [00:11<00:44,  1.58s/ country]Build industry production:  21%|██        | 7/34 [00:14<00:56,  2.08s/ country]Build industry production:  24%|██▎       | 8/34 [00:15<00:41,  1.61s/ country]Build industry production:  26%|██▋       | 9/34 [00:17<00:49,  1.99s/ country]Build industry production:  29%|██▉       | 10/34 [00:18<00:36,  1.52s/ country]Build industry production:  32%|███▏      | 11/34 [00:21<00:45,  1.96s/ country]Build industry production:  35%|███▌      | 12/34 [00:21<00:33,  1.53s/ country]Build industry production:  38%|███▊      | 13/34 [00:24<00:40,  1.94s/ country]Build industry production:  41%|████      | 14/34 [00:25<00:31,  1.57s/ country]Build industry production:  44%|████▍     | 15/34 [00:28<00:35,  1.88s/ country]Build industry production:  47%|████▋     | 16/34 [00:29<00:28,  1.58s/ country]Build industry production:  50%|█████     | 17/34 [00:31<00:32,  1.89s/ country]Build industry production:  53%|█████▎    | 18/34 [00:32<00:24,  1.55s/ country]Build industry production:  56%|█████▌    | 19/34 [00:34<00:27,  1.84s/ country]Build industry production:  59%|█████▉    | 20/34 [00:35<00:21,  1.56s/ country]Build industry production:  62%|██████▏   | 21/34 [00:38<00:24,  1.89s/ country]Build industry production:  65%|██████▍   | 22/34 [00:39<00:18,  1.57s/ country]Build industry production:  68%|██████▊   | 23/34 [00:42<00:21,  1.95s/ country]Build industry production:  71%|███████   | 24/34 [00:43<00:16,  1.65s/ country]Build industry production:  74%|███████▎  | 25/34 [00:45<00:17,  1.94s/ country]Build industry production:  76%|███████▋  | 26/34 [00:46<00:13,  1.69s/ country]Build industry production:  79%|███████▉  | 27/34 [00:48<00:12,  1.80s/ country]Build industry production:  82%|████████▏ | 28/34 [00:50<00:10,  1.67s/ country]Build industry production:  85%|████████▌ | 29/34 [00:52<00:09,  1.82s/ country]Build industry production:  88%|████████▊ | 30/34 [00:53<00:06,  1.73s/ country]Build industry production:  91%|█████████ | 31/34 [00:55<00:05,  1.70s/ country]Build industry production:  94%|█████████▍| 32/34 [00:56<00:03,  1.62s/ country]Build industry production:  97%|█████████▋| 33/34 [00:59<00:01,  1.99s/ country]Build industry production: 100%|██████████| 34/34 [01:00<00:00,  1.57s/ country]Build industry production: 100%|██████████| 34/34 [01:00<00:00,  1.78s/ country]
INFO:__main__:Following countries have no ammonia demand: ['AL', 'BA', 'DK', 'IE', 'LU', 'LV', 'ME', 'MK', 'PT', 'SE', 'SI', 'XK']
[Sat Sep 21 08:23:52 2024]
Finished job 69.
11 of 321 steps (3%) done
Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 08:23:52 2024]
localrule add_transmission_projects_and_dlr:
    input: resources/networks/base.nc, resources/transmission_projects/new_buses.csv, resources/transmission_projects/new_lines.csv, resources/transmission_projects/new_links.csv, resources/transmission_projects/adjust_lines.csv, resources/transmission_projects/adjust_links.csv
    output: resources/networks/base_extended.nc
    log: logs/add_transmission_projects_and_dlr.log
    jobid: 17
    benchmark: benchmarks/add_transmission_projects_and_dlr
    reason: Missing output files: resources/networks/base_extended.nc; Input files updated by another job: resources/networks/base.nc, resources/transmission_projects/new_links.csv, resources/transmission_projects/new_lines.csv, resources/transmission_projects/new_buses.csv, resources/transmission_projects/adjust_links.csv, resources/transmission_projects/adjust_lines.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=4000, mem_mib=3815

[Sat Sep 21 08:23:52 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2045.csv
    log: logs/build_industrial_production_per_country_tomorrow_2045.log
    jobid: 96
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2045
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2045.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:pypsa.io:Imported network base.nc has buses, carriers, lines, links, shapes, transformers
INFO:__main__:Adding transmission projects to network.
INFO:pypsa.io:Exported network 'base_extended.nc' contains: carriers, shapes, buses, transformers, lines, links
[Sat Sep 21 08:23:59 2024]
Finished job 17.
12 of 321 steps (4%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:23:59 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2085.csv
    log: logs/build_industrial_production_per_country_tomorrow_2085.log
    jobid: 141
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2085
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2085.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:00 2024]
Finished job 96.
13 of 321 steps (4%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:00 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2100.csv
    log: logs/build_industrial_production_per_country_tomorrow_2100.log
    jobid: 159
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2100
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2100.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:04 2024]
Finished job 141.
14 of 321 steps (4%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:04 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2065.csv
    log: logs/build_industrial_production_per_country_tomorrow_2065.log
    jobid: 123
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2065
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2065.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:05 2024]
Finished job 159.
15 of 321 steps (5%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:05 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2050.csv
    log: logs/build_industrial_production_per_country_tomorrow_2050.log
    jobid: 105
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2050
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2050.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:10 2024]
Finished job 123.
16 of 321 steps (5%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:10 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2035.csv
    log: logs/build_industrial_production_per_country_tomorrow_2035.log
    jobid: 87
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2035
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2035.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:11 2024]
Finished job 105.
17 of 321 steps (5%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:11 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2095.csv
    log: logs/build_industrial_production_per_country_tomorrow_2095.log
    jobid: 150
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2095
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2095.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:15 2024]
Finished job 87.
18 of 321 steps (6%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:15 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2030.csv
    log: logs/build_industrial_production_per_country_tomorrow_2030.log
    jobid: 74
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2030
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2030.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:16 2024]
Finished job 150.
19 of 321 steps (6%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:16 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2075.csv
    log: logs/build_industrial_production_per_country_tomorrow_2075.log
    jobid: 132
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2075
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2075.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:20 2024]
Finished job 74.
20 of 321 steps (6%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:20 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/industrial_production_per_country.csv
    output: resources/industrial_production_per_country_tomorrow_2055.csv
    log: logs/build_industrial_production_per_country_tomorrow_2055.log
    jobid: 114
    benchmark: benchmarks/build_industrial_production_per_country_tomorrow_2055
    reason: Missing output files: resources/industrial_production_per_country_tomorrow_2055.csv; Input files updated by another job: resources/industrial_production_per_country.csv
    wildcards: planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:24:21 2024]
Finished job 132.
21 of 321 steps (7%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:24:21 2024]
localrule simplify_network:
    input: resources/networks/base_extended.nc, resources/regions_onshore.geojson, resources/regions_offshore.geojson
    output: resources/networks/base_s.nc, resources/regions_onshore_base_s.geojson, resources/regions_offshore_base_s.geojson, resources/busmap_base_s.csv
    log: logs/simplify_network.log
    jobid: 16
    benchmark: benchmarks/simplify_network_b
    reason: Missing output files: resources/networks/base_s.nc, resources/regions_onshore_base_s.geojson, resources/regions_offshore_base_s.geojson, resources/busmap_base_s.csv; Input files updated by another job: resources/regions_offshore.geojson, resources/networks/base_extended.nc, resources/regions_onshore.geojson
    resources: tmpdir=/tmp/go73lez2, mem_mb=12000, mem_mib=11445

[Sat Sep 21 08:24:26 2024]
Finished job 114.
22 of 321 steps (7%) done
Select jobs to execute...
Waiting for more resources.
INFO:pypsa.io:Imported network base_extended.nc has buses, carriers, lines, links, shapes, transformers
INFO:__main__:Mapping all network lines onto a single 380kV layer
INFO:__main__:Simplifying connected link components
INFO:__main__:Joining the links converter/relation/8184631_0, relation/8184631, converter/relation/8184631_1 connecting the buses 3717, 6022, 5975, 1487 to simple link relation/8184631+2
INFO:__main__:Joining the links converter/relation/3391954_1, relation/3391954, converter/relation/3391954_0 connecting the buses 3708, 6027, 5976, 1487 to simple link relation/3391954+2
INFO:__main__:Joining the links converter/relation/8185420_0, relation/8185420, converter/relation/8185420_1 connecting the buses 896, 5963, 6018, 3179 to simple link relation/8185420+2
INFO:__main__:Joining the links converter/relation/9965201_1, relation/9965201, converter/relation/9965201_0 connecting the buses 4160, 6050, 6019, 3179 to simple link relation/9965201+2
INFO:__main__:Joining the links converter/relation/15775538_1, relation/15775538, converter/relation/15775538_0 connecting the buses 2337, 5995, 5993, 2576 to simple link relation/15775538+2
INFO:__main__:Joining the links converter/relation/8184641_0, relation/8184641, converter/relation/8184641_1 connecting the buses 2337, 5994, 6007, 2748 to simple link relation/8184641+2
INFO:__main__:Joining the links TYNDP2024_1169, relation/8185711, converter/relation/8185711_1 connecting the buses 2794, 6014, 6016, 3066 to simple link relation/8185711+2
INFO:__main__:Joining the links converter/relation/2127794_0, relation/2127794, converter/relation/2127794_1 connecting the buses 2639, 5984, 5981, 1638 to simple link relation/2127794+2
INFO:__main__:Joining the links converter/relation/15772117_1, relation/15772117, converter/relation/15772117_0 connecting the buses 1638, 5982, 5999, 5519 to simple link relation/15772117+2
INFO:__main__:Joining the links converter/relation/3391931_1, relation/3391931, converter/relation/3391931_0 connecting the buses 4157, 6045, 5969, 892 to simple link relation/3391931+2
INFO:__main__:Joining the links converter/relation/8184632_1, relation/8184632, converter/relation/8184632_0 connecting the buses 4157, 6055, 5971, 892 to simple link relation/8184632+2
INFO:__main__:Joining the links converter/relation/8184633_0, relation/8184633, converter/relation/8184633_1 connecting the buses 3844, 6024, 6026, 3784 to simple link relation/8184633+2
INFO:__main__:Joining the links relation/3391794, converter/relation/3391794_0 connecting the buses 5979, 6011, 2987 to simple link relation/3391794+1
INFO:__main__:Joining the links relation/9982798, converter/relation/9982798_1 connecting the buses 5979, 6012, 2904 to simple link relation/9982798+1
INFO:__main__:Joining the links TYNDP2020_2, relation/16213216, converter/relation/16213216_1 connecting the buses 452, 5953, 6031, 4188 to simple link relation/16213216+2
INFO:__main__:Joining the links converter/relation/8185664_0, relation/8185664, converter/relation/8185664_1 connecting the buses 2923, 6008, 6006, 5738 to simple link relation/8185664+2
INFO:__main__:Joining the links converter/relation/2505320_1, relation/2505320, converter/relation/2505320_0 connecting the buses 560, 5955, 6049, 867 to simple link relation/2505320+2
INFO:__main__:Joining the links converter/relation/3918230_0, relation/3918230, converter/relation/3918230_1 connecting the buses 663, 6051, 6029, 3705 to simple link relation/3918230+2
INFO:__main__:Joining the links converter/relation/13295785_1, relation/13295785, converter/relation/13295785_0 connecting the buses 2585, 5998, 6056, 4183 to simple link relation/13295785+2
INFO:__main__:Joining the links converter/relation/14126301_0, relation/14126301, converter/relation/14126301_1 connecting the buses 2492, 5985, 6020, 3162 to simple link relation/14126301+2
INFO:__main__:Joining the links converter/relation/8193755_1, relation/8193755, converter/relation/8193755_0 connecting the buses 493, 5954, 5948, 106 to simple link relation/8193755+2
INFO:__main__:Joining the links converter/relation/3392010_1, relation/3392010, converter/relation/3392010_0 connecting the buses 4217, 6052, 6053, 3439 to simple link relation/3392010+2
INFO:__main__:Joining the links converter/relation/8099179_1, relation/8099179, converter/relation/8099179_0 connecting the buses 2605, 6005, 5996, 2499 to simple link relation/8099179+2
INFO:__main__:Joining the links converter/relation/6886400_1, relation/6886400, converter/relation/6886400_0 connecting the buses 1488, 6054, 5972, 910 to simple link relation/6886400+2
INFO:__main__:Joining the links converter/relation/17631956_1, relation/17631956, converter/relation/17631956_0 connecting the buses 1078, 5973, 5974, 1004 to simple link relation/17631956+2
INFO:__main__:Joining the links converter/relation/10377412_0, relation/10377412, converter/relation/10377412_1 connecting the buses 1749, 5980, 5997, 2350 to simple link relation/10377412+2
INFO:__main__:Joining the links converter/relation/8184630_0, relation/8184630, converter/relation/8184630_1 connecting the buses 904, 6038, 6037, 1489 to simple link relation/8184630+2
INFO:__main__:Joining the links converter/relation/15781671_0, relation/15781671, converter/relation/15781671_1 connecting the buses 2540, 6004, 5967, 888 to simple link relation/15781671+2
INFO:__main__:Joining the links converter/relation/8185767_0, relation/8185767, converter/relation/8185767_1 connecting the buses 3097, 6015, 6017, 3149 to simple link relation/8185767+2
INFO:__main__:Joining the links converter/relation/8185455_0, relation/8185455, converter/relation/8185455_1 connecting the buses 3113, 6042, 6041, 4209 to simple link relation/8185455+2
INFO:__main__:Joining the links converter/relation/8185487_1, relation/8185487, converter/relation/8185487_0 connecting the buses 142, 5947, 6046, 4114 to simple link relation/8185487+2
INFO:__main__:Joining the links converter/relation/6914309_0, relation/6914309, converter/relation/6914309_1 connecting the buses 2513, 5988, 5991, 5014 to simple link relation/6914309+2
INFO:__main__:Joining the links converter/relation/9934065_0, converter/relation/9934066_0, relation/9934065, relation/9934066, converter/relation/9934065_1, converter/relation/9934066_1 connecting the buses 1690, 6043, 6044, 1348 to simple link relation/9934066+2
INFO:__main__:Joining the links converter/relation/8184629_0, relation/8184629, converter/relation/8184629_1 connecting the buses 880, 6039, 6040, 3701 to simple link relation/8184629+2
INFO:__main__:Joining the links converter/relation/5487095_0, relation/5487095, converter/relation/5487095_1 connecting the buses 869, 6047, 6048, 887 to simple link relation/5487095+2
INFO:__main__:Joining the links relation/3392001, converter/relation/3392001_1 connecting the buses 6036, 6035, 3781 to simple link relation/3392001+1
INFO:__main__:Removing stubs
INFO:pyogrio._io:Created 3,670 records
INFO:pyogrio._io:Created 846 records
INFO:pypsa.io:Exported network 'base_s.nc' contains: shapes, buses, lines, links, carriers
INFO:__main__:Simplified network:
Buses: 5557 to 3719
Lines: 7024 to 6128
Links: 151 to 74
[Sat Sep 21 08:24:33 2024]
Finished job 16.
23 of 321 steps (7%) done
Execute 1 jobs...

[Sat Sep 21 08:24:33 2024]
localrule build_energy_totals:
    input: resources/nuts3_shapes.geojson, data/bundle/eea/UNFCCC_v23.csv, data/switzerland-new_format-all_years.csv, data/gr-e-11.03.02.01.01-cc.csv, data/jrc-idees-2021, data/district_heat_share.csv, data/eurostat/Balances-April2023, data/eurostat/eurostat-household_energy_balances-february_2024.csv
    output: resources/transformation_output_coke.csv, resources/energy_totals.csv, resources/co2_totals.csv, resources/transport_data.csv, resources/district_heat_share.csv, resources/heating_efficiencies.csv
    log: logs/build_energy_totals.log
    jobid: 51
    benchmark: benchmarks/build_energy_totals
    reason: Missing output files: resources/heating_efficiencies.csv, resources/energy_totals.csv, resources/transformation_output_coke.csv, resources/district_heat_share.csv, resources/co2_totals.csv, resources/transport_data.csv; Input files updated by another job: resources/nuts3_shapes.geojson
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=10000, mem_mib=9537

Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:03<02:04,  3.88s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:07<01:12,  2.42s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:11<01:02,  2.22s/ country]Build from eurostat database:  21%|██        | 7/33 [00:15<00:52,  2.03s/ country]Build from eurostat database:  24%|██▍       | 8/33 [00:15<00:39,  1.59s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:19<00:51,  2.16s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:22<00:43,  2.00s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:26<00:40,  2.00s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:27<00:32,  1.70s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:30<00:35,  2.00s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:31<00:28,  1.67s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:34<00:32,  2.06s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:34<00:25,  1.70s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:37<00:28,  2.01s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:38<00:21,  1.66s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:41<00:24,  2.07s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:42<00:18,  1.69s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:45<00:20,  2.03s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:46<00:14,  1.66s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:49<00:16,  2.09s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:49<00:11,  1.67s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:52<00:12,  2.05s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:53<00:08,  1.70s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:56<00:08,  2.08s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:57<00:05,  1.68s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [01:00<00:04,  2.03s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [01:01<00:01,  1.72s/ country]Build from eurostat database: 100%|██████████| 33/33 [01:02<00:00,  1.65s/ country]Build from eurostat database: 100%|██████████| 33/33 [01:02<00:00,  1.90s/ country]
Build from IDEES database:   0%|          | 0/25 [00:00<?, ? country/s]Build from IDEES database:   4%|▍         | 1/25 [00:03<01:16,  3.20s/ country]Build from IDEES database:  12%|█▏        | 3/25 [00:05<00:37,  1.72s/ country]Build from IDEES database:  20%|██        | 5/25 [00:08<00:31,  1.56s/ country]Build from IDEES database:  24%|██▍       | 6/25 [00:08<00:22,  1.18s/ country]Build from IDEES database:  28%|██▊       | 7/25 [00:11<00:28,  1.59s/ country]Build from IDEES database:  36%|███▌      | 9/25 [00:13<00:23,  1.46s/ country]Build from IDEES database:  44%|████▍     | 11/25 [00:16<00:20,  1.45s/ country]Build from IDEES database:  52%|█████▏    | 13/25 [00:19<00:16,  1.38s/ country]Build from IDEES database:  60%|██████    | 15/25 [00:22<00:13,  1.39s/ country]Build from IDEES database:  68%|██████▊   | 17/25 [00:24<00:11,  1.40s/ country]Build from IDEES database:  72%|███████▏  | 18/25 [00:24<00:08,  1.15s/ country]Build from IDEES database:  76%|███████▌  | 19/25 [00:27<00:08,  1.41s/ country]Build from IDEES database:  80%|████████  | 20/25 [00:27<00:05,  1.12s/ country]Build from IDEES database:  84%|████████▍ | 21/25 [00:30<00:06,  1.53s/ country]Build from IDEES database:  92%|█████████▏| 23/25 [00:32<00:02,  1.45s/ country]Build from IDEES database: 100%|██████████| 25/25 [00:34<00:00,  1.20s/ country]Build from IDEES database: 100%|██████████| 25/25 [00:34<00:00,  1.38s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:922: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df.loc["BA"].replace(0.0, np.nan).infer_objects(copy=False).values
INFO:__main__:Updated energy balances for residential using disaggregate final energy consumption data in Households from Eurostat
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:960: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .replace(0, np.nan)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:987: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  district_heat_share.unstack().dropna(how="all", axis=1).ffill(axis=1)
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9xcv4mee.build_energy_totals.py:1168: PerformanceWarning: indexing past lexsort depth may impact performance.
  co2.at[ct, i] = eurostat_co2.loc[mi].sum()
INFO:__main__:Missing data on cars from:
[('AL', 2000), ('AL', 2001), ('AL', 2002), ('AL', 2003), ('AL', 2004), ('AL', 2005), ('AL', 2006), ('AL', 2007), ('AL', 2008), ('AL', 2009), ('AL', 2010), ('AL', 2011), ('AL', 2012), ('AL', 2013), ('AL', 2014), ('AL', 2015), ('AL', 2016), ('AL', 2017), ('AL', 2018), ('AL', 2019), ('AL', 2020), ('AL', 2021), ('BA', 2000), ('BA', 2001), ('BA', 2002), ('BA', 2003), ('BA', 2004), ('BA', 2005), ('BA', 2006), ('BA', 2007), ('BA', 2008), ('BA', 2009), ('BA', 2010), ('BA', 2011), ('BA', 2012), ('BA', 2013), ('BA', 2014), ('BA', 2015), ('BA', 2016), ('BA', 2017), ('BA', 2018), ('BA', 2019), ('BA', 2020), ('BA', 2021), ('GB', 2000), ('GB', 2001), ('GB', 2002), ('GB', 2003), ('GB', 2004), ('GB', 2005), ('GB', 2006), ('GB', 2007), ('GB', 2008), ('GB', 2009), ('GB', 2010), ('GB', 2011), ('GB', 2012), ('GB', 2013), ('GB', 2014), ('GB', 2015), ('GB', 2016), ('GB', 2017), ('GB', 2018), ('GB', 2019), ('GB', 2020), ('GB', 2021), ('ME', 2000), ('ME', 2001), ('ME', 2002), ('ME', 2003), ('ME', 2004), ('ME', 2005), ('ME', 2006), ('ME', 2007), ('ME', 2008), ('ME', 2009), ('ME', 2010), ('ME', 2011), ('ME', 2012), ('ME', 2013), ('ME', 2014), ('ME', 2015), ('ME', 2016), ('ME', 2017), ('ME', 2018), ('ME', 2019), ('ME', 2020), ('ME', 2021), ('MK', 2000), ('MK', 2001), ('MK', 2002), ('MK', 2003), ('MK', 2004), ('MK', 2005), ('MK', 2006), ('MK', 2007), ('MK', 2008), ('MK', 2009), ('MK', 2010), ('MK', 2011), ('MK', 2012), ('MK', 2013), ('MK', 2014), ('MK', 2015), ('MK', 2016), ('MK', 2017), ('MK', 2018), ('MK', 2019), ('MK', 2020), ('MK', 2021), ('NO', 2000), ('NO', 2001), ('NO', 2002), ('NO', 2003), ('NO', 2004), ('NO', 2005), ('NO', 2006), ('NO', 2007), ('NO', 2008), ('NO', 2009), ('NO', 2010), ('NO', 2011), ('NO', 2012), ('NO', 2013), ('NO', 2014), ('NO', 2015), ('NO', 2016), ('NO', 2017), ('NO', 2018), ('NO', 2019), ('NO', 2020), ('NO', 2021), ('RS', 2000), ('RS', 2001), ('RS', 2002), ('RS', 2003), ('RS', 2004), ('RS', 2005), ('RS', 2006), ('RS', 2007), ('RS', 2008), ('RS', 2009), ('RS', 2010), ('RS', 2011), ('RS', 2012), ('RS', 2013), ('RS', 2014), ('RS', 2015), ('RS', 2016), ('RS', 2017), ('RS', 2018), ('RS', 2019), ('RS', 2020), ('RS', 2021), ('XK', 2000), ('XK', 2001), ('XK', 2002), ('XK', 2003), ('XK', 2004), ('XK', 2005), ('XK', 2006), ('XK', 2007), ('XK', 2008), ('XK', 2009), ('XK', 2010), ('XK', 2011), ('XK', 2012), ('XK', 2013), ('XK', 2014), ('XK', 2015), ('XK', 2016), ('XK', 2017), ('XK', 2018), ('XK', 2019), ('XK', 2020), ('XK', 2021)]
Filling gaps with averaged data.
INFO:__main__:Missing data on fuel efficiency from:
[('AL', 2000), ('AL', 2001), ('AL', 2002), ('AL', 2003), ('AL', 2004), ('AL', 2005), ('AL', 2006), ('AL', 2007), ('AL', 2008), ('AL', 2009), ('AL', 2010), ('AL', 2011), ('AL', 2012), ('AL', 2013), ('AL', 2014), ('AL', 2015), ('AL', 2016), ('AL', 2017), ('AL', 2018), ('AL', 2019), ('AL', 2020), ('AL', 2021), ('BA', 2000), ('BA', 2001), ('BA', 2002), ('BA', 2003), ('BA', 2004), ('BA', 2005), ('BA', 2006), ('BA', 2007), ('BA', 2008), ('BA', 2009), ('BA', 2010), ('BA', 2011), ('BA', 2012), ('BA', 2013), ('BA', 2014), ('BA', 2015), ('BA', 2016), ('BA', 2017), ('BA', 2018), ('BA', 2019), ('BA', 2020), ('BA', 2021), ('CH', 2000), ('CH', 2001), ('CH', 2002), ('CH', 2003), ('CH', 2004), ('CH', 2005), ('CH', 2006), ('CH', 2007), ('CH', 2008), ('CH', 2009), ('CH', 2010), ('CH', 2011), ('CH', 2012), ('CH', 2013), ('CH', 2014), ('CH', 2015), ('CH', 2016), ('CH', 2017), ('CH', 2018), ('CH', 2019), ('CH', 2020), ('CH', 2021), ('GB', 2000), ('GB', 2001), ('GB', 2002), ('GB', 2003), ('GB', 2004), ('GB', 2005), ('GB', 2006), ('GB', 2007), ('GB', 2008), ('GB', 2009), ('GB', 2010), ('GB', 2011), ('GB', 2012), ('GB', 2013), ('GB', 2014), ('GB', 2015), ('GB', 2016), ('GB', 2017), ('GB', 2018), ('GB', 2019), ('GB', 2020), ('GB', 2021), ('ME', 2000), ('ME', 2001), ('ME', 2002), ('ME', 2003), ('ME', 2004), ('ME', 2005), ('ME', 2006), ('ME', 2007), ('ME', 2008), ('ME', 2009), ('ME', 2010), ('ME', 2011), ('ME', 2012), ('ME', 2013), ('ME', 2014), ('ME', 2015), ('ME', 2016), ('ME', 2017), ('ME', 2018), ('ME', 2019), ('ME', 2020), ('ME', 2021), ('MK', 2000), ('MK', 2001), ('MK', 2002), ('MK', 2003), ('MK', 2004), ('MK', 2005), ('MK', 2006), ('MK', 2007), ('MK', 2008), ('MK', 2009), ('MK', 2010), ('MK', 2011), ('MK', 2012), ('MK', 2013), ('MK', 2014), ('MK', 2015), ('MK', 2016), ('MK', 2017), ('MK', 2018), ('MK', 2019), ('MK', 2020), ('MK', 2021), ('NO', 2000), ('NO', 2001), ('NO', 2002), ('NO', 2003), ('NO', 2004), ('NO', 2005), ('NO', 2006), ('NO', 2007), ('NO', 2008), ('NO', 2009), ('NO', 2010), ('NO', 2011), ('NO', 2012), ('NO', 2013), ('NO', 2014), ('NO', 2015), ('NO', 2016), ('NO', 2017), ('NO', 2018), ('NO', 2019), ('NO', 2020), ('NO', 2021), ('RS', 2000), ('RS', 2001), ('RS', 2002), ('RS', 2003), ('RS', 2004), ('RS', 2005), ('RS', 2006), ('RS', 2007), ('RS', 2008), ('RS', 2009), ('RS', 2010), ('RS', 2011), ('RS', 2012), ('RS', 2013), ('RS', 2014), ('RS', 2015), ('RS', 2016), ('RS', 2017), ('RS', 2018), ('RS', 2019), ('RS', 2020), ('RS', 2021), ('XK', 2000), ('XK', 2001), ('XK', 2002), ('XK', 2003), ('XK', 2004), ('XK', 2005), ('XK', 2006), ('XK', 2007), ('XK', 2008), ('XK', 2009), ('XK', 2010), ('XK', 2011), ('XK', 2012), ('XK', 2013), ('XK', 2014), ('XK', 2015), ('XK', 2016), ('XK', 2017), ('XK', 2018), ('XK', 2019), ('XK', 2020), ('XK', 2021)]
Filling gaps with averaged data.
[Sat Sep 21 08:26:19 2024]
Finished job 51.
24 of 321 steps (7%) done
Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 08:26:19 2024]
localrule build_heat_totals:
    input: data/era5-annual-HDD-per-country.csv, resources/energy_totals.csv
    output: resources/heat_totals.csv
    log: logs/build_heat_totals.log
    jobid: 56
    benchmark: benchmarks/build_heat_totals
    reason: Missing output files: resources/heat_totals.csv; Input files updated by another job: resources/energy_totals.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:26:19 2024]
localrule build_electricity_demand_base:
    input: resources/networks/base_s.nc, resources/regions_onshore_base_s.geojson, resources/nuts3_shapes.geojson, resources/electricity_demand.csv
    output: resources/electricity_demand_base_s.nc
    log: logs/build_electricity_demand_base_s.log
    jobid: 21
    benchmark: benchmarks/build_electricity_demand_base_s
    reason: Missing output files: resources/electricity_demand_base_s.nc; Input files updated by another job: resources/nuts3_shapes.geojson, resources/networks/base_s.nc, resources/regions_onshore_base_s.geojson, resources/electricity_demand.csv
    resources: tmpdir=/tmp/go73lez2, mem_mb=5000, mem_mib=4769

[Sat Sep 21 08:26:21 2024]
Finished job 56.
25 of 321 steps (8%) done
Select jobs to execute...
Waiting for more resources.
INFO:pypsa.io:Imported network base_s.nc has buses, carriers, lines, links, shapes
[Sat Sep 21 08:27:19 2024]
Finished job 21.
26 of 321 steps (8%) done
Execute 1 jobs...

[Sat Sep 21 08:27:19 2024]
localrule build_industrial_energy_demand_per_country_today:
    input: resources/transformation_output_coke.csv, data/jrc-idees-2021, resources/industrial_production_per_country.csv
    output: resources/industrial_energy_demand_per_country_today.csv
    log: logs/build_industrial_energy_demand_per_country_today.log
    jobid: 68
    benchmark: benchmarks/build_industrial_energy_demand_per_country_today
    reason: Missing output files: resources/industrial_energy_demand_per_country_today.csv; Input files updated by another job: resources/transformation_output_coke.csv, resources/industrial_production_per_country.csv
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

Build industrial energy demand:   0%|          | 0/25 [00:00<?, ? country/s]Build industrial energy demand:   4%|▍         | 1/25 [00:01<00:39,  1.64s/ country]Build industrial energy demand:  12%|█▏        | 3/25 [00:02<00:20,  1.10 country/s]Build industrial energy demand:  20%|██        | 5/25 [00:04<00:15,  1.30 country/s]Build industrial energy demand:  28%|██▊       | 7/25 [00:05<00:11,  1.52 country/s]Build industrial energy demand:  32%|███▏      | 8/25 [00:05<00:09,  1.87 country/s]Build industrial energy demand:  36%|███▌      | 9/25 [00:06<00:11,  1.37 country/s]Build industrial energy demand:  44%|████▍     | 11/25 [00:08<00:10,  1.38 country/s]Build industrial energy demand:  52%|█████▏    | 13/25 [00:09<00:08,  1.42 country/s]Build industrial energy demand:  56%|█████▌    | 14/25 [00:09<00:06,  1.70 country/s]Build industrial energy demand:  60%|██████    | 15/25 [00:10<00:07,  1.33 country/s]Build industrial energy demand:  68%|██████▊   | 17/25 [00:11<00:05,  1.55 country/s]Build industrial energy demand:  76%|███████▌  | 19/25 [00:13<00:03,  1.55 country/s]Build industrial energy demand:  84%|████████▍ | 21/25 [00:14<00:02,  1.49 country/s]Build industrial energy demand:  92%|█████████▏| 23/25 [00:15<00:01,  1.49 country/s]Build industrial energy demand: 100%|██████████| 25/25 [00:16<00:00,  1.70 country/s]Build industrial energy demand: 100%|██████████| 25/25 [00:16<00:00,  1.49 country/s]
[Sat Sep 21 08:27:37 2024]
Finished job 68.
27 of 321 steps (8%) done
Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 08:27:37 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2065.csv
    log: logs/build_industry_sector_ratios_2065.log
    jobid: 121
    benchmark: benchmarks/build_industry_sector_ratios_2065
    reason: Missing output files: resources/industry_sector_ratios_2065.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:37 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2030.csv
    log: logs/build_industry_sector_ratios_2030.log
    jobid: 64
    benchmark: benchmarks/build_industry_sector_ratios_2030
    reason: Missing output files: resources/industry_sector_ratios_2030.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:43 2024]
Finished job 64.
28 of 321 steps (9%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:27:43 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2050.csv
    log: logs/build_industry_sector_ratios_2050.log
    jobid: 103
    benchmark: benchmarks/build_industry_sector_ratios_2050
    reason: Missing output files: resources/industry_sector_ratios_2050.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:43 2024]
Finished job 121.
29 of 321 steps (9%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:27:43 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2035.csv
    log: logs/build_industry_sector_ratios_2035.log
    jobid: 85
    benchmark: benchmarks/build_industry_sector_ratios_2035
    reason: Missing output files: resources/industry_sector_ratios_2035.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:48 2024]
Finished job 103.
30 of 321 steps (9%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:27:48 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2095.csv
    log: logs/build_industry_sector_ratios_2095.log
    jobid: 148
    benchmark: benchmarks/build_industry_sector_ratios_2095
    reason: Missing output files: resources/industry_sector_ratios_2095.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:49 2024]
Finished job 85.
31 of 321 steps (10%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:27:49 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2075.csv
    log: logs/build_industry_sector_ratios_2075.log
    jobid: 130
    benchmark: benchmarks/build_industry_sector_ratios_2075
    reason: Missing output files: resources/industry_sector_ratios_2075.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:54 2024]
Finished job 148.
32 of 321 steps (10%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:27:54 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2055.csv
    log: logs/build_industry_sector_ratios_2055.log
    jobid: 112
    benchmark: benchmarks/build_industry_sector_ratios_2055
    reason: Missing output files: resources/industry_sector_ratios_2055.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:27:54 2024]
Finished job 130.
33 of 321 steps (10%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:27:54 2024]
localrule cluster_network:
    input: resources/networks/base_s.nc, resources/regions_onshore_base_s.geojson, resources/regions_offshore_base_s.geojson, resources/busmap_base_s.csv, resources/electricity_demand_base_s.nc
    output: resources/networks/base_s_39.nc, resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson, resources/busmap_base_s_39.csv, resources/linemap_base_s_39.csv
    log: logs/cluster_network_base_s_39.log
    jobid: 15
    benchmark: benchmarks/cluster_network_base_s_39
    reason: Missing output files: resources/regions_onshore_base_s_39.geojson, resources/busmap_base_s_39.csv, resources/networks/base_s_39.nc, resources/regions_offshore_base_s_39.geojson; Input files updated by another job: resources/electricity_demand_base_s.nc, resources/regions_onshore_base_s.geojson, resources/networks/base_s.nc, resources/regions_offshore_base_s.geojson, resources/busmap_base_s.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s.nc has buses, carriers, lines, links, shapes
[Sat Sep 21 08:28:00 2024]
Finished job 112.
34 of 321 steps (11%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:00 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2045.csv
    log: logs/build_industry_sector_ratios_2045.log
    jobid: 94
    benchmark: benchmarks/build_industry_sector_ratios_2045
    reason: Missing output files: resources/industry_sector_ratios_2045.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.io: Writing time: 0.04s
WARNING:linopy.solvers:Dual values of MILP couldn't be parsed
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 39 primals, 0 duals
Objective: -3.90e+01
Solver model: available
Solver message: 2

[Sat Sep 21 08:28:06 2024]
Finished job 94.
35 of 321 steps (11%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:06 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2085.csv
    log: logs/build_industry_sector_ratios_2085.log
    jobid: 139
    benchmark: benchmarks/build_industry_sector_ratios_2085
    reason: Missing output files: resources/industry_sector_ratios_2085.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:28:10 2024]
Finished job 139.
36 of 321 steps (11%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:10 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/industry_sector_ratios.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industrial_production_per_country.csv
    output: resources/industry_sector_ratios_2100.csv
    log: logs/build_industry_sector_ratios_2100.log
    jobid: 157
    benchmark: benchmarks/build_industry_sector_ratios_2100
    reason: Missing output files: resources/industry_sector_ratios_2100.csv; Input files updated by another job: resources/industrial_production_per_country.csv, resources/industrial_energy_demand_per_country_today.csv, resources/industry_sector_ratios.csv
    wildcards: planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:28:16 2024]
Finished job 157.
37 of 321 steps (12%) done
INFO:pyogrio._io:Created 39 records
INFO:pyogrio._io:Created 30 records
INFO:pypsa.io:Exported network 'base_s_39.nc' contains: carriers, lines, buses, links
INFO:__main__:Clustered network:
Buses: 3719 to 39
Lines: 6128 to 73
Links: 74 to 45
[Sat Sep 21 08:28:29 2024]
Finished job 15.
38 of 321 steps (12%) done
Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 08:28:29 2024]
localrule build_shipping_demand:
    input: data/attributed_ports.json, resources/europe_shape.geojson, resources/regions_onshore_base_s_39.geojson, resources/energy_totals.csv
    output: resources/shipping_demand_s_39.csv
    log: logs/build_shipping_demand_s_39.log
    jobid: 57
    reason: Missing output files: resources/shipping_demand_s_39.csv; Input files updated by another job: resources/europe_shape.geojson, resources/regions_onshore_base_s_39.geojson, resources/energy_totals.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:28:29 2024]
localrule build_salt_cavern_potentials:
    input: data/bundle/h2_salt_caverns_GWh_per_sqkm.geojson, resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson
    output: resources/salt_cavern_potentials_s_39.csv
    log: logs/build_salt_cavern_potentials_s_39.log
    jobid: 62
    benchmark: benchmarks/build_salt_cavern_potentials_s_39
    reason: Missing output files: resources/salt_cavern_potentials_s_39.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:28:31 2024]
Finished job 57.
39 of 321 steps (12%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:31 2024]
localrule build_gas_input_locations:
    input: data/gem/Europe-Gas-Tracker-2024-05.xlsx, data/gas_network/scigrid-gas/data/IGGIELGN_BorderPoints.geojson, data/gas_network/scigrid-gas/data/IGGIELGN_Storages.geojson, resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson
    output: resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv
    log: logs/build_gas_input_locations_s_39.log
    jobid: 32
    reason: Missing output files: resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:28:33 2024]
Finished job 62.
40 of 321 steps (12%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:34 2024]
localrule cluster_gas_network:
    input: resources/gas_network.csv, resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson
    output: resources/gas_network_base_s_39.csv
    log: logs/cluster_gas_network_39.log
    jobid: 29
    reason: Missing output files: resources/gas_network_base_s_39.csv; Input files updated by another job: resources/gas_network.csv, resources/regions_onshore_base_s_39.geojson, resources/regions_offshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=4000, mem_mib=3815

[Sat Sep 21 08:28:39 2024]
Finished job 29.
41 of 321 steps (13%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:39 2024]
localrule plot_power_network_clustered:
    input: resources/networks/base_s_39.nc, resources/regions_onshore_base_s_39.geojson
    output: resources/maps/power-network-s-39.pdf
    jobid: 161
    benchmark: benchmarks/plot_power_network_clustered/base_s_39
    reason: Missing output files: resources/maps/power-network-s-39.pdf; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/networks/base_s_39.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=4000, mem_mib=3815

INFO:pyogrio._io:Created 986 records
[Sat Sep 21 08:28:40 2024]
Finished job 32.
42 of 321 steps (13%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:40 2024]
localrule build_powerplants:
    input: resources/networks/base_s_39.nc, data/custom_powerplants.csv
    output: resources/powerplants_s_39.csv
    log: logs/build_powerplants_s_39.log
    jobid: 44
    benchmark: benchmarks/build_powerplants_s_39
    reason: Missing output files: resources/powerplants_s_39.csv; Input files updated by another job: resources/networks/base_s_39.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=7000, mem_mib=6676

INFO:pypsa.io:Imported network base_s_39.nc has buses, carriers, lines, links
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
INFO:pypsa.io:Imported network base_s_39.nc has buses, carriers, lines, links
INFO:powerplantmatching.collection:Retrieving data from https://raw.githubusercontent.com/PyPSA/powerplantmatching/v0.5.17/powerplants.csv
INFO:powerplantmatching.collection:Store data at /dss/dsshome1/01/go73lez2/.local/share/powerplantmatching/data/out/default/matched_data_red.csv
INFO:powerplantmatching.core:Retrieving data from https://data.open-power-system-data.org/renewable_power_plants/2020-08-25/renewable_power_plants_EU.csv
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_cultural/ne_50m_admin_0_boundary_lines_land.zip
  warnings.warn(f'Downloading: {url}', DownloadWarning)
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/io/__init__.py:241: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/50m_physical/ne_50m_coastline.zip
  warnings.warn(f'Downloading: {url}', DownloadWarning)
[Sat Sep 21 08:28:53 2024]
Finished job 161.
43 of 321 steps (13%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:28:53 2024]
localrule build_clustered_population_layouts:
    input: resources/pop_layout_total.nc, resources/pop_layout_urban.nc, resources/pop_layout_rural.nc, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/pop_layout_base_s_39.csv
    log: logs/build_clustered_population_layouts_s_39.log
    jobid: 54
    benchmark: benchmarks/build_clustered_population_layouts/s_39
    reason: Missing output files: resources/pop_layout_base_s_39.csv; Input files updated by another job: resources/pop_layout_urban.nc, resources/regions_onshore_base_s_39.geojson, resources/pop_layout_rural.nc, resources/pop_layout_total.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=10000, mem_mib=9537

[Sat Sep 21 08:29:08 2024]
Finished job 54.
44 of 321 steps (14%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:08 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2055.csv
    log: logs/build_district_heat_share_39_2055.log
    jobid: 115
    reason: Missing output files: resources/district_heat_share_base_s_39_2055.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

WARNING:root:No powerplants known in: XK, MK
[Sat Sep 21 08:29:10 2024]
Finished job 44.
45 of 321 steps (14%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:10 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2065.csv
    log: logs/build_district_heat_share_39_2065.log
    jobid: 124
    reason: Missing output files: resources/district_heat_share_base_s_39_2065.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

WARNING:_helpers:Investment key 2055 not found in dictionary {2020: 0.0, 2025: 0.15, 2030: 0.3, 2035: 0.45, 2040: 0.6, 2045: 0.8, 2050: 1.0, 2060: 1.0, 2065: 1.0, 2070: 1.0, 2075: 1.0, 2080: 1.0, 2085: 1.0, 2090: 1.0, 2095: 1.0, 2100: 1.0}.
WARNING:_helpers:Interpolate linearly between the next lower and next higher year.
INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:29:13 2024]
Finished job 115.
46 of 321 steps (14%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:13 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2050.csv
    log: logs/build_district_heat_share_39_2050.log
    jobid: 106
    reason: Missing output files: resources/district_heat_share_base_s_39_2050.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:29:15 2024]
Finished job 124.
47 of 321 steps (15%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:15 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2045.csv
    log: logs/build_district_heat_share_39_2045.log
    jobid: 97
    reason: Missing output files: resources/district_heat_share_base_s_39_2045.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:29:18 2024]
Finished job 106.
48 of 321 steps (15%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:18 2024]
localrule build_industrial_distribution_key:
    input: resources/regions_onshore_base_s_39.geojson, resources/pop_layout_base_s_39.csv, data/Industrial_Database.csv, data/gem/Global-Steel-Plant-Tracker-April-2024-Standard-Copy-V1.xlsx, data/ammonia_plants.csv, data/cement-plants-noneu.csv, data/refineries-noneu.csv
    output: resources/industrial_distribution_key_base_s_39.csv
    log: logs/build_industrial_distribution_key_39.log
    jobid: 71
    benchmark: benchmarks/build_industrial_distribution_key/s_39
    reason: Missing output files: resources/industrial_distribution_key_base_s_39.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 80.00% resulting in new average share of 35.67%
[Sat Sep 21 08:29:20 2024]
Finished job 97.
49 of 321 steps (15%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:20 2024]
localrule build_population_weighted_energy_totals:
    input: resources/energy_totals.csv, resources/pop_layout_base_s_39.csv
    output: resources/pop_weighted_energy_totals_s_39.csv
    log: logs/build_population_weighted_energy_totals_39.log
    jobid: 50
    reason: Missing output files: resources/pop_weighted_energy_totals_s_39.csv; Input files updated by another job: resources/energy_totals.csv, resources/pop_layout_base_s_39.csv
    wildcards: kind=energy, clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:29:22 2024]
Finished job 50.
50 of 321 steps (16%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:22 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2085.csv
    log: logs/build_district_heat_share_39_2085.log
    jobid: 142
    reason: Missing output files: resources/district_heat_share_base_s_39_2085.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:29:27 2024]
Finished job 142.
51 of 321 steps (16%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:27 2024]
localrule build_population_weighted_energy_totals:
    input: resources/heat_totals.csv, resources/pop_layout_base_s_39.csv
    output: resources/pop_weighted_heat_totals_s_39.csv
    log: logs/build_population_weighted_heat_totals_39.log
    jobid: 55
    reason: Missing output files: resources/pop_weighted_heat_totals_s_39.csv; Input files updated by another job: resources/heat_totals.csv, resources/pop_layout_base_s_39.csv
    wildcards: kind=heat, clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:29:28 2024]
Finished job 71.
52 of 321 steps (16%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:28 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2075.csv
    output: resources/industrial_production_base_s_39_2075.csv
    log: logs/build_industrial_production_per_node_39_2075.log
    jobid: 131
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2075
    reason: Missing output files: resources/industrial_production_base_s_39_2075.csv; Input files updated by another job: resources/industrial_production_per_country_tomorrow_2075.csv, resources/industrial_distribution_key_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:29 2024]
Finished job 55.
53 of 321 steps (17%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:29 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2055.csv
    output: resources/industrial_production_base_s_39_2055.csv
    log: logs/build_industrial_production_per_node_39_2055.log
    jobid: 113
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2055
    reason: Missing output files: resources/industrial_production_base_s_39_2055.csv; Input files updated by another job: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2055.csv
    wildcards: clusters=39, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:31 2024]
Finished job 131.
54 of 321 steps (17%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:31 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2065.csv
    output: resources/industrial_production_base_s_39_2065.csv
    log: logs/build_industrial_production_per_node_39_2065.log
    jobid: 122
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2065
    reason: Missing output files: resources/industrial_production_base_s_39_2065.csv; Input files updated by another job: resources/industrial_production_per_country_tomorrow_2065.csv, resources/industrial_distribution_key_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:32 2024]
Finished job 113.
55 of 321 steps (17%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:32 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2030.csv
    output: resources/industrial_production_base_s_39_2030.csv
    log: logs/build_industrial_production_per_node_39_2030.log
    jobid: 70
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2030
    reason: Missing output files: resources/industrial_production_base_s_39_2030.csv; Input files updated by another job: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2030.csv
    wildcards: clusters=39, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:33 2024]
Finished job 122.
56 of 321 steps (17%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:33 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2100.csv
    output: resources/industrial_production_base_s_39_2100.csv
    log: logs/build_industrial_production_per_node_39_2100.log
    jobid: 158
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2100
    reason: Missing output files: resources/industrial_production_base_s_39_2100.csv; Input files updated by another job: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2100.csv
    wildcards: clusters=39, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:34 2024]
Finished job 70.
57 of 321 steps (18%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:34 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2075.csv
    log: logs/build_district_heat_share_39_2075.log
    jobid: 133
    reason: Missing output files: resources/district_heat_share_base_s_39_2075.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:36 2024]
Finished job 158.
58 of 321 steps (18%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:36 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2085.csv
    output: resources/industrial_production_base_s_39_2085.csv
    log: logs/build_industrial_production_per_node_39_2085.log
    jobid: 140
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2085
    reason: Missing output files: resources/industrial_production_base_s_39_2085.csv; Input files updated by another job: resources/industrial_production_per_country_tomorrow_2085.csv, resources/industrial_distribution_key_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:39 2024]
Finished job 140.
59 of 321 steps (18%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:39 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2095.csv
    output: resources/industrial_production_base_s_39_2095.csv
    log: logs/build_industrial_production_per_node_39_2095.log
    jobid: 149
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2095
    reason: Missing output files: resources/industrial_production_base_s_39_2095.csv; Input files updated by another job: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2095.csv
    wildcards: clusters=39, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:29:40 2024]
Finished job 133.
60 of 321 steps (19%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:40 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2030.csv
    log: logs/build_district_heat_share_39_2030.log
    jobid: 76
    reason: Missing output files: resources/district_heat_share_base_s_39_2030.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:42 2024]
Finished job 149.
61 of 321 steps (19%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:42 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2035.csv
    output: resources/industrial_production_base_s_39_2035.csv
    log: logs/build_industrial_production_per_node_39_2035.log
    jobid: 86
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2035
    reason: Missing output files: resources/industrial_production_base_s_39_2035.csv; Input files updated by another job: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2035.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:45 2024]
Finished job 86.
62 of 321 steps (19%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:45 2024]
localrule build_industrial_energy_demand_per_node_today:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_energy_demand_per_country_today.csv
    output: resources/industrial_energy_demand_today_base_s_39.csv
    log: logs/build_industrial_energy_demand_per_node_today_39.log
    jobid: 75
    benchmark: benchmarks/build_industrial_energy_demand_per_node_today/s_39
    reason: Missing output files: resources/industrial_energy_demand_today_base_s_39.csv; Input files updated by another job: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_energy_demand_per_country_today.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 30.00% resulting in new average share of 21.36%
[Sat Sep 21 08:29:46 2024]
Finished job 76.
63 of 321 steps (20%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:46 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2095.csv
    log: logs/build_district_heat_share_39_2095.log
    jobid: 151
    reason: Missing output files: resources/district_heat_share_base_s_39_2095.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:47 2024]
Finished job 75.
64 of 321 steps (20%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:47 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2075.csv, resources/industrial_production_base_s_39_2075.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2075.csv
    log: logs/build_industrial_energy_demand_per_node_39_2075.log
    jobid: 129
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2075
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2075.csv; Input files updated by another job: resources/industrial_production_base_s_39_2075.csv, resources/industrial_energy_demand_today_base_s_39.csv, resources/industry_sector_ratios_2075.csv
    wildcards: clusters=39, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:49 2024]
Finished job 129.
65 of 321 steps (20%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:49 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2065.csv, resources/industrial_production_base_s_39_2065.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2065.csv
    log: logs/build_industrial_energy_demand_per_node_39_2065.log
    jobid: 120
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2065
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2065.csv; Input files updated by another job: resources/industry_sector_ratios_2065.csv, resources/industrial_energy_demand_today_base_s_39.csv, resources/industrial_production_base_s_39_2065.csv
    wildcards: clusters=39, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:29:51 2024]
Finished job 151.
66 of 321 steps (21%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:51 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2030.csv, resources/industrial_production_base_s_39_2030.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2030.csv
    log: logs/build_industrial_energy_demand_per_node_39_2030.log
    jobid: 63
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2030
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2030.csv; Input files updated by another job: resources/industrial_energy_demand_today_base_s_39.csv, resources/industry_sector_ratios_2030.csv, resources/industrial_production_base_s_39_2030.csv
    wildcards: clusters=39, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:51 2024]
Finished job 120.
67 of 321 steps (21%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:51 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2085.csv, resources/industrial_production_base_s_39_2085.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2085.csv
    log: logs/build_industrial_energy_demand_per_node_39_2085.log
    jobid: 138
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2085
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2085.csv; Input files updated by another job: resources/industrial_production_base_s_39_2085.csv, resources/industry_sector_ratios_2085.csv, resources/industrial_energy_demand_today_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:53 2024]
Finished job 63.
68 of 321 steps (21%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:53 2024]
localrule build_existing_heating_distribution:
    input: data/existing_infrastructure/existing_heating_raw.csv, resources/pop_layout_base_s_39.csv, resources/pop_weighted_energy_totals_s_39.csv, resources/district_heat_share_base_s_39_2030.csv
    output: resources/existing_heating_distribution_base_s_39_2030.csv
    log: logs/build_existing_heating_distribution_base_s_39_2030.log
    jobid: 79
    benchmark: benchmarks/build_existing_heating_distribution/base_s_39_2030
    reason: Missing output files: resources/existing_heating_distribution_base_s_39_2030.csv; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/district_heat_share_base_s_39_2030.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 08:29:53 2024]
Finished job 138.
69 of 321 steps (21%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:53 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2095.csv, resources/industrial_production_base_s_39_2095.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2095.csv
    log: logs/build_industrial_energy_demand_per_node_39_2095.log
    jobid: 147
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2095
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2095.csv; Input files updated by another job: resources/industrial_production_base_s_39_2095.csv, resources/industry_sector_ratios_2095.csv, resources/industrial_energy_demand_today_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:55 2024]
Finished job 79.
70 of 321 steps (22%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:55 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2035.csv
    log: logs/build_district_heat_share_39_2035.log
    jobid: 88
    reason: Missing output files: resources/district_heat_share_base_s_39_2035.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:55 2024]
Finished job 147.
71 of 321 steps (22%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:55 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2100.csv, resources/industrial_production_base_s_39_2100.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2100.csv
    log: logs/build_industrial_energy_demand_per_node_39_2100.log
    jobid: 156
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2100
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2100.csv; Input files updated by another job: resources/industry_sector_ratios_2100.csv, resources/industrial_energy_demand_today_base_s_39.csv, resources/industrial_production_base_s_39_2100.csv
    wildcards: clusters=39, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:57 2024]
Finished job 156.
72 of 321 steps (22%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:57 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2035.csv, resources/industrial_production_base_s_39_2035.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2035.csv
    log: logs/build_industrial_energy_demand_per_node_39_2035.log
    jobid: 84
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2035
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2035.csv; Input files updated by another job: resources/industry_sector_ratios_2035.csv, resources/industrial_production_base_s_39_2035.csv, resources/industrial_energy_demand_today_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:29:59 2024]
Finished job 84.
73 of 321 steps (23%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:29:59 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2045.csv
    output: resources/industrial_production_base_s_39_2045.csv
    log: logs/build_industrial_production_per_node_39_2045.log
    jobid: 95
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2045
    reason: Missing output files: resources/industrial_production_base_s_39_2045.csv; Input files updated by another job: resources/industrial_production_per_country_tomorrow_2045.csv, resources/industrial_distribution_key_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 45.00% resulting in new average share of 25.65%
[Sat Sep 21 08:30:01 2024]
Finished job 88.
74 of 321 steps (23%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:30:01 2024]
localrule build_district_heat_share:
    input: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    output: resources/district_heat_share_base_s_39_2100.csv
    log: logs/build_district_heat_share_39_2100.log
    jobid: 160
    reason: Missing output files: resources/district_heat_share_base_s_39_2100.csv; Input files updated by another job: resources/district_heat_share.csv, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:30:02 2024]
Finished job 95.
75 of 321 steps (23%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:30:02 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2045.csv, resources/industrial_production_base_s_39_2045.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2045.csv
    log: logs/build_industrial_energy_demand_per_node_39_2045.log
    jobid: 93
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2045
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2045.csv; Input files updated by another job: resources/industrial_production_base_s_39_2045.csv, resources/industry_sector_ratios_2045.csv, resources/industrial_energy_demand_today_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:30:03 2024]
Finished job 93.
76 of 321 steps (24%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:30:04 2024]
localrule build_industrial_production_per_node:
    input: resources/industrial_distribution_key_base_s_39.csv, resources/industrial_production_per_country_tomorrow_2050.csv
    output: resources/industrial_production_base_s_39_2050.csv
    log: logs/build_industrial_production_per_node_39_2050.log
    jobid: 104
    benchmark: benchmarks/build_industrial_production_per_node/s_39_2050
    reason: Missing output files: resources/industrial_production_base_s_39_2050.csv; Input files updated by another job: resources/industrial_production_per_country_tomorrow_2050.csv, resources/industrial_distribution_key_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Sat Sep 21 08:30:07 2024]
Finished job 104.
77 of 321 steps (24%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:30:07 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2055.csv, resources/industrial_production_base_s_39_2055.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2055.csv
    log: logs/build_industrial_energy_demand_per_node_39_2055.log
    jobid: 111
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2055
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2055.csv; Input files updated by another job: resources/industrial_production_base_s_39_2055.csv, resources/industry_sector_ratios_2055.csv, resources/industrial_energy_demand_today_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:30:07 2024]
Finished job 160.
78 of 321 steps (24%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:30:07 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/industry_sector_ratios_2050.csv, resources/industrial_production_base_s_39_2050.csv, resources/industrial_energy_demand_today_base_s_39.csv
    output: resources/industrial_energy_demand_base_s_39_2050.csv
    log: logs/build_industrial_energy_demand_per_node_39_2050.log
    jobid: 102
    benchmark: benchmarks/build_industrial_energy_demand_per_node/s_39_2050
    reason: Missing output files: resources/industrial_energy_demand_base_s_39_2050.csv; Input files updated by another job: resources/industrial_energy_demand_today_base_s_39.csv, resources/industry_sector_ratios_2050.csv, resources/industrial_production_base_s_39_2050.csv
    wildcards: clusters=39, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

[Sat Sep 21 08:30:08 2024]
Finished job 111.
79 of 321 steps (25%) done
Select jobs to execute...
Waiting for more resources.
[Sat Sep 21 08:30:09 2024]
Finished job 102.
80 of 321 steps (25%) done
Execute 1 jobs...

[Sat Sep 21 08:30:09 2024]
localrule build_solar_thermal_profiles:
    input: resources/pop_layout_total.nc, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/solar_thermal_total_base_s_39.nc
    log: logs/build_solar_thermal_profiles_total_s_39.log
    jobid: 48
    benchmark: benchmarks/build_solar_thermal_profiles/total_39
    reason: Missing output files: resources/solar_thermal_total_base_s_39.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/pop_layout_total.nc
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

[Sat Sep 21 08:38:19 2024]
Finished job 48.
81 of 321 steps (25%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:38:19 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2050.csv, resources/biomass_potentials_s_39_2050.csv
    log: logs/build_biomass_potentials_s_39_2050.log
    jobid: 101
    benchmark: benchmarks/build_biomass_potentials_s_39_2050
    reason: Missing output files: resources/biomass_potentials_s_39_2050.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2050
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Using biomass potentials for 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:35,  2.97s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:54,  1.81s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:44,  1.60s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.53s/ country]Build from eurostat database:  24%|██▍       | 8/33 [00:11<00:29,  1.20s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:37,  1.57s/ country]Build from eurostat database:  30%|███       | 10/33 [00:14<00:27,  1.19s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:35,  1.61s/ country]Build from eurostat database:  36%|███▋      | 12/33 [00:17<00:24,  1.19s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:32,  1.62s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:20<00:22,  1.18s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:29,  1.63s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:22<00:20,  1.20s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:26,  1.63s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:25<00:17,  1.19s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:23,  1.65s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:15,  1.21s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:19,  1.64s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:31<00:13,  1.21s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:16,  1.64s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:10,  1.19s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:13,  1.65s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:09,  1.54s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:39<00:05,  1.19s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:06,  1.59s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:42<00:03,  1.19s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:03,  1.64s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.24s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.43s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmplxl_lb6_.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:39:22 2024]
Finished job 101.
82 of 321 steps (26%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:39:22 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, data/bundle/gebco/GEBCO_2014_2D.nc, resources/shipdensity_raster.tif, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/regions_offshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/availability_matrix_39_offwind-dc.nc
    log: logs/determine_availability_matrix_39_offwind-dc.log
    jobid: 26
    benchmark: benchmarks/determine_availability_matrix_39_offwind-dc
    reason: Missing output files: resources/availability_matrix_39_offwind-dc.nc; Input files updated by another job: resources/shipdensity_raster.tif, resources/regions_offshore_base_s_39.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-dc
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for offwind-dc...
INFO:__main__:Completed landuse availability calculation for offwind-dc (61.30s)
[Sat Sep 21 08:40:25 2024]
Finished job 26.
83 of 321 steps (26%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:40:25 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2065.csv, resources/biomass_potentials_s_39_2065.csv
    log: logs/build_biomass_potentials_s_39_2065.log
    jobid: 119
    benchmark: benchmarks/build_biomass_potentials_s_39_2065
    reason: Missing output files: resources/biomass_potentials_s_39_2065.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2065
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:35,  2.99s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:54,  1.82s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:45,  1.61s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.52s/ country]Build from eurostat database:  24%|██▍       | 8/33 [00:11<00:30,  1.21s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:37,  1.58s/ country]Build from eurostat database:  30%|███       | 10/33 [00:14<00:28,  1.22s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:35,  1.61s/ country]Build from eurostat database:  36%|███▋      | 12/33 [00:17<00:25,  1.21s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:20<00:32,  1.62s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:20<00:23,  1.22s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:29,  1.64s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:23<00:20,  1.21s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:26,  1.64s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:25<00:18,  1.22s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:23,  1.65s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:16,  1.24s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:19,  1.63s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:31<00:13,  1.24s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:16,  1.66s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:10,  1.22s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:37<00:13,  1.66s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:37<00:08,  1.21s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:40<00:09,  1.65s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:40<00:06,  1.20s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:06,  1.65s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:43<00:03,  1.21s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:03,  1.67s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:46<00:01,  1.21s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.27s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.44s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpnuu056c1.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:41:29 2024]
Finished job 119.
84 of 321 steps (26%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:41:29 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, data/bundle/gebco/GEBCO_2014_2D.nc, resources/shipdensity_raster.tif, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/regions_offshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/availability_matrix_39_offwind-float.nc
    log: logs/determine_availability_matrix_39_offwind-float.log
    jobid: 28
    benchmark: benchmarks/determine_availability_matrix_39_offwind-float
    reason: Missing output files: resources/availability_matrix_39_offwind-float.nc; Input files updated by another job: resources/shipdensity_raster.tif, resources/regions_offshore_base_s_39.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-float
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for offwind-float...
INFO:__main__:Completed landuse availability calculation for offwind-float (67.29s)
[Sat Sep 21 08:42:38 2024]
Finished job 28.
85 of 321 steps (26%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:42:38 2024]
localrule build_temperature_profiles:
    input: resources/pop_layout_total.nc, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc
    log: logs/build_temperature_profiles_total_s_39.log
    jobid: 59
    benchmark: benchmarks/build_temperature_profiles/total_39
    reason: Missing output files: resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/pop_layout_total.nc
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

[Sat Sep 21 08:45:28 2024]
Finished job 59.
86 of 321 steps (27%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:45:28 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2085.csv, resources/biomass_potentials_s_39_2085.csv
    log: logs/build_biomass_potentials_s_39_2085.log
    jobid: 137
    benchmark: benchmarks/build_biomass_potentials_s_39_2085
    reason: Missing output files: resources/biomass_potentials_s_39_2085.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2085
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:33,  2.92s/ country]Build from eurostat database:   6%|▌         | 2/33 [00:03<00:39,  1.29s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:58,  1.94s/ country]Build from eurostat database:  12%|█▏        | 4/33 [00:05<00:35,  1.23s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:48,  1.75s/ country]Build from eurostat database:  18%|█▊        | 6/33 [00:08<00:32,  1.20s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:44,  1.69s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:37,  1.56s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:32,  1.49s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:29,  1.46s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:25,  1.44s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:22<00:20,  1.19s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:24,  1.52s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:25<00:17,  1.20s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:22,  1.59s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:15,  1.20s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:19,  1.62s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:31<00:13,  1.19s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:16,  1.62s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:10,  1.21s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:12,  1.62s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:37<00:08,  1.21s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:09,  1.63s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:39<00:06,  1.20s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:06,  1.63s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:42<00:03,  1.20s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:03,  1.64s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:45<00:01,  1.21s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.25s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.42s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpjvq1_92y.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:46:30 2024]
Finished job 137.
87 of 321 steps (27%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:46:31 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2055.csv, resources/biomass_potentials_s_39_2055.csv
    log: logs/build_biomass_potentials_s_39_2055.log
    jobid: 110
    benchmark: benchmarks/build_biomass_potentials_s_39_2055
    reason: Missing output files: resources/biomass_potentials_s_39_2055.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2055
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:35,  2.98s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:55,  1.84s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:45,  1.64s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:40,  1.55s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:36,  1.51s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:32,  1.49s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:20<00:29,  1.48s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:23<00:26,  1.45s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:23,  1.44s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:26<00:17,  1.20s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:21,  1.53s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:29<00:15,  1.22s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:19,  1.60s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:15,  1.53s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:10,  1.21s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:37<00:12,  1.59s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:37<00:08,  1.22s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:40<00:09,  1.62s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:40<00:06,  1.22s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:43<00:06,  1.64s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:43<00:03,  1.22s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:46<00:03,  1.66s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:46<00:01,  1.22s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.28s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.45s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp67m3yzbo.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:47:34 2024]
Finished job 110.
88 of 321 steps (27%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:47:34 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2095.csv, resources/biomass_potentials_s_39_2095.csv
    log: logs/build_biomass_potentials_s_39_2095.log
    jobid: 146
    benchmark: benchmarks/build_biomass_potentials_s_39_2095
    reason: Missing output files: resources/biomass_potentials_s_39_2095.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2095
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:34,  2.96s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:55,  1.85s/ country]Build from eurostat database:  12%|█▏        | 4/33 [00:05<00:36,  1.24s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:48,  1.74s/ country]Build from eurostat database:  18%|█▊        | 6/33 [00:08<00:33,  1.22s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:44,  1.70s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:37,  1.58s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:33,  1.51s/ country]Build from eurostat database:  36%|███▋      | 12/33 [00:17<00:25,  1.21s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:20<00:31,  1.57s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:20<00:22,  1.21s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:23<00:29,  1.61s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:23<00:20,  1.21s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:26,  1.63s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:26<00:18,  1.24s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:23,  1.65s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:29<00:16,  1.25s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:19,  1.63s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:31<00:13,  1.24s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:16,  1.63s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:11,  1.26s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:37<00:12,  1.62s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:37<00:08,  1.27s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:40<00:09,  1.61s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:40<00:06,  1.26s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:43<00:06,  1.61s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:43<00:03,  1.27s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:46<00:03,  1.62s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:46<00:01,  1.27s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.26s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.45s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp1iouh1er.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:48:38 2024]
Finished job 146.
89 of 321 steps (28%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:48:38 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/availability_matrix_39_onwind.nc
    log: logs/determine_availability_matrix_39_onwind.log
    jobid: 42
    benchmark: benchmarks/determine_availability_matrix_39_onwind
    reason: Missing output files: resources/availability_matrix_39_onwind.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=onwind
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for onwind...
INFO:__main__:Completed landuse availability calculation for onwind (97.59s)
[Sat Sep 21 08:50:18 2024]
Finished job 42.
90 of 321 steps (28%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:50:18 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2045.csv, resources/biomass_potentials_s_39_2045.csv
    log: logs/build_biomass_potentials_s_39_2045.log
    jobid: 92
    benchmark: benchmarks/build_biomass_potentials_s_39_2045
    reason: Missing output files: resources/biomass_potentials_s_39_2045.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2045
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for 2045, interpolating linearly between 2040 and 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:32,  2.91s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:54,  1.82s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:45,  1.61s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.54s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:36,  1.50s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:32,  1.48s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:20<00:29,  1.46s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:20<00:22,  1.20s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:27,  1.53s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:23<00:20,  1.20s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:25,  1.59s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:21,  1.52s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:17,  1.49s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:14,  1.48s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:37<00:11,  1.46s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:40<00:08,  1.44s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:05,  1.44s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:02,  1.44s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.22s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.43s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmphy1g6cr3.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:51:31 2024]
Finished job 92.
91 of 321 steps (28%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:51:31 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2075.csv, resources/biomass_potentials_s_39_2075.csv
    log: logs/build_biomass_potentials_s_39_2075.log
    jobid: 128
    benchmark: benchmarks/build_biomass_potentials_s_39_2075
    reason: Missing output files: resources/biomass_potentials_s_39_2075.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2075
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:34,  2.97s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:55,  1.84s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:45,  1.61s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.53s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:35,  1.48s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:32,  1.46s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:28,  1.44s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:20<00:22,  1.19s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:27,  1.51s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:22<00:20,  1.19s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:24,  1.56s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:25<00:17,  1.19s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:22,  1.62s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:15,  1.20s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:19,  1.64s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:15,  1.54s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:11,  1.49s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:08,  1.47s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:05,  1.45s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:02,  1.44s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:45<00:01,  1.19s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.24s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:47<00:00,  1.43s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp_myxhwkz.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:52:34 2024]
Finished job 128.
92 of 321 steps (29%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:52:34 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/availability_matrix_39_solar.nc
    log: logs/determine_availability_matrix_39_solar.log
    jobid: 38
    benchmark: benchmarks/determine_availability_matrix_39_solar
    reason: Missing output files: resources/availability_matrix_39_solar.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for solar...
INFO:__main__:Completed landuse availability calculation for solar (64.69s)
[Sat Sep 21 08:53:41 2024]
Finished job 38.
93 of 321 steps (29%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:53:41 2024]
localrule build_renewable_profiles:
    input: resources/availability_matrix_39_offwind-dc.nc, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_39_offwind-dc.nc
    log: logs/build_renewable_profile_39_offwind-dc.log
    jobid: 25
    benchmark: benchmarks/build_renewable_profiles_39_offwind-dc
    reason: Missing output files: resources/profile_39_offwind-dc.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/availability_matrix_39_offwind-dc.nc, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-dc
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:correction_factor is set as 0.8855
INFO:__main__:Calculate average capacity factor for technology offwind-dc...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology offwind-dc (102.33s)
INFO:__main__:Calculate weighted capacity factor time series for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-dc...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-dc (100.92s)
INFO:__main__:Calculating maximal capacity per bus for technology offwind-dc
INFO:__main__:Calculate average distances for technology offwind-dc.
[Sat Sep 21 08:57:11 2024]
Finished job 25.
94 of 321 steps (29%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:57:11 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2030.csv, resources/biomass_potentials_s_39_2030.csv
    log: logs/build_biomass_potentials_s_39_2030.log
    jobid: 60
    benchmark: benchmarks/build_biomass_potentials_s_39_2030
    reason: Missing output files: resources/biomass_potentials_s_39_2030.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2030
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:Using biomass potentials for 2030.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:29,  2.81s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:51,  1.71s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:42,  1.53s/ country]Build from eurostat database:  21%|██        | 7/33 [00:10<00:37,  1.45s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:13<00:33,  1.40s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:16<00:30,  1.37s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:18<00:27,  1.36s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:21<00:24,  1.35s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:21<00:19,  1.12s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:24<00:22,  1.41s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:24<00:16,  1.12s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:26<00:20,  1.48s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:27<00:14,  1.14s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:29<00:17,  1.50s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:29<00:12,  1.14s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:32<00:15,  1.51s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:32<00:10,  1.14s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:34<00:12,  1.51s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:35<00:08,  1.16s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:37<00:09,  1.51s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:37<00:05,  1.14s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:40<00:06,  1.51s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:40<00:03,  1.13s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:42<00:03,  1.53s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:43<00:01,  1.14s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:44<00:00,  1.17s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:44<00:00,  1.34s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpo3x0msew.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 08:58:11 2024]
Finished job 60.
95 of 321 steps (30%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:58:11 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, data/bundle/gebco/GEBCO_2014_2D.nc, resources/shipdensity_raster.tif, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/regions_offshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/availability_matrix_39_offwind-ac.nc
    log: logs/determine_availability_matrix_39_offwind-ac.log
    jobid: 7
    benchmark: benchmarks/determine_availability_matrix_39_offwind-ac
    reason: Missing output files: resources/availability_matrix_39_offwind-ac.nc; Input files updated by another job: resources/shipdensity_raster.tif, resources/regions_offshore_base_s_39.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-ac
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for offwind-ac...
INFO:__main__:Completed landuse availability calculation for offwind-ac (58.19s)
[Sat Sep 21 08:59:11 2024]
Finished job 7.
96 of 321 steps (30%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 08:59:11 2024]
localrule build_renewable_profiles:
    input: resources/availability_matrix_39_offwind-ac.nc, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_39_offwind-ac.nc
    log: logs/build_renewable_profile_39_offwind-ac.log
    jobid: 6
    benchmark: benchmarks/build_renewable_profiles_39_offwind-ac
    reason: Missing output files: resources/profile_39_offwind-ac.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/availability_matrix_39_offwind-ac.nc, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-ac
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:correction_factor is set as 0.8855
INFO:__main__:Calculate average capacity factor for technology offwind-ac...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology offwind-ac (96.14s)
INFO:__main__:Calculate weighted capacity factor time series for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-ac...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-ac (95.97s)
INFO:__main__:Calculating maximal capacity per bus for technology offwind-ac
INFO:__main__:Calculate average distances for technology offwind-ac.
[Sat Sep 21 09:02:30 2024]
Finished job 6.
97 of 321 steps (30%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:02:30 2024]
localrule build_renewable_profiles:
    input: resources/availability_matrix_39_solar.nc, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_39_solar.nc
    log: logs/build_renewable_profile_39_solar.log
    jobid: 37
    benchmark: benchmarks/build_renewable_profiles_39_solar
    reason: Missing output files: resources/profile_39_solar.nc; Input files updated by another job: resources/availability_matrix_39_solar.nc, resources/regions_onshore_base_s_39.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate average capacity factor for technology solar...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed average capacity factor calculation for technology solar (376.69s)
INFO:__main__:Calculate weighted capacity factor time series for model CSi for technology solar...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed weighted capacity factor time series calculation for model CSi for technology solar (377.68s)
INFO:__main__:Calculating maximal capacity per bus for technology solar
INFO:__main__:Calculate average distances for technology solar.
[Sat Sep 21 09:15:10 2024]
Finished job 37.
98 of 321 steps (31%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:15:10 2024]
localrule build_renewable_profiles:
    input: resources/availability_matrix_39_offwind-float.nc, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_39_offwind-float.nc
    log: logs/build_renewable_profile_39_offwind-float.log
    jobid: 27
    benchmark: benchmarks/build_renewable_profiles_39_offwind-float
    reason: Missing output files: resources/profile_39_offwind-float.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/offshore_shapes.geojson, resources/availability_matrix_39_offwind-float.nc
    wildcards: clusters=39, technology=offwind-float
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:correction_factor is set as 0.8855
INFO:__main__:Calculate average capacity factor for technology offwind-float...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology offwind-float (95.55s)
INFO:__main__:Calculate weighted capacity factor time series for model NREL_ReferenceTurbine_5MW_offshore for technology offwind-float...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model NREL_ReferenceTurbine_5MW_offshore for technology offwind-float (95.51s)
INFO:__main__:Calculating maximal capacity per bus for technology offwind-float
INFO:__main__:Calculate average distances for technology offwind-float.
[Sat Sep 21 09:18:28 2024]
Finished job 27.
99 of 321 steps (31%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:18:28 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, resources/country_shapes.geojson, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/availability_matrix_39_solar-hsat.nc
    log: logs/determine_availability_matrix_39_solar-hsat.log
    jobid: 40
    benchmark: benchmarks/determine_availability_matrix_39_solar-hsat
    reason: Missing output files: resources/availability_matrix_39_solar-hsat.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar-hsat
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for solar-hsat...
INFO:__main__:Completed landuse availability calculation for solar-hsat (61.71s)
[Sat Sep 21 09:19:32 2024]
Finished job 40.
100 of 321 steps (31%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:19:32 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2100.csv, resources/biomass_potentials_s_39_2100.csv
    log: logs/build_biomass_potentials_s_39_2100.log
    jobid: 155
    benchmark: benchmarks/build_biomass_potentials_s_39_2100
    reason: Missing output files: resources/biomass_potentials_s_39_2100.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2100
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:26,  2.72s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:51,  1.71s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:42,  1.51s/ country]Build from eurostat database:  21%|██        | 7/33 [00:10<00:37,  1.44s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:13<00:33,  1.39s/ country]Build from eurostat database:  30%|███       | 10/33 [00:13<00:25,  1.13s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:16<00:31,  1.44s/ country]Build from eurostat database:  36%|███▋      | 12/33 [00:16<00:23,  1.12s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:18<00:29,  1.48s/ country]Build from eurostat database:  42%|████▏     | 14/33 [00:18<00:21,  1.12s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:21<00:26,  1.49s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:21<00:19,  1.13s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:23<00:24,  1.50s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:24<00:17,  1.14s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:26<00:21,  1.52s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:26<00:14,  1.15s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:29<00:18,  1.52s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:29<00:12,  1.15s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:31<00:15,  1.51s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:32<00:10,  1.15s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:34<00:12,  1.51s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:34<00:08,  1.16s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:37<00:09,  1.51s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:37<00:05,  1.16s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:39<00:06,  1.51s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:40<00:03,  1.15s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:42<00:02,  1.50s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:42<00:01,  1.16s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:44<00:00,  1.16s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:44<00:00,  1.33s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpzqesr_rr.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 09:20:30 2024]
Finished job 155.
101 of 321 steps (31%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:20:30 2024]
localrule build_daily_heat_demand:
    input: resources/pop_layout_total.nc, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/daily_heat_demand_total_base_s_39.nc
    log: logs/build_daily_heat_demand_total_s_39.loc
    jobid: 46
    benchmark: benchmarks/build_daily_heat_demand/total_s_39
    reason: Missing output files: resources/daily_heat_demand_total_base_s_39.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/pop_layout_total.nc
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

[Sat Sep 21 09:21:47 2024]
Finished job 46.
102 of 321 steps (32%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:21:47 2024]
localrule build_hourly_heat_demand:
    input: data/heat_load_profile_BDEW.csv, resources/daily_heat_demand_total_base_s_39.nc
    output: resources/hourly_heat_demand_total_base_s_39.nc
    log: logs/build_hourly_heat_demand_total_s_39.loc
    jobid: 45
    benchmark: benchmarks/build_hourly_heat_demand/total_s_39
    reason: Missing output files: resources/hourly_heat_demand_total_base_s_39.nc; Input files updated by another job: resources/daily_heat_demand_total_base_s_39.nc
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:21:51 2024]
Finished job 45.
103 of 321 steps (32%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:21:51 2024]
localrule build_renewable_profiles:
    input: resources/availability_matrix_39_solar-hsat.nc, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_39_solar-hsat.nc
    log: logs/build_renewable_profile_39_solar-hsat.log
    jobid: 39
    benchmark: benchmarks/build_renewable_profiles_39_solar-hsat
    reason: Missing output files: resources/profile_39_solar-hsat.nc; Input files updated by another job: resources/availability_matrix_39_solar-hsat.nc, resources/regions_onshore_base_s_39.geojson, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar-hsat
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate average capacity factor for technology solar-hsat...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed average capacity factor calculation for technology solar-hsat (385.68s)
INFO:__main__:Calculate weighted capacity factor time series for model CSi for technology solar-hsat...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed weighted capacity factor time series calculation for model CSi for technology solar-hsat (386.23s)
INFO:__main__:Calculating maximal capacity per bus for technology solar-hsat
INFO:__main__:Calculate average distances for technology solar-hsat.
[Sat Sep 21 09:34:50 2024]
Finished job 39.
104 of 321 steps (32%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:34:50 2024]
localrule build_renewable_profiles:
    input: resources/availability_matrix_39_onwind.nc, resources/offshore_shapes.geojson, resources/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/profile_39_onwind.nc
    log: logs/build_renewable_profile_39_onwind.log
    jobid: 41
    benchmark: benchmarks/build_renewable_profiles_39_onwind
    reason: Missing output files: resources/profile_39_onwind.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/availability_matrix_39_onwind.nc, resources/offshore_shapes.geojson
    wildcards: clusters=39, technology=onwind
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate average capacity factor for technology onwind...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology onwind (95.39s)
INFO:__main__:Calculate weighted capacity factor time series for model Vestas_V112_3MW for technology onwind...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model Vestas_V112_3MW for technology onwind (95.19s)
INFO:__main__:Calculating maximal capacity per bus for technology onwind
INFO:__main__:Calculate average distances for technology onwind.
[Sat Sep 21 09:38:06 2024]
Finished job 41.
105 of 321 steps (33%) done
Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 09:38:06 2024]
localrule build_central_heating_temperature_profiles:
    input: resources/temp_air_total_base_s_39.nc, resources/regions_onshore_base_s_39.geojson
    output: resources/central_heating_forward_temperature_profiles_base_s_39.nc, resources/central_heating_return_temperature_profiles_base_s_39.nc
    log: logs/build_central_heating_temperature_profiles_s_39.log
    jobid: 78
    benchmark: benchmarks/build_central_heating_temperature_profiles/s_39
    reason: Missing output files: resources/central_heating_return_temperature_profiles_base_s_39.nc, resources/central_heating_forward_temperature_profiles_base_s_39.nc; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/temp_air_total_base_s_39.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

[Sat Sep 21 09:38:06 2024]
localrule build_transport_demand:
    input: resources/pop_layout_base_s_39.csv, resources/pop_weighted_energy_totals_s_39.csv, resources/transport_data.csv, data/bundle/emobility/KFZ__count, data/bundle/emobility/Pkw__count, resources/temp_air_total_base_s_39.nc
    output: resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv
    log: logs/build_transport_demand_s_39.log
    jobid: 58
    reason: Missing output files: resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/transport_demand_s_39.csv; Input files updated by another job: resources/transport_data.csv, resources/pop_weighted_energy_totals_s_39.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:38:08 2024]
Finished job 78.
106 of 321 steps (33%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:38:08 2024]
localrule build_cop_profiles:
    input: resources/central_heating_forward_temperature_profiles_base_s_39.nc, resources/central_heating_return_temperature_profiles_base_s_39.nc, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/regions_onshore_base_s_39.geojson
    output: resources/cop_profiles_base_s_39.nc
    log: logs/build_cop_profiles_s_39.log
    jobid: 77
    benchmark: benchmarks/build_cop_profiles/s_39
    reason: Missing output files: resources/cop_profiles_base_s_39.nc; Input files updated by another job: resources/temp_soil_total_base_s_39.nc, resources/regions_onshore_base_s_39.geojson, resources/central_heating_return_temperature_profiles_base_s_39.nc, resources/central_heating_forward_temperature_profiles_base_s_39.nc, resources/temp_air_total_base_s_39.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=20000, mem_mib=19074

[Sat Sep 21 09:38:11 2024]
Finished job 77.
107 of 321 steps (33%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:38:11 2024]
localrule add_electricity:
    input: resources/profile_39_solar.nc, resources/profile_39_solar-hsat.nc, resources/profile_39_onwind.nc, resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/profile_hydro.nc, data/nuclear_p_max_pu.csv, resources/networks/base_s_39.nc, resources/costs_2030.csv, resources/regions_onshore_base_s_39.geojson, resources/powerplants_s_39.csv, data/hydro_capacities.csv, data/unit_commitment.csv, resources/electricity_demand_base_s.nc, resources/busmap_base_s_39.csv
    output: resources/networks/base_s_39_elec.nc
    log: logs/add_electricity_39.log
    jobid: 36
    benchmark: benchmarks/add_electricity_39
    reason: Missing output files: resources/networks/base_s_39_elec.nc; Input files updated by another job: resources/profile_39_solar-hsat.nc, resources/regions_onshore_base_s_39.geojson, resources/electricity_demand_base_s.nc, resources/powerplants_s_39.csv, resources/busmap_base_s_39.csv, resources/networks/base_s_39.nc, resources/profile_39_offwind-ac.nc, resources/profile_39_solar.nc, resources/profile_39_offwind-float.nc, resources/profile_hydro.nc, resources/profile_39_onwind.nc, resources/profile_39_offwind-dc.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/go73lez2, mem_mb=10000, mem_mib=9537

[Sat Sep 21 09:38:11 2024]
Finished job 58.
108 of 321 steps (34%) done
Select jobs to execute...
Waiting for more resources.
INFO:pypsa.io:Imported network base_s_39.nc has buses, carriers, lines, links
INFO:__main__:Load data scaled by factor 1.0.
INFO:__main__:Adding 114 generators with capacities [GW]pp 
carrier
CCGT          193.84
OCGT            0.05
biomass        21.47
coal           66.74
geothermal      0.06
lignite        49.26
nuclear       110.66
oil             3.40
Name: p_nom, dtype: float64
INFO:__main__:Added connection cost of 2477-61731 Eur/MW/a to offwind-float
INFO:__main__:Added connection cost of 2783-21962 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 10695-41095 Eur/MW/a to offwind-dc
WARNING:__main__:Assuming max_hours=6 for hydro reservoirs in the countries: AL, ME
INFO:__main__:Skipping renewable capacity estimation because they are added later in rule `add_existing_baseyear` with foresight mode 'myopic'.
WARNING:__main__:tech_colors for carriers [''] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_elec.nc' contains: buses, links, generators, loads, carriers, lines, storage_units, stores
[Sat Sep 21 09:38:26 2024]
Finished job 36.
109 of 321 steps (34%) done
Execute 1 jobs...

[Sat Sep 21 09:38:26 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/country_shapes.geojson
    output: resources/biomass_potentials_all_39_2035.csv, resources/biomass_potentials_s_39_2035.csv
    log: logs/build_biomass_potentials_s_39_2035.log
    jobid: 83
    benchmark: benchmarks/build_biomass_potentials_s_39_2035
    reason: Missing output files: resources/biomass_potentials_s_39_2035.csv; Input files updated by another job: resources/regions_onshore_base_s_39.geojson, resources/country_shapes.geojson
    wildcards: clusters=39, planning_horizons=2035
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for 2035, interpolating linearly between 2030 and 2040.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:29,  2.79s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:50,  1.67s/ country]Build from eurostat database:  12%|█▏        | 4/33 [00:05<00:32,  1.13s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:07<00:44,  1.59s/ country]Build from eurostat database:  21%|██        | 7/33 [00:10<00:38,  1.46s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:13<00:33,  1.40s/ country]Build from eurostat database:  30%|███       | 10/33 [00:13<00:25,  1.11s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:15<00:32,  1.47s/ country]Build from eurostat database:  36%|███▋      | 12/33 [00:16<00:23,  1.12s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:18<00:30,  1.50s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:21<00:25,  1.43s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:23<00:22,  1.39s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:26<00:19,  1.37s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:26<00:14,  1.11s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:29<00:17,  1.44s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:29<00:12,  1.12s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:31<00:14,  1.49s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:32<00:10,  1.12s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:34<00:12,  1.52s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:37<00:08,  1.44s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:39<00:05,  1.40s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:42<00:02,  1.37s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:44<00:00,  1.14s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:44<00:00,  1.33s/ country]
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpa7rue58a.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Sat Sep 21 09:39:33 2024]
Finished job 83.
110 of 321 steps (34%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:39:33 2024]
localrule prepare_network:
    input: resources/networks/base_s_39_elec.nc, resources/costs_2030.csv
    output: resources/networks/base_s_39_elec_lvopt_.nc
    log: logs/prepare_network_base_s_39_elec_lvopt_.log
    jobid: 35
    benchmark: benchmarks/prepare_network_base_s_39_elec_lvopt_
    reason: Missing output files: resources/networks/base_s_39_elec_lvopt_.nc; Input files updated by another job: resources/networks/base_s_39_elec.nc
    wildcards: clusters=39, ll=vopt, opts=
    resources: tmpdir=/tmp/go73lez2, mem_mb=4000, mem_mib=3815

INFO:pypsa.io:Imported network base_s_39_elec.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:N-1 security margin of lines set to 0.7
INFO:__main__:Limiting line extensions to 20000 MW
INFO:__main__:Limiting link extensions to 30000 MW
INFO:pypsa.io:Exported network 'base_s_39_elec_lvopt_.nc' contains: generators, lines, storage_units, loads, buses, links, carriers, stores
[Sat Sep 21 09:39:36 2024]
Finished job 35.
111 of 321 steps (35%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:39:36 2024]
localrule time_aggregation:
    input: resources/networks/base_s_39_elec_lvopt_.nc, resources/hourly_heat_demand_total_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: resources/snapshot_weightings_base_s_39_elec_lvopt__.csv
    log: logs/time_aggregation_base_s_39_elec_lvopt__.log
    jobid: 34
    benchmark: benchmarks/time_aggregation_base_s_39_elec_lvopt__
    reason: Missing output files: resources/snapshot_weightings_base_s_39_elec_lvopt__.csv; Input files updated by another job: resources/solar_thermal_total_base_s_39.nc, resources/hourly_heat_demand_total_base_s_39.nc, resources/networks/base_s_39_elec_lvopt_.nc
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=
    resources: tmpdir=/tmp/go73lez2, mem_mb=5000, mem_mib=4769

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Averaging every 3h hours
[Sat Sep 21 09:39:39 2024]
Finished job 34.
112 of 321 steps (35%) done
Select jobs to execute...
Execute 2 jobs...

[Sat Sep 21 09:39:39 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2075.csv, resources/costs_2075.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2075.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/district_heat_share_base_s_39_2075.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2075.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2075.log
    jobid: 308
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2075
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2075.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2075.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2075.csv, resources/co2_totals.csv, resources/biomass_potentials_s_39_2075.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:39:40 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2085.csv, resources/costs_2085.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2085.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2085.csv, resources/district_heat_share_base_s_39_2085.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2085.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2085.log
    jobid: 311
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2085
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2085.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/industrial_production_base_s_39_2085.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/biomass_potentials_s_39_2085.csv, resources/transport_data_s_39.csv, resources/transport_demand_s_39.csv, resources/district_heat_share_base_s_39_2085.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/industrial_energy_demand_base_s_39_2085.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Adding electricity generation
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding electricity generation
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmphcmklh8t.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpja_5cm2c.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral resistive heater', 'rural biomass boiler', 'rural water tanks charger', 'urban decentral air heat pump', 'urban decentral water tanks discharger', 'rural resistive heater', 'rural gas boiler', 'rural water tanks discharger', 'urban decentral gas boiler', 'urban decentral biomass boiler', 'urban decentral water tanks charger', 'rural ground heat pump', 'rural air heat pump'] not defined in config.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural air heat pump', 'rural gas boiler', 'urban decentral air heat pump', 'rural water tanks discharger', 'urban decentral water tanks discharger', 'rural water tanks charger', 'rural ground heat pump', 'urban decentral gas boiler', 'rural biomass boiler', 'urban decentral resistive heater', 'urban decentral biomass boiler', 'rural resistive heater', 'urban decentral water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2085.nc' contains: links, generators, lines, global_constraints, storage_units, stores, buses, carriers, loads
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: stores, global_constraints, loads, lines, generators, carriers, storage_units, buses, links
[Sat Sep 21 09:39:50 2024]
Finished job 308.
113 of 321 steps (35%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:39:50 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2045.csv, resources/costs_2045.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2045.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2045.csv, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2045.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2045.log
    jobid: 91
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2045
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2045.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/biomass_potentials_s_39_2045.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2045.csv, resources/industrial_production_base_s_39_2045.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:39:51 2024]
Finished job 311.
114 of 321 steps (36%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:39:51 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2035.csv, resources/costs_2035.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/district_heat_share_base_s_39_2035.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2035.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2035.log
    jobid: 189
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2035.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/biomass_potentials_s_39_2035.csv, resources/profile_39_offwind-ac.nc, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2035.csv, resources/co2_totals.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 85.0%
INFO:__main__:ice share: 15.0%
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 45.0%
INFO:__main__:ice share: 55.00000000000001%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 21.00%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 11.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.032
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.15
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp4gj58rv2.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp88oexd7a.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'rural biomass boiler', 'urban decentral air heat pump', 'rural gas boiler', 'urban decentral resistive heater', 'urban decentral water tanks discharger', 'rural ground heat pump', 'urban decentral biomass boiler', 'rural water tanks discharger', 'urban decentral gas boiler', 'rural air heat pump', 'rural resistive heater', 'rural water tanks charger'] not defined in config.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral air heat pump', 'rural water tanks discharger', 'urban decentral water tanks discharger', 'rural biomass boiler', 'rural gas boiler', 'rural water tanks charger', 'rural air heat pump', 'rural ground heat pump', 'rural resistive heater', 'urban decentral resistive heater', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2045.nc' contains: links, storage_units, carriers, loads, global_constraints, stores, generators, buses, lines
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: stores, lines, loads, buses, storage_units, carriers, generators, links, global_constraints
[Sat Sep 21 09:40:01 2024]
Finished job 91.
115 of 321 steps (36%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:01 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2085.csv, resources/costs_2085.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2085.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2085.csv, resources/district_heat_share_base_s_39_2085.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2085.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2085.log
    jobid: 259
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2085
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2085.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/industrial_production_base_s_39_2085.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/biomass_potentials_s_39_2085.csv, resources/transport_data_s_39.csv, resources/transport_demand_s_39.csv, resources/district_heat_share_base_s_39_2085.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/industrial_energy_demand_base_s_39_2085.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:40:02 2024]
Finished job 189.
116 of 321 steps (36%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:02 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2075.csv, resources/costs_2075.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2075.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/district_heat_share_base_s_39_2075.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2075.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2075.log
    jobid: 204
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2075.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2075.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2075.csv, resources/co2_totals.csv, resources/biomass_potentials_s_39_2075.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Adding electricity generation
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Adding fusion generation.
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Add hydrogen storage
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Add land transport
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add land transport
INFO:__main__:Add heat sector
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpm1_e_lt0.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpvjajawrh.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural biomass boiler', 'rural water tanks discharger', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'rural air heat pump', 'urban decentral water tanks charger', 'urban decentral resistive heater', 'rural water tanks charger', 'urban decentral water tanks discharger', 'rural gas boiler', 'urban decentral air heat pump', 'rural ground heat pump', 'rural resistive heater'] not defined in config.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural ground heat pump', 'rural water tanks charger', 'urban decentral water tanks charger', 'rural biomass boiler', 'rural water tanks discharger', 'rural air heat pump', 'urban decentral biomass boiler', 'urban decentral air heat pump', 'urban decentral gas boiler', 'urban decentral water tanks discharger', 'rural resistive heater', 'rural gas boiler', 'urban decentral resistive heater'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2085.nc' contains: global_constraints, generators, carriers, stores, loads, storage_units, buses, lines, links
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: storage_units, stores, generators, loads, carriers, global_constraints, buses, links, lines
[Sat Sep 21 09:40:12 2024]
Finished job 259.
117 of 321 steps (36%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:12 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2045.csv, resources/costs_2045.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2045.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2045.csv, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2045.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2045.log
    jobid: 244
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2045
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2045.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/biomass_potentials_s_39_2045.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2045.csv, resources/industrial_production_base_s_39_2045.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:40:13 2024]
Finished job 204.
118 of 321 steps (37%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:13 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2045.csv, resources/costs_2045.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2045.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2045.csv, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2045.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2045.log
    jobid: 296
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2045
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2045.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/biomass_potentials_s_39_2045.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2045.csv, resources/industrial_production_base_s_39_2045.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Adding electricity generation
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Adding electricity generation
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 85.0%
INFO:__main__:ice share: 15.0%
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 85.0%
INFO:__main__:ice share: 15.0%
INFO:__main__:Add heat sector
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 21.00%
INFO:__main__:Assumed space heat reduction of 21.00%
INFO:__main__:Add biomass
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.032
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.032
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpq7a0hafu.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmph86ipve4.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural water tanks discharger', 'urban decentral water tanks charger', 'rural water tanks charger', 'urban decentral gas boiler', 'urban decentral water tanks discharger', 'rural ground heat pump', 'rural biomass boiler', 'urban decentral resistive heater', 'rural gas boiler', 'rural resistive heater', 'urban decentral biomass boiler', 'urban decentral air heat pump', 'rural air heat pump'] not defined in config.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural air heat pump', 'urban decentral gas boiler', 'rural biomass boiler', 'rural ground heat pump', 'urban decentral water tanks discharger', 'rural water tanks charger', 'rural water tanks discharger', 'rural gas boiler', 'urban decentral resistive heater', 'urban decentral air heat pump', 'urban decentral water tanks charger', 'urban decentral biomass boiler', 'rural resistive heater'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2045.nc' contains: global_constraints, buses, carriers, links, lines, loads, storage_units, stores, generators
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2045.nc' contains: stores, global_constraints, loads, links, carriers, storage_units, lines, generators, buses
[Sat Sep 21 09:40:23 2024]
Finished job 296.
119 of 321 steps (37%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:24 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2100.csv, resources/costs_2100.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2100.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2100.log
    jobid: 213
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2100
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2100.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/pop_weighted_heat_totals_s_39.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2100.csv, resources/profile_39_offwind-dc.nc, resources/co2_totals.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:40:24 2024]
Finished job 244.
120 of 321 steps (37%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:24 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2055.csv, resources/costs_2055.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2055.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2055.csv, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2055.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2055.log
    jobid: 198
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2055.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2055.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2055.csv, resources/co2_totals.csv, resources/industrial_production_base_s_39_2055.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add land transport
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add land transport
INFO:__main__:Add heat sector
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
WARNING:_helpers:Investment key 2100 not found in dictionary {2020: 0.701, 2025: 0.524, 2030: 0.297, 2035: 0.15, 2040: 0.071, 2045: 0.032, 2050: 0.0, 2055: 0.0, 2060: 0.0, 2065: 0.0, 2070: 0.0, 2075: 0.0, 2080: 0.0, 2085: 0.0, 2090: 0.0, 2095: 0.0}.
WARNING:_helpers:Higher than maximum key. Taking maximum key 2020
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpej1otrym.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpdz6n5__y.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral gas boiler', 'urban decentral air heat pump', 'rural water tanks charger', 'rural biomass boiler', 'urban decentral biomass boiler', 'rural air heat pump', 'urban decentral water tanks discharger', 'rural resistive heater', 'rural ground heat pump', 'rural water tanks discharger', 'urban decentral water tanks charger', 'rural gas boiler', 'urban decentral resistive heater'] not defined in config.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural water tanks discharger', 'rural ground heat pump', 'rural resistive heater', 'urban decentral water tanks charger', 'rural water tanks charger', 'rural air heat pump', 'urban decentral water tanks discharger', 'rural gas boiler', 'urban decentral resistive heater', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'rural biomass boiler', 'urban decentral air heat pump'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2100.nc' contains: buses, generators, lines, storage_units, loads, carriers, global_constraints, stores, links
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: links, global_constraints, carriers, stores, buses, loads, generators, storage_units, lines
[Sat Sep 21 09:40:34 2024]
Finished job 213.
121 of 321 steps (38%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:34 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2065.csv, resources/costs_2065.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2065.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2065.csv, resources/district_heat_share_base_s_39_2065.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2065.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2065.log
    jobid: 305
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2065
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2065.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2065.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2065.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2065.csv, resources/co2_totals.csv, resources/district_heat_share_base_s_39_2065.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

[Sat Sep 21 09:40:35 2024]
Finished job 198.
122 of 321 steps (38%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:35 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2030.csv, resources/costs_2030.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2030.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2030.csv, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2030.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2030.log
    jobid: 290
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2030
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2030.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/industrial_production_base_s_39_2030.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2030.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/biomass_potentials_s_39_2030.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Add hydrogen storage
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 30.0%
INFO:__main__:ice share: 70.0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 9.00%
INFO:__main__:Add biomass
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpkge__qv3.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.297
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp1dl_nkya.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: links, buses, loads, generators, carriers, storage_units, lines, stores, global_constraints
[Sat Sep 21 09:40:44 2024]
Finished job 290.
123 of 321 steps (38%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:44 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2075.csv, resources/costs_2075.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2075.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/district_heat_share_base_s_39_2075.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2075.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2075.log
    jobid: 127
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2075.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2075.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2075.csv, resources/co2_totals.csv, resources/biomass_potentials_s_39_2075.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral resistive heater', 'urban decentral gas boiler', 'urban decentral water tanks discharger', 'urban decentral air heat pump', 'rural resistive heater', 'rural water tanks charger', 'rural water tanks discharger', 'rural ground heat pump', 'rural biomass boiler', 'urban decentral biomass boiler', 'rural gas boiler', 'rural air heat pump', 'urban decentral water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2065.nc' contains: buses, carriers, storage_units, generators, stores, loads, links, global_constraints, lines
[Sat Sep 21 09:40:45 2024]
Finished job 305.
124 of 321 steps (39%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:45 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2055.csv, resources/costs_2055.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2055.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2055.csv, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2055.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2055.log
    jobid: 250
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2055.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2055.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2055.csv, resources/co2_totals.csv, resources/industrial_production_base_s_39_2055.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add biomass
INFO:__main__:Add heat sector
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Assumed space heat reduction of 29.00%
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpmo0r825y.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpi6fheo15.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural water tanks charger', 'urban decentral gas boiler', 'urban decentral air heat pump', 'rural resistive heater', 'urban decentral water tanks discharger', 'urban decentral resistive heater', 'rural ground heat pump', 'rural air heat pump', 'rural biomass boiler', 'urban decentral water tanks charger', 'rural water tanks discharger', 'rural gas boiler', 'urban decentral biomass boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: global_constraints, generators, carriers, loads, links, buses, lines, storage_units, stores
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'rural air heat pump', 'urban decentral biomass boiler', 'rural resistive heater', 'urban decentral water tanks discharger', 'rural gas boiler', 'rural biomass boiler', 'rural water tanks charger', 'urban decentral air heat pump', 'urban decentral gas boiler', 'rural ground heat pump', 'urban decentral resistive heater', 'rural water tanks discharger'] not defined in config.
[Sat Sep 21 09:40:55 2024]
Finished job 127.
125 of 321 steps (39%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:55 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2030.csv, resources/costs_2030.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2030.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2030.csv, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2030.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2030.log
    jobid: 5
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2030.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/industrial_production_base_s_39_2030.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2030.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/biomass_potentials_s_39_2030.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: links, buses, generators, global_constraints, storage_units, carriers, loads, lines, stores
[Sat Sep 21 09:40:56 2024]
Finished job 250.
126 of 321 steps (39%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:40:56 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2100.csv, resources/costs_2100.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2100.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2100.log
    jobid: 265
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2100
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2100.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/pop_weighted_heat_totals_s_39.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2100.csv, resources/profile_39_offwind-dc.nc, resources/co2_totals.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 30.0%
INFO:__main__:ice share: 70.0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 9.00%
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Add biomass
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.297
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Add biomass
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpk5o8t9dl.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
INFO:__main__:Add methanol
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas'] not defined in config.
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: carriers, loads, storage_units, links, buses, generators, stores, global_constraints, lines
INFO:__main__:Add agriculture, forestry and fishing sector.
WARNING:_helpers:Investment key 2100 not found in dictionary {2020: 0.701, 2025: 0.524, 2030: 0.297, 2035: 0.15, 2040: 0.071, 2045: 0.032, 2050: 0.0, 2055: 0.0, 2060: 0.0, 2065: 0.0, 2070: 0.0, 2075: 0.0, 2080: 0.0, 2085: 0.0, 2090: 0.0, 2095: 0.0}.
WARNING:_helpers:Higher than maximum key. Taking maximum key 2020
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpox68gwxp.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:41:04 2024]
Finished job 5.
127 of 321 steps (40%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:04 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2050.csv, resources/costs_2050.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2050.csv, resources/district_heat_share_base_s_39_2050.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2050.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2050.log
    jobid: 195
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2050
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2050.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/biomass_potentials_s_39_2050.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2050.csv, resources/industrial_production_base_s_39_2050.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural ground heat pump', 'urban decentral water tanks discharger', 'rural water tanks discharger', 'urban decentral water tanks charger', 'urban decentral resistive heater', 'rural biomass boiler', 'rural air heat pump', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'rural gas boiler', 'urban decentral air heat pump', 'rural resistive heater', 'rural water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2100.nc' contains: generators, lines, buses, loads, global_constraints, carriers, storage_units, stores, links
[Sat Sep 21 09:41:07 2024]
Finished job 265.
128 of 321 steps (40%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:07 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2095.csv, resources/costs_2095.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2095.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2095.csv, resources/district_heat_share_base_s_39_2095.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2095.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2095.log
    jobid: 210
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2095.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2095.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/district_heat_share_base_s_39_2095.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/biomass_potentials_s_39_2095.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2095.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpqmsbawz9.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural resistive heater', 'rural water tanks discharger', 'urban decentral resistive heater', 'rural ground heat pump', 'rural water tanks charger', 'urban decentral gas boiler', 'rural biomass boiler', 'rural gas boiler', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'rural air heat pump', 'urban decentral water tanks charger', 'urban decentral water tanks discharger'] not defined in config.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2050.nc' contains: stores, links, storage_units, buses, loads, generators, lines, carriers, global_constraints
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp08lbd1mr.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:41:15 2024]
Finished job 195.
129 of 321 steps (40%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:15 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2085.csv, resources/costs_2085.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2085.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2085.csv, resources/district_heat_share_base_s_39_2085.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2085.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2085.log
    jobid: 136
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2085
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2085.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/industrial_production_base_s_39_2085.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/biomass_potentials_s_39_2085.csv, resources/transport_data_s_39.csv, resources/transport_demand_s_39.csv, resources/district_heat_share_base_s_39_2085.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/industrial_energy_demand_base_s_39_2085.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural resistive heater', 'urban decentral air heat pump', 'urban decentral gas boiler', 'urban decentral water tanks discharger', 'urban decentral biomass boiler', 'rural ground heat pump', 'rural biomass boiler', 'rural water tanks charger', 'rural gas boiler', 'rural water tanks discharger', 'urban decentral resistive heater', 'rural air heat pump', 'urban decentral water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: loads, carriers, lines, generators, global_constraints, links, storage_units, stores, buses
[Sat Sep 21 09:41:18 2024]
Finished job 210.
130 of 321 steps (40%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:18 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2055.csv, resources/costs_2055.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2055.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2055.csv, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2055.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2055.log
    jobid: 302
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2055
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2055.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2055.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2055.csv, resources/co2_totals.csv, resources/industrial_production_base_s_39_2055.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmphkb0o4sc.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Adding electricity generation
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral gas boiler', 'urban decentral resistive heater', 'urban decentral water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'rural biomass boiler', 'rural water tanks charger', 'urban decentral water tanks discharger', 'rural gas boiler', 'rural resistive heater', 'rural ground heat pump', 'urban decentral biomass boiler', 'rural air heat pump'] not defined in config.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2085.nc' contains: lines, generators, buses, storage_units, links, global_constraints, loads, carriers, stores
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpa2mkvuk8.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:41:26 2024]
Finished job 136.
131 of 321 steps (41%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:26 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2100.csv, resources/costs_2100.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2100.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2100.log
    jobid: 317
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2100
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2100.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/pop_weighted_heat_totals_s_39.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2100.csv, resources/profile_39_offwind-dc.nc, resources/co2_totals.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural gas boiler', 'rural water tanks discharger', 'rural air heat pump', 'urban decentral gas boiler', 'rural biomass boiler', 'rural ground heat pump', 'urban decentral air heat pump', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'urban decentral resistive heater', 'rural water tanks charger', 'urban decentral biomass boiler', 'rural resistive heater'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: stores, generators, links, storage_units, lines, buses, global_constraints, carriers, loads
[Sat Sep 21 09:41:29 2024]
Finished job 302.
132 of 321 steps (41%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:29 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2050.csv, resources/costs_2050.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2050.csv, resources/district_heat_share_base_s_39_2050.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2050.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2050.log
    jobid: 247
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2050
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2050.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/biomass_potentials_s_39_2050.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2050.csv, resources/industrial_production_base_s_39_2050.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
WARNING:_helpers:Investment key 2100 not found in dictionary {2020: 0.701, 2025: 0.524, 2030: 0.297, 2035: 0.15, 2040: 0.071, 2045: 0.032, 2050: 0.0, 2055: 0.0, 2060: 0.0, 2065: 0.0, 2070: 0.0, 2075: 0.0, 2080: 0.0, 2085: 0.0, 2090: 0.0, 2095: 0.0}.
WARNING:_helpers:Higher than maximum key. Taking maximum key 2020
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpfi98sa3c.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral biomass boiler', 'rural gas boiler', 'urban decentral water tanks charger', 'rural water tanks discharger', 'urban decentral water tanks discharger', 'rural biomass boiler', 'rural resistive heater', 'rural ground heat pump', 'rural water tanks charger', 'urban decentral resistive heater', 'rural air heat pump', 'urban decentral gas boiler', 'urban decentral air heat pump'] not defined in config.
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2100.nc' contains: carriers, loads, stores, lines, links, buses, global_constraints, generators, storage_units
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmppc40ngr_.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:41:37 2024]
Finished job 317.
133 of 321 steps (41%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:37 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2095.csv, resources/costs_2095.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2095.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2095.csv, resources/district_heat_share_base_s_39_2095.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2095.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2095.log
    jobid: 262
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2095.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2095.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/district_heat_share_base_s_39_2095.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/biomass_potentials_s_39_2095.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2095.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural resistive heater', 'urban decentral water tanks charger', 'rural water tanks charger', 'urban decentral biomass boiler', 'rural ground heat pump', 'urban decentral water tanks discharger', 'urban decentral gas boiler', 'rural biomass boiler', 'urban decentral air heat pump', 'urban decentral resistive heater', 'rural gas boiler', 'rural water tanks discharger', 'rural air heat pump'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2050.nc' contains: storage_units, buses, loads, generators, global_constraints, carriers, lines, links, stores
[Sat Sep 21 09:41:40 2024]
Finished job 247.
134 of 321 steps (42%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:40 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2045.csv, resources/costs_2045.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2045.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2045.csv, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2045.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2045.log
    jobid: 192
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2045
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2045.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2045.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/biomass_potentials_s_39_2045.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2045.csv, resources/industrial_production_base_s_39_2045.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2045
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Adding fusion generation.
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Add hydrogen storage
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp5k5nh8nz.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 85.0%
INFO:__main__:ice share: 15.0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 21.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural ground heat pump', 'urban decentral resistive heater', 'rural gas boiler', 'rural resistive heater', 'rural water tanks charger', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'urban decentral air heat pump', 'rural water tanks discharger', 'rural air heat pump', 'rural biomass boiler', 'urban decentral biomass boiler', 'urban decentral gas boiler'] not defined in config.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: loads, carriers, stores, global_constraints, buses, links, generators, lines, storage_units
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.032
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpqgfhoqas.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:41:48 2024]
Finished job 262.
135 of 321 steps (42%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:48 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2050.csv, resources/costs_2050.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2050.csv, resources/district_heat_share_base_s_39_2050.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2050.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2050.log
    jobid: 100
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2050
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2050.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/biomass_potentials_s_39_2050.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2050.csv, resources/industrial_production_base_s_39_2050.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'rural biomass boiler', 'rural water tanks charger', 'rural gas boiler', 'rural ground heat pump', 'rural water tanks discharger', 'urban decentral resistive heater', 'urban decentral gas boiler', 'urban decentral biomass boiler', 'rural air heat pump', 'rural resistive heater', 'urban decentral water tanks discharger', 'urban decentral air heat pump'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2045.nc' contains: storage_units, loads, carriers, stores, links, buses, lines, global_constraints, generators
[Sat Sep 21 09:41:51 2024]
Finished job 192.
136 of 321 steps (42%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:51 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2035.csv, resources/costs_2035.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/district_heat_share_base_s_39_2035.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2035.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2035.log
    jobid: 241
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2035.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/biomass_potentials_s_39_2035.csv, resources/profile_39_offwind-ac.nc, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2035.csv, resources/co2_totals.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp556eugx7.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 45.0%
INFO:__main__:ice share: 55.00000000000001%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 11.00%
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral water tanks discharger', 'rural ground heat pump', 'rural resistive heater', 'rural water tanks discharger', 'rural water tanks charger', 'urban decentral air heat pump', 'rural gas boiler', 'urban decentral water tanks charger', 'urban decentral resistive heater', 'rural biomass boiler', 'rural air heat pump'] not defined in config.
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2050.nc' contains: links, lines, generators, loads, stores, buses, carriers, global_constraints, storage_units
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.15
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp9an4mjsj.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:41:58 2024]
Finished job 100.
137 of 321 steps (43%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:41:58 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2065.csv, resources/costs_2065.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2065.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2065.csv, resources/district_heat_share_base_s_39_2065.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2065.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2065.log
    jobid: 118
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2065
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2065.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2065.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2065.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2065.csv, resources/co2_totals.csv, resources/district_heat_share_base_s_39_2065.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral biomass boiler', 'urban decentral air heat pump', 'urban decentral water tanks discharger', 'urban decentral resistive heater', 'rural water tanks charger', 'rural air heat pump', 'rural ground heat pump', 'rural resistive heater', 'urban decentral water tanks charger', 'rural biomass boiler', 'rural gas boiler', 'urban decentral gas boiler', 'rural water tanks discharger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: global_constraints, storage_units, links, stores, lines, carriers, buses, generators, loads
[Sat Sep 21 09:42:02 2024]
Finished job 241.
138 of 321 steps (43%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:02 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2065.csv, resources/costs_2065.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2065.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2065.csv, resources/district_heat_share_base_s_39_2065.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2065.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2065.log
    jobid: 253
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2065
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2065.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2065.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2065.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2065.csv, resources/co2_totals.csv, resources/district_heat_share_base_s_39_2065.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpbhggch82.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural biomass boiler', 'urban decentral gas boiler', 'rural ground heat pump', 'urban decentral biomass boiler', 'rural water tanks discharger', 'urban decentral water tanks discharger', 'rural water tanks charger', 'rural resistive heater', 'urban decentral resistive heater', 'rural air heat pump', 'rural gas boiler', 'urban decentral air heat pump', 'urban decentral water tanks charger'] not defined in config.
INFO:__main__:Add biomass
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2065.nc' contains: links, global_constraints, carriers, storage_units, buses, lines, generators, stores, loads
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp1e4wuuf8.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
[Sat Sep 21 09:42:09 2024]
Finished job 118.
139 of 321 steps (43%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:09 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2075.csv, resources/costs_2075.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2075.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/district_heat_share_base_s_39_2075.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2075.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2075.log
    jobid: 256
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2075.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2075.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2075.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2075.csv, resources/co2_totals.csv, resources/biomass_potentials_s_39_2075.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural biomass boiler', 'rural water tanks discharger', 'rural water tanks charger', 'rural resistive heater', 'rural gas boiler', 'rural air heat pump', 'urban decentral gas boiler', 'urban decentral water tanks discharger', 'urban decentral biomass boiler', 'rural ground heat pump', 'urban decentral air heat pump', 'urban decentral water tanks charger', 'urban decentral resistive heater'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2065.nc' contains: lines, buses, storage_units, global_constraints, loads, generators, stores, carriers, links
[Sat Sep 21 09:42:12 2024]
Finished job 253.
140 of 321 steps (44%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:13 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2030.csv, resources/costs_2030.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2030.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2030.csv, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2030.nc
    log: results/fusion-base-2055/logs/prepare_sector_network_base_s_39_lvopt___2030.log
    jobid: 238
    benchmark: results/fusion-base-2055/benchmarks/prepare_sector_network/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2030.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/industrial_production_base_s_39_2030.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2030.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/biomass_potentials_s_39_2030.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpownbzvhi.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 30.0%
INFO:__main__:ice share: 70.0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 9.00%
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks discharger', 'rural air heat pump', 'rural resistive heater', 'rural ground heat pump', 'urban decentral resistive heater', 'urban decentral gas boiler', 'rural gas boiler', 'urban decentral water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'rural water tanks charger', 'urban decentral biomass boiler', 'rural biomass boiler'] not defined in config.
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: links, lines, buses, storage_units, stores, carriers, loads, global_constraints, generators
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.297
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpa1t91k0h.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas'] not defined in config.
[Sat Sep 21 09:42:20 2024]
Finished job 256.
141 of 321 steps (44%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:20 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2095.csv, resources/costs_2095.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2095.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2095.csv, resources/district_heat_share_base_s_39_2095.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2095.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2095.log
    jobid: 314
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2095
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2095.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2095.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/district_heat_share_base_s_39_2095.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/biomass_potentials_s_39_2095.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2095.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: stores, links, carriers, buses, loads, generators, global_constraints, storage_units, lines
[Sat Sep 21 09:42:22 2024]
Finished job 238.
142 of 321 steps (44%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:22 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2085.csv, resources/costs_2085.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2085.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2085.csv, resources/district_heat_share_base_s_39_2085.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2085.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2085.log
    jobid: 207
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2085
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2085.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/industrial_production_base_s_39_2085.csv, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/biomass_potentials_s_39_2085.csv, resources/transport_data_s_39.csv, resources/transport_demand_s_39.csv, resources/district_heat_share_base_s_39_2085.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/industrial_energy_demand_base_s_39_2085.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2085
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpnzbfesgw.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural ground heat pump', 'urban decentral resistive heater', 'rural resistive heater', 'rural water tanks discharger', 'rural gas boiler', 'rural water tanks charger', 'urban decentral biomass boiler', 'urban decentral water tanks charger', 'urban decentral air heat pump', 'urban decentral water tanks discharger', 'rural air heat pump', 'urban decentral gas boiler', 'rural biomass boiler'] not defined in config.
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpr0ue6ayd.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: stores, buses, lines, links, loads, generators, global_constraints, carriers, storage_units
[Sat Sep 21 09:42:31 2024]
Finished job 314.
143 of 321 steps (45%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:31 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2035.csv, resources/costs_2035.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/district_heat_share_base_s_39_2035.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2035.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2035.log
    jobid: 82
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2035.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/biomass_potentials_s_39_2035.csv, resources/profile_39_offwind-ac.nc, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2035.csv, resources/co2_totals.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral gas boiler', 'rural biomass boiler', 'urban decentral resistive heater', 'rural air heat pump', 'urban decentral biomass boiler', 'rural water tanks discharger', 'rural water tanks charger', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'rural ground heat pump', 'rural resistive heater', 'rural gas boiler', 'urban decentral air heat pump'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2085.nc' contains: generators, links, storage_units, stores, lines, global_constraints, buses, carriers, loads
[Sat Sep 21 09:42:33 2024]
Finished job 207.
144 of 321 steps (45%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:33 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2050.csv, resources/costs_2050.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2050.csv, resources/district_heat_share_base_s_39_2050.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2050.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2050.log
    jobid: 299
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2050
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2050.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_energy_demand_base_s_39_2050.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/biomass_potentials_s_39_2050.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2050.csv, resources/industrial_production_base_s_39_2050.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2050
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 45.0%
INFO:__main__:ice share: 55.00000000000001%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 11.00%
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Add biomass
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:__main__:Add methanol
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Add industrial demand
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add land transport
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.15
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpb_s0k70g.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp3t24r_4k.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks discharger', 'rural resistive heater', 'rural ground heat pump', 'urban decentral air heat pump', 'rural water tanks charger', 'rural biomass boiler', 'urban decentral resistive heater', 'rural gas boiler', 'urban decentral biomass boiler', 'urban decentral water tanks charger', 'urban decentral gas boiler', 'rural water tanks discharger', 'rural air heat pump'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: lines, global_constraints, links, buses, generators, stores, storage_units, carriers, loads
[Sat Sep 21 09:42:42 2024]
Finished job 82.
145 of 321 steps (45%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:42 2024]
localrule add_existing_baseyear:
    input: results/reference/prenetworks/base_s_39_lvopt___2030.nc, resources/powerplants_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/costs_2030.csv, resources/cop_profiles_base_s_39.nc, resources/existing_heating_distribution_base_s_39_2030.csv, resources/heating_efficiencies.csv
    output: results/reference/prenetworks-brownfield/base_s_39_lvopt___2030.nc
    log: results/reference/logs/add_existing_baseyear_base_s_39_lvopt___2030.log
    jobid: 289
    benchmark: results/reference/benchmarks/add_existing_baseyear/base_s_39_lvopt___2030
    reason: Missing output files: results/reference/prenetworks-brownfield/base_s_39_lvopt___2030.nc; Input files updated by another job: resources/existing_heating_distribution_base_s_39_2030.csv, resources/powerplants_s_39.csv, resources/busmap_base_s_39.csv, resources/heating_efficiencies.csv, resources/cop_profiles_base_s_39.nc, results/reference/prenetworks/base_s_39_lvopt___2030.nc, resources/busmap_base_s.csv, resources/pop_layout_base_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral air heat pump', 'urban decentral water tanks discharger', 'rural water tanks discharger', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral resistive heater', 'rural biomass boiler', 'rural air heat pump', 'rural water tanks charger', 'rural gas boiler', 'urban decentral water tanks charger', 'rural ground heat pump', 'rural resistive heater'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2050.nc' contains: lines, generators, carriers, buses, global_constraints, links, storage_units, loads, stores
[Sat Sep 21 09:42:44 2024]
Finished job 299.
146 of 321 steps (45%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:44 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2095.csv, resources/costs_2095.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2095.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2095.csv, resources/district_heat_share_base_s_39_2095.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2095.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2095.log
    jobid: 145
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2095.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2095.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/district_heat_share_base_s_39_2095.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/biomass_potentials_s_39_2095.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/industrial_energy_demand_base_s_39_2095.csv, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_lvopt___2030.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:powerplantmatching.core:Retrieving data from https://zenodo.org/records/10952917/files/IRENASTAT_capacities_2000-2023.csv
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpy8voly69.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'rural biomass boiler', 'rural air heat pump', 'rural water tanks charger', 'rural gas boiler', 'urban decentral gas boiler', 'rural ground heat pump', 'rural resistive heater', 'urban decentral resistive heater', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'urban decentral water tanks discharger', 'rural water tanks discharger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: storage_units, lines, generators, global_constraints, carriers, links, stores, loads, buses
[Sat Sep 21 09:42:54 2024]
Finished job 145.
147 of 321 steps (46%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:42:54 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2035.csv, resources/costs_2035.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/district_heat_share_base_s_39_2035.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/reference/prenetworks/base_s_39_lvopt___2035.nc
    log: results/reference/logs/prepare_sector_network_base_s_39_lvopt___2035.log
    jobid: 293
    benchmark: results/reference/benchmarks/prepare_sector_network/base_s_39_lvopt___2035
    reason: Missing output files: results/reference/prenetworks/base_s_39_lvopt___2035.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_production_base_s_39_2035.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/biomass_potentials_s_39_2035.csv, resources/profile_39_offwind-ac.nc, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/district_heat_share_base_s_39_2035.csv, resources/co2_totals.csv, resources/industrial_energy_demand_base_s_39_2035.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=reference, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 45.0%
INFO:__main__:ice share: 55.00000000000001%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 11.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.15
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpm6tzrmel.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
WARNING:__main__:There are 1 assets with build year after last power grouping year 2025. These assets are dropped and not considered.Consider to redefine the grouping years to keep them.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks discharger', 'rural air heat pump', 'rural resistive heater', 'urban decentral resistive heater', 'urban decentral air heat pump', 'rural gas boiler', 'urban decentral gas boiler', 'rural water tanks discharger', 'rural water tanks charger', 'rural ground heat pump', 'urban decentral water tanks charger', 'urban decentral biomass boiler', 'rural biomass boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: storage_units, links, loads, lines, generators, global_constraints, buses, stores, carriers
INFO:prepare_sector_network:Cluster residential and service heat buses.
[Sat Sep 21 09:43:05 2024]
Finished job 293.
148 of 321 steps (46%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:43:05 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2055.csv, resources/costs_2055.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2055.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2055.csv, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2055.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2055.log
    jobid: 109
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2055.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2055.csv, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/industrial_energy_demand_base_s_39_2055.csv, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2055.csv, resources/co2_totals.csv, resources/industrial_production_base_s_39_2055.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas', 'rural air heat pump', 'rural biomass boiler', 'rural gas boiler', 'rural ground heat pump', 'rural resistive heater', 'rural solar thermal', 'rural water tanks', 'rural water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral heat', 'urban decentral resistive heater', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'urban decentral oil boiler', 'rural oil boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: global_constraints, generators, lines, storage_units, buses, links, loads, carriers, stores
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
[Sat Sep 21 09:43:08 2024]
Finished job 289.
149 of 321 steps (46%) done
Select jobs to execute...
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
Execute 1 jobs...

[Sat Sep 21 09:43:08 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2065.csv, resources/costs_2065.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2065.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2065.csv, resources/district_heat_share_base_s_39_2065.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2065.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2065.log
    jobid: 201
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2065
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2065.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/heating_efficiencies.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/industrial_production_base_s_39_2065.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2065.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2065.csv, resources/co2_totals.csv, resources/district_heat_share_base_s_39_2065.csv, resources/profile_39_offwind-dc.nc, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2065
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpspy376u5.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural resistive heater', 'urban decentral water tanks discharger', 'urban decentral air heat pump', 'rural water tanks discharger', 'rural water tanks charger', 'rural ground heat pump', 'rural gas boiler', 'rural air heat pump', 'urban decentral biomass boiler', 'urban decentral water tanks charger', 'urban decentral resistive heater', 'rural biomass boiler', 'urban decentral gas boiler'] not defined in config.
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: lines, loads, carriers, stores, buses, links, global_constraints, generators, storage_units
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
[Sat Sep 21 09:43:15 2024]
Finished job 109.
150 of 321 steps (47%) done
Select jobs to execute...
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
Execute 1 jobs...

[Sat Sep 21 09:43:15 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2030.csv, resources/costs_2030.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2030.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2030.csv, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2030.nc
    log: results/fusion-base-2045/logs/prepare_sector_network_base_s_39_lvopt___2030.log
    jobid: 186
    benchmark: results/fusion-base-2045/benchmarks/prepare_sector_network/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2030.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/district_heat_share_base_s_39_2030.csv, resources/heating_efficiencies.csv, resources/industrial_production_base_s_39_2030.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/industrial_energy_demand_base_s_39_2030.csv, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/co2_totals.csv, resources/profile_39_offwind-dc.nc, resources/biomass_potentials_s_39_2030.csv, resources/pop_weighted_heat_totals_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpq8k86jcy.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral gas boiler', 'rural air heat pump', 'rural gas boiler', 'urban decentral water tanks discharger', 'rural resistive heater', 'urban decentral water tanks charger', 'rural ground heat pump', 'urban decentral air heat pump', 'urban decentral resistive heater', 'rural biomass boiler', 'rural water tanks discharger', 'urban decentral biomass boiler', 'rural water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2065.nc' contains: global_constraints, links, carriers, storage_units, loads, lines, generators, stores, buses
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
[Sat Sep 21 09:43:19 2024]
Finished job 201.
151 of 321 steps (47%) done
Select jobs to execute...
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
Execute 1 jobs...

[Sat Sep 21 09:43:19 2024]
localrule add_existing_baseyear:
    input: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2030.nc, resources/powerplants_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/costs_2030.csv, resources/cop_profiles_base_s_39.nc, resources/existing_heating_distribution_base_s_39_2030.csv, resources/heating_efficiencies.csv
    output: results/fusion-base-2035/prenetworks-brownfield/base_s_39_lvopt___2030.nc
    log: results/fusion-base-2035/logs/add_existing_baseyear_base_s_39_lvopt___2030.log
    jobid: 4
    benchmark: results/fusion-base-2035/benchmarks/add_existing_baseyear/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2035/prenetworks-brownfield/base_s_39_lvopt___2030.nc; Input files updated by another job: resources/existing_heating_distribution_base_s_39_2030.csv, resources/powerplants_s_39.csv, resources/busmap_base_s_39.csv, resources/heating_efficiencies.csv, resources/cop_profiles_base_s_39.nc, resources/pop_layout_base_s_39.csv, results/fusion-base-2035/prenetworks/base_s_39_lvopt___2030.nc, resources/busmap_base_s.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 30.0%
INFO:__main__:ice share: 70.0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 9.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.297
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmpyzhx_q9p.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: generators, buses, lines, storage_units, links, stores, carriers, global_constraints, loads
INFO:pypsa.io:Imported network base_s_39_lvopt___2030.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
[Sat Sep 21 09:43:24 2024]
Finished job 186.
152 of 321 steps (47%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:43:24 2024]
localrule add_existing_baseyear:
    input: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2030.nc, resources/powerplants_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/costs_2030.csv, resources/cop_profiles_base_s_39.nc, resources/existing_heating_distribution_base_s_39_2030.csv, resources/heating_efficiencies.csv
    output: results/fusion-base-2045/prenetworks-brownfield/base_s_39_lvopt___2030.nc
    log: results/fusion-base-2045/logs/add_existing_baseyear_base_s_39_lvopt___2030.log
    jobid: 185
    benchmark: results/fusion-base-2045/benchmarks/add_existing_baseyear/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2045/prenetworks-brownfield/base_s_39_lvopt___2030.nc; Input files updated by another job: results/fusion-base-2045/prenetworks/base_s_39_lvopt___2030.nc, resources/existing_heating_distribution_base_s_39_2030.csv, resources/powerplants_s_39.csv, resources/busmap_base_s_39.csv, resources/heating_efficiencies.csv, resources/cop_profiles_base_s_39.nc, resources/busmap_base_s.csv, resources/pop_layout_base_s_39.csv
    wildcards: run=fusion-base-2045, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_lvopt___2030.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
WARNING:__main__:There are 1 assets with build year after last power grouping year 2025. These assets are dropped and not considered.Consider to redefine the grouping years to keep them.
INFO:prepare_sector_network:Cluster residential and service heat buses.
WARNING:__main__:There are 1 assets with build year after last power grouping year 2025. These assets are dropped and not considered.Consider to redefine the grouping years to keep them.
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas', 'rural air heat pump', 'rural biomass boiler', 'rural gas boiler', 'rural ground heat pump', 'rural resistive heater', 'rural solar thermal', 'rural water tanks', 'rural water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral heat', 'urban decentral resistive heater', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'urban decentral oil boiler', 'rural oil boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: lines, carriers, generators, links, loads, buses, stores, global_constraints, storage_units
[Sat Sep 21 09:43:45 2024]
Finished job 4.
153 of 321 steps (48%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:43:45 2024]
localrule add_existing_baseyear:
    input: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2030.nc, resources/powerplants_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/costs_2030.csv, resources/cop_profiles_base_s_39.nc, resources/existing_heating_distribution_base_s_39_2030.csv, resources/heating_efficiencies.csv
    output: results/fusion-base-2055/prenetworks-brownfield/base_s_39_lvopt___2030.nc
    log: results/fusion-base-2055/logs/add_existing_baseyear_base_s_39_lvopt___2030.log
    jobid: 237
    benchmark: results/fusion-base-2055/benchmarks/add_existing_baseyear/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2055/prenetworks-brownfield/base_s_39_lvopt___2030.nc; Input files updated by another job: results/fusion-base-2055/prenetworks/base_s_39_lvopt___2030.nc, resources/existing_heating_distribution_base_s_39_2030.csv, resources/powerplants_s_39.csv, resources/busmap_base_s_39.csv, resources/heating_efficiencies.csv, resources/cop_profiles_base_s_39.nc, resources/busmap_base_s.csv, resources/pop_layout_base_s_39.csv
    wildcards: run=fusion-base-2055, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:prepare_sector_network:Cluster residential and service heat buses.
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas', 'rural air heat pump', 'rural biomass boiler', 'rural gas boiler', 'rural ground heat pump', 'rural resistive heater', 'rural solar thermal', 'rural water tanks', 'rural water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral heat', 'urban decentral resistive heater', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'rural oil boiler', 'urban decentral oil boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: lines, global_constraints, storage_units, generators, loads, links, stores, carriers, buses
INFO:pypsa.io:Imported network base_s_39_lvopt___2030.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
[Sat Sep 21 09:43:50 2024]
Finished job 185.
154 of 321 steps (48%) done
Select jobs to execute...
Execute 1 jobs...

[Sat Sep 21 09:43:50 2024]
localrule prepare_sector_network:
    input: resources/profile_39_offwind-ac.nc, resources/profile_39_offwind-dc.nc, resources/profile_39_offwind-float.nc, resources/gas_network_base_s_39.csv, resources/gas_input_locations_s_39.geojson, resources/gas_input_locations_s_39_simplified.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/pop_weighted_energy_totals_s_39.csv, resources/pop_weighted_heat_totals_s_39.csv, resources/shipping_demand_s_39.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/avail_profile_s_39.csv, resources/dsm_profile_s_39.csv, resources/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/biomass_potentials_s_39_2100.csv, resources/costs_2100.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/busmap_base_s_39.csv, resources/pop_layout_base_s_39.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/temp_soil_total_base_s_39.nc, resources/temp_air_total_base_s_39.nc, resources/cop_profiles_base_s_39.nc, resources/solar_thermal_total_base_s_39.nc
    output: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2100.nc
    log: results/fusion-base-2035/logs/prepare_sector_network_base_s_39_lvopt___2100.log
    jobid: 154
    benchmark: results/fusion-base-2035/benchmarks/prepare_sector_network/base_s_39_lvopt___2100
    reason: Missing output files: results/fusion-base-2035/prenetworks/base_s_39_lvopt___2100.nc; Input files updated by another job: resources/pop_weighted_energy_totals_s_39.csv, resources/temp_soil_total_base_s_39.nc, resources/pop_weighted_heat_totals_s_39.csv, resources/district_heat_share_base_s_39_2100.csv, resources/heating_efficiencies.csv, resources/industrial_energy_demand_base_s_39_2100.csv, resources/gas_input_locations_s_39.geojson, resources/avail_profile_s_39.csv, resources/salt_cavern_potentials_s_39.csv, resources/busmap_base_s.csv, resources/transport_demand_s_39.csv, resources/transport_data_s_39.csv, resources/cop_profiles_base_s_39.nc, resources/profile_39_offwind-float.nc, resources/solar_thermal_total_base_s_39.nc, resources/busmap_base_s_39.csv, resources/gas_network_base_s_39.csv, resources/shipping_demand_s_39.csv, resources/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/profile_39_offwind-ac.nc, resources/dsm_profile_s_39.csv, resources/hourly_heat_demand_total_base_s_39.nc, resources/industrial_production_base_s_39_2100.csv, resources/gas_input_locations_s_39_simplified.csv, resources/temp_air_total_base_s_39.nc, resources/pop_layout_base_s_39.csv, resources/networks/base_s_39_elec_lvopt_.nc, resources/biomass_potentials_s_39_2100.csv, resources/profile_39_offwind-dc.nc, resources/co2_totals.csv
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2100
    resources: tmpdir=/tmp/go73lez2, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding fusion generation.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
WARNING:_helpers:Investment key 2100 not found in dictionary {2020: 0.701, 2025: 0.524, 2030: 0.297, 2035: 0.15, 2040: 0.071, 2045: 0.032, 2050: 0.0, 2055: 0.0, 2060: 0.0, 2065: 0.0, 2070: 0.0, 2075: 0.0, 2080: 0.0, 2085: 0.0, 2090: 0.0, 2095: 0.0}.
WARNING:_helpers:Higher than maximum key. Taking maximum key 2020
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/scripts/tmp5tu_mk11.prepare_sector_network.py:4344: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral gas boiler', 'rural biomass boiler', 'urban decentral air heat pump', 'urban decentral resistive heater', 'rural air heat pump', 'rural resistive heater', 'rural gas boiler', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'rural water tanks discharger', 'rural ground heat pump', 'urban decentral biomass boiler', 'rural water tanks charger'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2100.nc' contains: generators, links, loads, buses, carriers, global_constraints, stores, lines, storage_units
[Sat Sep 21 09:44:00 2024]
Finished job 154.
155 of 321 steps (48%) done
Select jobs to execute...
Waiting for more resources.
WARNING:__main__:There are 1 assets with build year after last power grouping year 2025. These assets are dropped and not considered.Consider to redefine the grouping years to keep them.
INFO:prepare_sector_network:Cluster residential and service heat buses.
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'unsustainable biogas', 'rural air heat pump', 'rural biomass boiler', 'rural gas boiler', 'rural ground heat pump', 'rural resistive heater', 'rural solar thermal', 'rural water tanks', 'rural water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral heat', 'urban decentral resistive heater', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'urban decentral oil boiler', 'rural oil boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2030.nc' contains: links, buses, carriers, generators, stores, loads, lines, global_constraints, storage_units
[Sat Sep 21 09:44:07 2024]
Finished job 237.
156 of 321 steps (49%) done
Execute 1 jobs...

[Sat Sep 21 09:44:07 2024]
localrule solve_sector_network_myopic:
    input: results/fusion-base-2035/prenetworks-brownfield/base_s_39_lvopt___2030.nc, resources/costs_2030.csv
    output: results/fusion-base-2035/postnetworks/base_s_39_lvopt___2030.nc, results/fusion-base-2035/configs/config.base_s_39_lvopt___2030.yaml
    log: results/fusion-base-2035/logs/base_s_39_lvopt___2030_solver.log, results/fusion-base-2035/logs/base_s_39_lvopt___2030_memory.log, results/fusion-base-2035/logs/base_s_39_lvopt___2030_python.log
    jobid: 3
    benchmark: results/fusion-base-2035/benchmarks/solve_sector_network/base_s_39_lvopt___2030
    reason: Missing output files: results/fusion-base-2035/postnetworks/base_s_39_lvopt___2030.nc; Input files updated by another job: results/fusion-base-2035/prenetworks-brownfield/base_s_39_lvopt___2030.nc
    wildcards: run=fusion-base-2035, clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2030
    threads: 2
    resources: tmpdir=/tmp/go73lez2, mem_mb=30000, mem_mib=28611, runtime=360

host: teramem2
/dss/dsshome1/01/go73lez2/pypsa-eur-current/.snakemake/shadow/tmpnm9dbrc9/.snakemake/scripts/tmpgzta3f6_.solve_network.py:568: SyntaxWarning: invalid escape sequence '\.'
  float_regex = "[0-9]*\.?[0-9]+"
INFO:pypsa.io:Imported network base_s_39_lvopt___2030.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
WARNING:__main__:Existing capacities larger than technical potential for Index(['BE0 0 offwind-ac-2030', 'DE0 0 offwind-ac-2030',
       'GB4 0 offwind-ac-2030', 'NL0 0 offwind-ac-2030', 'ES2 0 solar-2030',
       'FR6 0 solar-2030', 'ES2 0 onwind-2030'],
      dtype='object', name='Generator'),                        adjust technical potential to existing capacities
/dss/dsshome1/01/go73lez2/miniforge3/envs/pypsa-eur/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=1406) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['x', 'y'] of component 'Bus'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency3', 'efficiency4', 'efficiency2'] of component 'Link'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['x', 'y'] of component 'Bus'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency3', 'efficiency4', 'efficiency2'] of component 'Link'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
INFO:__main__:Adding solar potential constraint.
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.model:Solver logs written to `results/fusion-base-2035/logs/base_s_39_lvopt___2030_solver.log`.
INFO:linopy.model:Solver options:
 - threads: 8
 - method: 2
 - crossover: 0
 - BarConvTol: 1e-06
 - Seed: 123
 - AggFill: 0
 - PreDual: 0
 - GURO_PAR_BARDENSETHRESH: 200
INFO:linopy.io:Writing objective.
Writing constraints.:   0%|[38;2;128;191;255m          [0m| 0/45 [00:00<?, ?it/s]Writing constraints.:  20%|[38;2;128;191;255m██        [0m| 9/45 [00:02<00:08,  4.10it/s]Writing constraints.:  22%|[38;2;128;191;255m██▏       [0m| 10/45 [00:04<00:18,  1.93it/s]Writing constraints.:  24%|[38;2;128;191;255m██▍       [0m| 11/45 [00:06<00:26,  1.28it/s]Writing constraints.:  27%|[38;2;128;191;255m██▋       [0m| 12/45 [00:09<00:40,  1.24s/it]Writing constraints.:  29%|[38;2;128;191;255m██▉       [0m| 13/45 [00:10<00:38,  1.20s/it]Writing constraints.:  31%|[38;2;128;191;255m███       [0m| 14/45 [00:11<00:35,  1.15s/it]Writing constraints.:  33%|[38;2;128;191;255m███▎      [0m| 15/45 [00:16<01:00,  2.00s/it]Writing constraints.:  36%|[38;2;128;191;255m███▌      [0m| 16/45 [00:21<01:19,  2.74s/it]Writing constraints.:  38%|[38;2;128;191;255m███▊      [0m| 17/45 [00:33<02:30,  5.39s/it]Writing constraints.:  40%|[38;2;128;191;255m████      [0m| 18/45 [00:53<04:13,  9.38s/it]Writing constraints.:  42%|[38;2;128;191;255m████▏     [0m| 19/45 [00:53<02:56,  6.80s/it]Writing constraints.:  44%|[38;2;128;191;255m████▍     [0m| 20/45 [00:53<02:02,  4.90s/it]Writing constraints.:  47%|[38;2;128;191;255m████▋     [0m| 21/45 [00:55<01:33,  3.91s/it]Writing constraints.:  49%|[38;2;128;191;255m████▉     [0m| 22/45 [00:57<01:19,  3.47s/it]Writing constraints.:  51%|[38;2;128;191;255m█████     [0m| 23/45 [00:58<00:55,  2.54s/it]Writing constraints.:  53%|[38;2;128;191;255m█████▎    [0m| 24/45 [00:58<00:39,  1.88s/it]Writing constraints.:  56%|[38;2;128;191;255m█████▌    [0m| 25/45 [00:58<00:28,  1.41s/it]Writing constraints.:  58%|[38;2;128;191;255m█████▊    [0m| 26/45 [00:59<00:20,  1.09s/it]Writing constraints.:  60%|[38;2;128;191;255m██████    [0m| 27/45 [00:59<00:15,  1.17it/s]Writing constraints.:  62%|[38;2;128;191;255m██████▏   [0m| 28/45 [00:59<00:11,  1.44it/s]Writing constraints.:  64%|[38;2;128;191;255m██████▍   [0m| 29/45 [01:14<01:19,  4.99s/it]Writing constraints.:  67%|[38;2;128;191;255m██████▋   [0m| 30/45 [01:44<03:04, 12.28s/it]Writing constraints.:  69%|[38;2;128;191;255m██████▉   [0m| 31/45 [01:44<02:02,  8.77s/it]Writing constraints.:  71%|[38;2;128;191;255m███████   [0m| 32/45 [01:45<01:23,  6.42s/it]Writing constraints.:  73%|[38;2;128;191;255m███████▎  [0m| 33/45 [01:49<01:08,  5.72s/it]Writing constraints.:  76%|[38;2;128;191;255m███████▌  [0m| 34/45 [01:50<00:45,  4.14s/it]Writing constraints.:  78%|[38;2;128;191;255m███████▊  [0m| 35/45 [01:50<00:31,  3.13s/it]Writing constraints.:  80%|[38;2;128;191;255m████████  [0m| 36/45 [01:51<00:21,  2.42s/it]Writing constraints.:  82%|[38;2;128;191;255m████████▏ [0m| 37/45 [01:52<00:15,  1.92s/it]Writing constraints.:  84%|[38;2;128;191;255m████████▍ [0m| 38/45 [01:53<00:11,  1.57s/it]Writing constraints.: 100%|[38;2;128;191;255m██████████[0m| 45/45 [01:53<00:00,  2.51s/it]
Writing continuous variables.:   0%|[38;2;128;191;255m          [0m| 0/15 [00:00<?, ?it/s]Writing continuous variables.:  33%|[38;2;128;191;255m███▎      [0m| 5/15 [00:02<00:05,  1.99it/s]Writing continuous variables.:  40%|[38;2;128;191;255m████      [0m| 6/15 [00:02<00:04,  2.24it/s]Writing continuous variables.:  47%|[38;2;128;191;255m████▋     [0m| 7/15 [00:11<00:19,  2.40s/it]Writing continuous variables.:  53%|[38;2;128;191;255m█████▎    [0m| 8/15 [00:12<00:14,  2.04s/it]Writing continuous variables.:  60%|[38;2;128;191;255m██████    [0m| 9/15 [00:12<00:09,  1.55s/it]Writing continuous variables.:  67%|[38;2;128;191;255m██████▋   [0m| 10/15 [00:12<00:05,  1.17s/it]Writing continuous variables.:  73%|[38;2;128;191;255m███████▎  [0m| 11/15 [00:12<00:03,  1.12it/s]Writing continuous variables.:  80%|[38;2;128;191;255m████████  [0m| 12/15 [00:13<00:02,  1.49it/s]Writing continuous variables.:  87%|[38;2;128;191;255m████████▋ [0m| 13/15 [00:13<00:01,  1.31it/s]Writing continuous variables.:  93%|[38;2;128;191;255m█████████▎[0m| 14/15 [00:14<00:00,  1.63it/s]Writing continuous variables.: 100%|[38;2;128;191;255m██████████[0m| 15/15 [00:14<00:00,  1.05it/s]
INFO:linopy.io: Writing time: 138.83s
