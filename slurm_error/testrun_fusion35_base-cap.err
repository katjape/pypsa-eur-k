
EnvironmentNameNotFound: Could not find conda environment: snakemake
You can list all discoverable environments with `conda info --envs`.


Building DAG of jobs...
Unlocked working directory.
Config file /dss/dssfs02/lwp-dss-0001/pn39ci/pn39ci-dss-0000/MA_Git/config/config.default.yaml is extended by additional config specified via the command line.
Config file /dss/dssfs02/lwp-dss-0001/pn39ci/pn39ci-dss-0000/MA_Git/config/config.fusion35-base-cap.yaml is extended by additional config specified via the command line.
Assuming unrestricted shared filesystem usage.
host: teramem2
Building DAG of jobs...
Retrieving .snakemake/storage/http/zenodo.org/records/10820928/files/demand_hourly.csv from storage.
Retrieving .snakemake/storage/http/zenodo.org/records/10356004/files/ENSPRESO_BIOMASS.xlsx from storage.
Retrieving from storage: https://zenodo.org/records/10820928/files/demand_hourly.csv
Finished retrieval.
Retrieving from storage: https://zenodo.org/records/10356004/files/ENSPRESO_BIOMASS.xlsx
Finished retrieval.
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job                                                 count
------------------------------------------------  -------
add_brownfield                                          3
add_electricity                                         1
add_existing_baseyear                                   1
add_transmission_projects_and_dlr                       1
all                                                     1
base_network                                            1
build_ammonia_production                                1
build_biomass_potentials                                4
build_central_heating_temperature_profiles              1
build_clustered_population_layouts                      1
build_cop_profiles                                      1
build_daily_heat_demand                                 1
build_district_heat_share                               4
build_electricity_demand                                1
build_electricity_demand_base                           1
build_energy_totals                                     1
build_existing_heating_distribution                     1
build_gas_input_locations                               1
build_gas_network                                       1
build_heat_totals                                       1
build_hourly_heat_demand                                1
build_hydro_profile                                     1
build_industrial_distribution_key                       1
build_industrial_energy_demand_per_country_today        1
build_industrial_energy_demand_per_node                 4
build_industrial_energy_demand_per_node_today           1
build_industrial_production_per_country                 1
build_industrial_production_per_country_tomorrow        4
build_industrial_production_per_node                    4
build_industry_sector_ratios                            1
build_industry_sector_ratios_intermediate               4
build_population_layouts                                1
build_population_weighted_energy_totals                 2
build_powerplants                                       1
build_renewable_profiles                                6
build_salt_cavern_potentials                            1
build_shapes                                            1
build_ship_raster                                       1
build_shipping_demand                                   1
build_solar_thermal_profiles                            1
build_temperature_profiles                              1
build_transmission_projects                             1
build_transport_demand                                  1
cluster_gas_network                                     1
cluster_network                                         1
determine_availability_matrix                           6
make_summary                                            1
plot_hydrogen_network                                   4
plot_power_network                                      4
plot_power_network_clustered                            1
plot_summary                                            1
prepare_network                                         1
prepare_sector_network                                  4
retrieve_jrc_enspreso_biomass                           1
retrieve_synthetic_electricity_demand                   1
simplify_network                                        1
solve_sector_network_myopic                             4
time_aggregation                                        1
total                                                 101

Select jobs to execute...
Execute 2 jobs...

[Mon Sep 30 16:40:10 2024]
localrule build_ship_raster:
    input: data/shipdensity_global.zip, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/shipdensity_raster.tif
    log: logs/fusion35-base-cap/build_ship_raster.log
    jobid: 9
    benchmark: benchmarks/fusion35-base-cap/build_ship_raster
    reason: Missing output files: resources/fusion35-base-cap/shipdensity_raster.tif
    resources: tmpdir=/tmp/ge87say4, mem_mb=5000, mem_mib=4769

[Mon Sep 30 16:40:10 2024]
localrule retrieve_jrc_enspreso_biomass:
    input: https://zenodo.org/records/10356004/files/ENSPRESO_BIOMASS.xlsx (retrieve from storage)
    output: data/ENSPRESO_BIOMASS.xlsx
    jobid: 61
    reason: Updated input files: https://zenodo.org/records/10356004/files/ENSPRESO_BIOMASS.xlsx (retrieve from storage)
    resources: tmpdir=/tmp/ge87say4

host: teramem2
[Mon Sep 30 16:40:12 2024]
Finished job 61.
1 of 101 steps (1%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:40:13 2024]
localrule build_shapes:
    input: data/naturalearth/ne_10m_admin_0_countries_deu.shp, data/eez/World_EEZ_v12_20231025_LR/eez_v12_lowres.gpkg, data/nuts/NUTS_RG_03M_2013_4326_LEVL_3.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/bundle/nama_10r_3gdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls
    output: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/europe_shape.geojson, resources/fusion35-base-cap/nuts3_shapes.geojson
    log: logs/fusion35-base-cap/build_shapes.log
    jobid: 11
    reason: Missing output files: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/nuts3_shapes.geojson, resources/fusion35-base-cap/europe_shape.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    resources: tmpdir=/tmp/ge87say4, mem_mb=1500, mem_mib=1431

INFO:pyogrio._io:Created 34 records
INFO:pyogrio._io:Created 25 records
INFO:pyogrio._io:Created 1 records
INFO:pyogrio._io:Created 1,383 records
[Mon Sep 30 16:40:20 2024]
Finished job 11.
2 of 101 steps (2%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:40:20 2024]
localrule build_gas_network:
    input: data/gas_network/scigrid-gas/data/IGGIELGN_PipeSegments.geojson
    output: resources/fusion35-base-cap/gas_network.csv
    log: logs/fusion35-base-cap/build_gas_network.log
    jobid: 30
    reason: Missing output files: resources/fusion35-base-cap/gas_network.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=4000, mem_mib=3815

WARNING:pyogrio._io:Skipping field country_code: unsupported OGR type: 5
[Mon Sep 30 16:40:37 2024]
Finished job 30.
3 of 101 steps (3%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:40:37 2024]
localrule build_ammonia_production:
    input: data/myb1-2022-nitro-ert.xlsx
    output: resources/fusion35-base-cap/ammonia_production.csv
    log: logs/fusion35-base-cap/build_ammonia_production.log
    jobid: 66
    benchmark: benchmarks/fusion35-base-cap/build_ammonia_production
    reason: Missing output files: resources/fusion35-base-cap/ammonia_production.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:40:41 2024]
Finished job 66.
4 of 101 steps (4%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:40:41 2024]
localrule build_hydro_profile:
    input: resources/fusion35-base-cap/country_shapes.geojson, data/eia_hydro_annual_generation.csv, data/eia_hydro_annual_capacity.csv, data/era5-annual-runoff-per-country.csv, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_hydro.nc
    log: logs/fusion35-base-cap/build_hydro_profile.log
    jobid: 43
    reason: Missing output files: resources/fusion35-base-cap/profile_hydro.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson
    resources: tmpdir=/tmp/ge87say4, mem_mb=5000, mem_mib=4769

WARNING:country_converter.country_converter:Eurasia not found in regex
INFO:atlite.convert:Convert and aggregate 'runoff'.
[Mon Sep 30 16:41:04 2024]
Finished job 9.
5 of 101 steps (5%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:41:04 2024]
localrule retrieve_synthetic_electricity_demand:
    input: https://zenodo.org/records/10820928/files/demand_hourly.csv (retrieve from storage)
    output: data/load_synthetic_raw.csv
    log: logs/retrieve_synthetic_electricity_demand.log
    jobid: 24
    reason: Updated input files: https://zenodo.org/records/10820928/files/demand_hourly.csv (retrieve from storage)
    resources: tmpdir=/tmp/ge87say4, mem_mb=5000, mem_mib=4769

host: teramem2
[Mon Sep 30 16:41:10 2024]
Finished job 24.
6 of 101 steps (6%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:41:10 2024]
localrule build_electricity_demand:
    input: data/electricity_demand_raw.csv, data/load_synthetic_raw.csv
    output: resources/fusion35-base-cap/electricity_demand.csv
    log: logs/fusion35-base-cap/build_electricity_demand.log
    jobid: 22
    reason: Missing output files: resources/fusion35-base-cap/electricity_demand.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=5000, mem_mib=4769

INFO:__main__:Linearly interpolate gaps of size 3 and less.
INFO:__main__:Filling larger gaps by copying time-slices of period '1w'.
INFO:__main__:Supplement missing data with synthetic data.
[Mon Sep 30 16:41:19 2024]
Finished job 22.
7 of 101 steps (7%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:41:19 2024]
localrule build_industry_sector_ratios:
    input: resources/fusion35-base-cap/ammonia_production.csv, data/jrc-idees-2021
    output: resources/fusion35-base-cap/industry_sector_ratios.csv
    log: logs/fusion35-base-cap/build_industry_sector_ratios.log
    jobid: 65
    benchmark: benchmarks/fusion35-base-cap/build_industry_sector_ratios
    reason: Missing output files: resources/fusion35-base-cap/industry_sector_ratios.csv; Input files updated by another job: resources/fusion35-base-cap/ammonia_production.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:41:25 2024]
Finished job 65.
8 of 101 steps (8%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:41:25 2024]
localrule base_network:
    input: data/osm-prebuilt/0.4/links.csv, data/osm-prebuilt/0.4/converters.csv, data/osm-prebuilt/0.4/buses.csv, data/osm-prebuilt/0.4/transformers.csv, data/osm-prebuilt/0.4/lines.csv, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/europe_shape.geojson
    output: resources/fusion35-base-cap/networks/base.nc, resources/fusion35-base-cap/regions_onshore.geojson, resources/fusion35-base-cap/regions_offshore.geojson
    log: logs/fusion35-base-cap/base_network.log
    jobid: 18
    benchmark: benchmarks/fusion35-base-cap/base_network
    reason: Missing output files: resources/fusion35-base-cap/regions_offshore.geojson, resources/fusion35-base-cap/networks/base.nc, resources/fusion35-base-cap/regions_onshore.geojson; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/europe_shape.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    resources: tmpdir=/tmp/ge87say4, mem_mb=1500, mem_mib=1431

INFO:__main__:Creating base network using osm-prebuilt v0.4.
INFO:__main__:Removing buses outside of range AC 200.0 - 750.0 V
INFO:__main__:Removing 0 unconnected network components with less than nan buses. In total 0 buses.
INFO:pyogrio._io:Created 5,442 records
INFO:pyogrio._io:Created 1,072 records
INFO:pypsa.io:Exported network 'base.nc' contains: shapes, transformers, buses, carriers, links, lines
[Mon Sep 30 16:41:50 2024]
Finished job 18.
9 of 101 steps (9%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:41:50 2024]
localrule build_transmission_projects:
    input: resources/fusion35-base-cap/networks/base.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/europe_shape.geojson, data/transmission_projects/tyndp2020, data/transmission_projects/nep, data/transmission_projects/manual
    output: resources/fusion35-base-cap/transmission_projects/new_lines.csv, resources/fusion35-base-cap/transmission_projects/new_links.csv, resources/fusion35-base-cap/transmission_projects/adjust_lines.csv, resources/fusion35-base-cap/transmission_projects/adjust_links.csv, resources/fusion35-base-cap/transmission_projects/new_buses.csv
    log: logs/fusion35-base-cap/build_transmission_projects.log
    jobid: 20
    benchmark: benchmarks/fusion35-base-cap/build_transmission_projects
    reason: Missing output files: resources/fusion35-base-cap/transmission_projects/new_links.csv, resources/fusion35-base-cap/transmission_projects/adjust_links.csv, resources/fusion35-base-cap/transmission_projects/new_lines.csv, resources/fusion35-base-cap/transmission_projects/adjust_lines.csv, resources/fusion35-base-cap/transmission_projects/new_buses.csv; Input files updated by another job: resources/fusion35-base-cap/networks/base.nc, resources/fusion35-base-cap/europe_shape.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    resources: tmpdir=/tmp/ge87say4, mem_mb=4000, mem_mib=3815

[Mon Sep 30 16:41:53 2024]
Finished job 43.
10 of 101 steps (10%) done
Select jobs to execute...
Waiting for more resources.
INFO:pypsa.io:Imported network base.nc has buses, carriers, lines, links, shapes, transformers
INFO:root:Processing new lines projects from tyndp2020.
WARNING:__main__:Found new lines similar to existing lines:
{'TYNDP2020_32': '196723099-b', 'TYNDP2020_38': '209262460', 'TYNDP2020_39': '191187235', 'TYNDP2020_51': '875518342', 'TYNDP2020_58': '368921913', 'TYNDP2020_66': '178621799', 'TYNDP2020_93': '208243244', 'TYNDP2020_120': '881636336', 'TYNDP2020_135': '418614532', 'TYNDP2020_30': '1001117406', 'TYNDP2020_52': '862050701-2', 'TYNDP2020_60': '856645981'}
 Lines are assumed to be duplicated and will be ignored.
INFO:root:Processing new links projects from tyndp2020.
WARNING:__main__:Found new lines similar to existing lines:
{'TYNDP2020_29': 'relation/3391794', 'TYNDP2020_30': 'relation/9982798', 'TYNDP2020_36': 'relation/2127794'}
 Lines are assumed to be duplicated and will be ignored.
INFO:root:Processing new lines projects from nep.
INFO:root:Processing new links projects from nep.
WARNING:__main__:Found new lines similar to existing lines:
{'DC1': 'TYNDP2020_23', 'DC3': 'TYNDP2020_1', 'DC4': 'TYNDP2020_2'}
 Lines are assumed to be duplicated and will be ignored.
INFO:root:Processing new links projects from manual.
[Mon Sep 30 16:42:03 2024]
Finished job 20.
11 of 101 steps (11%) done
Execute 1 jobs...

[Mon Sep 30 16:42:03 2024]
localrule build_energy_totals:
    input: resources/fusion35-base-cap/nuts3_shapes.geojson, data/bundle/eea/UNFCCC_v23.csv, data/switzerland-new_format-all_years.csv, data/gr-e-11.03.02.01.01-cc.csv, data/jrc-idees-2021, data/district_heat_share.csv, data/eurostat/Balances-April2023, data/eurostat/eurostat-household_energy_balances-february_2024.csv
    output: resources/fusion35-base-cap/transformation_output_coke.csv, resources/fusion35-base-cap/energy_totals.csv, resources/fusion35-base-cap/co2_totals.csv, resources/fusion35-base-cap/transport_data.csv, resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/heating_efficiencies.csv
    log: logs/fusion35-base-cap/build_energy_totals.log
    jobid: 51
    benchmark: benchmarks/fusion35-base-cap/build_energy_totals
    reason: Missing output files: resources/fusion35-base-cap/energy_totals.csv, resources/fusion35-base-cap/transformation_output_coke.csv, resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/transport_data.csv, resources/fusion35-base-cap/co2_totals.csv; Input files updated by another job: resources/fusion35-base-cap/nuts3_shapes.geojson
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:03<01:37,  3.04s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:54,  1.82s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:45,  1.62s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.52s/ country]Build from eurostat database:  24%|██▍       | 8/33 [00:11<00:29,  1.20s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:37,  1.58s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:33,  1.51s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:29,  1.46s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:23<00:26,  1.50s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:23<00:20,  1.22s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:24,  1.53s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:25<00:17,  1.20s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:21,  1.55s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:15,  1.18s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:18,  1.58s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:14,  1.49s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:10,  1.16s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:12,  1.51s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:36<00:08,  1.16s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:09,  1.56s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:39<00:05,  1.17s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:06,  1.56s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:42<00:03,  1.17s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:44<00:03,  1.58s/ country]Build from eurostat database:  97%|█████████▋| 32/33 [00:45<00:01,  1.17s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.22s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.41s/ country]
Build from IDEES database:   0%|          | 0/25 [00:00<?, ? country/s]Build from IDEES database:   4%|▍         | 1/25 [00:02<00:51,  2.15s/ country]Build from IDEES database:  12%|█▏        | 3/25 [00:04<00:28,  1.28s/ country]Build from IDEES database:  20%|██        | 5/25 [00:06<00:22,  1.12s/ country]Build from IDEES database:  28%|██▊       | 7/25 [00:07<00:19,  1.06s/ country]Build from IDEES database:  36%|███▌      | 9/25 [00:09<00:16,  1.01s/ country]Build from IDEES database:  44%|████▍     | 11/25 [00:11<00:13,  1.02 country/s]Build from IDEES database:  52%|█████▏    | 13/25 [00:13<00:11,  1.02 country/s]Build from IDEES database:  60%|██████    | 15/25 [00:15<00:09,  1.04 country/s]Build from IDEES database:  68%|██████▊   | 17/25 [00:17<00:07,  1.05 country/s]Build from IDEES database:  76%|███████▌  | 19/25 [00:19<00:05,  1.05 country/s]Build from IDEES database:  84%|████████▍ | 21/25 [00:21<00:03,  1.06 country/s]Build from IDEES database:  92%|█████████▏| 23/25 [00:23<00:01,  1.06 country/s]Build from IDEES database: 100%|██████████| 25/25 [00:24<00:00,  1.20 country/s]Build from IDEES database: 100%|██████████| 25/25 [00:24<00:00,  1.03 country/s]
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:783: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"electricity {sector}"].replace(0, np.nan).infer_objects(copy=False)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:800: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:837: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  nonelectric = nonelectric.copy().replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:922: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df.loc["BA"].replace(0.0, np.nan).infer_objects(copy=False).values
INFO:__main__:Updated energy balances for residential using disaggregate final energy consumption data in Households from Eurostat
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:960: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .replace(0, np.nan)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:987: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  district_heat_share.unstack().dropna(how="all", axis=1).ffill(axis=1)
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpfbl1p1if.build_energy_totals.py:1168: PerformanceWarning: indexing past lexsort depth may impact performance.
  co2.at[ct, i] = eurostat_co2.loc[mi].sum()
INFO:__main__:Missing data on cars from:
[('AL', 2000), ('AL', 2001), ('AL', 2002), ('AL', 2003), ('AL', 2004), ('AL', 2005), ('AL', 2006), ('AL', 2007), ('AL', 2008), ('AL', 2009), ('AL', 2010), ('AL', 2011), ('AL', 2012), ('AL', 2013), ('AL', 2014), ('AL', 2015), ('AL', 2016), ('AL', 2017), ('AL', 2018), ('AL', 2019), ('AL', 2020), ('AL', 2021), ('BA', 2000), ('BA', 2001), ('BA', 2002), ('BA', 2003), ('BA', 2004), ('BA', 2005), ('BA', 2006), ('BA', 2007), ('BA', 2008), ('BA', 2009), ('BA', 2010), ('BA', 2011), ('BA', 2012), ('BA', 2013), ('BA', 2014), ('BA', 2015), ('BA', 2016), ('BA', 2017), ('BA', 2018), ('BA', 2019), ('BA', 2020), ('BA', 2021), ('GB', 2000), ('GB', 2001), ('GB', 2002), ('GB', 2003), ('GB', 2004), ('GB', 2005), ('GB', 2006), ('GB', 2007), ('GB', 2008), ('GB', 2009), ('GB', 2010), ('GB', 2011), ('GB', 2012), ('GB', 2013), ('GB', 2014), ('GB', 2015), ('GB', 2016), ('GB', 2017), ('GB', 2018), ('GB', 2019), ('GB', 2020), ('GB', 2021), ('ME', 2000), ('ME', 2001), ('ME', 2002), ('ME', 2003), ('ME', 2004), ('ME', 2005), ('ME', 2006), ('ME', 2007), ('ME', 2008), ('ME', 2009), ('ME', 2010), ('ME', 2011), ('ME', 2012), ('ME', 2013), ('ME', 2014), ('ME', 2015), ('ME', 2016), ('ME', 2017), ('ME', 2018), ('ME', 2019), ('ME', 2020), ('ME', 2021), ('MK', 2000), ('MK', 2001), ('MK', 2002), ('MK', 2003), ('MK', 2004), ('MK', 2005), ('MK', 2006), ('MK', 2007), ('MK', 2008), ('MK', 2009), ('MK', 2010), ('MK', 2011), ('MK', 2012), ('MK', 2013), ('MK', 2014), ('MK', 2015), ('MK', 2016), ('MK', 2017), ('MK', 2018), ('MK', 2019), ('MK', 2020), ('MK', 2021), ('NO', 2000), ('NO', 2001), ('NO', 2002), ('NO', 2003), ('NO', 2004), ('NO', 2005), ('NO', 2006), ('NO', 2007), ('NO', 2008), ('NO', 2009), ('NO', 2010), ('NO', 2011), ('NO', 2012), ('NO', 2013), ('NO', 2014), ('NO', 2015), ('NO', 2016), ('NO', 2017), ('NO', 2018), ('NO', 2019), ('NO', 2020), ('NO', 2021), ('RS', 2000), ('RS', 2001), ('RS', 2002), ('RS', 2003), ('RS', 2004), ('RS', 2005), ('RS', 2006), ('RS', 2007), ('RS', 2008), ('RS', 2009), ('RS', 2010), ('RS', 2011), ('RS', 2012), ('RS', 2013), ('RS', 2014), ('RS', 2015), ('RS', 2016), ('RS', 2017), ('RS', 2018), ('RS', 2019), ('RS', 2020), ('RS', 2021), ('XK', 2000), ('XK', 2001), ('XK', 2002), ('XK', 2003), ('XK', 2004), ('XK', 2005), ('XK', 2006), ('XK', 2007), ('XK', 2008), ('XK', 2009), ('XK', 2010), ('XK', 2011), ('XK', 2012), ('XK', 2013), ('XK', 2014), ('XK', 2015), ('XK', 2016), ('XK', 2017), ('XK', 2018), ('XK', 2019), ('XK', 2020), ('XK', 2021)]
Filling gaps with averaged data.
INFO:__main__:Missing data on fuel efficiency from:
[('AL', 2000), ('AL', 2001), ('AL', 2002), ('AL', 2003), ('AL', 2004), ('AL', 2005), ('AL', 2006), ('AL', 2007), ('AL', 2008), ('AL', 2009), ('AL', 2010), ('AL', 2011), ('AL', 2012), ('AL', 2013), ('AL', 2014), ('AL', 2015), ('AL', 2016), ('AL', 2017), ('AL', 2018), ('AL', 2019), ('AL', 2020), ('AL', 2021), ('BA', 2000), ('BA', 2001), ('BA', 2002), ('BA', 2003), ('BA', 2004), ('BA', 2005), ('BA', 2006), ('BA', 2007), ('BA', 2008), ('BA', 2009), ('BA', 2010), ('BA', 2011), ('BA', 2012), ('BA', 2013), ('BA', 2014), ('BA', 2015), ('BA', 2016), ('BA', 2017), ('BA', 2018), ('BA', 2019), ('BA', 2020), ('BA', 2021), ('CH', 2000), ('CH', 2001), ('CH', 2002), ('CH', 2003), ('CH', 2004), ('CH', 2005), ('CH', 2006), ('CH', 2007), ('CH', 2008), ('CH', 2009), ('CH', 2010), ('CH', 2011), ('CH', 2012), ('CH', 2013), ('CH', 2014), ('CH', 2015), ('CH', 2016), ('CH', 2017), ('CH', 2018), ('CH', 2019), ('CH', 2020), ('CH', 2021), ('GB', 2000), ('GB', 2001), ('GB', 2002), ('GB', 2003), ('GB', 2004), ('GB', 2005), ('GB', 2006), ('GB', 2007), ('GB', 2008), ('GB', 2009), ('GB', 2010), ('GB', 2011), ('GB', 2012), ('GB', 2013), ('GB', 2014), ('GB', 2015), ('GB', 2016), ('GB', 2017), ('GB', 2018), ('GB', 2019), ('GB', 2020), ('GB', 2021), ('ME', 2000), ('ME', 2001), ('ME', 2002), ('ME', 2003), ('ME', 2004), ('ME', 2005), ('ME', 2006), ('ME', 2007), ('ME', 2008), ('ME', 2009), ('ME', 2010), ('ME', 2011), ('ME', 2012), ('ME', 2013), ('ME', 2014), ('ME', 2015), ('ME', 2016), ('ME', 2017), ('ME', 2018), ('ME', 2019), ('ME', 2020), ('ME', 2021), ('MK', 2000), ('MK', 2001), ('MK', 2002), ('MK', 2003), ('MK', 2004), ('MK', 2005), ('MK', 2006), ('MK', 2007), ('MK', 2008), ('MK', 2009), ('MK', 2010), ('MK', 2011), ('MK', 2012), ('MK', 2013), ('MK', 2014), ('MK', 2015), ('MK', 2016), ('MK', 2017), ('MK', 2018), ('MK', 2019), ('MK', 2020), ('MK', 2021), ('NO', 2000), ('NO', 2001), ('NO', 2002), ('NO', 2003), ('NO', 2004), ('NO', 2005), ('NO', 2006), ('NO', 2007), ('NO', 2008), ('NO', 2009), ('NO', 2010), ('NO', 2011), ('NO', 2012), ('NO', 2013), ('NO', 2014), ('NO', 2015), ('NO', 2016), ('NO', 2017), ('NO', 2018), ('NO', 2019), ('NO', 2020), ('NO', 2021), ('RS', 2000), ('RS', 2001), ('RS', 2002), ('RS', 2003), ('RS', 2004), ('RS', 2005), ('RS', 2006), ('RS', 2007), ('RS', 2008), ('RS', 2009), ('RS', 2010), ('RS', 2011), ('RS', 2012), ('RS', 2013), ('RS', 2014), ('RS', 2015), ('RS', 2016), ('RS', 2017), ('RS', 2018), ('RS', 2019), ('RS', 2020), ('RS', 2021), ('XK', 2000), ('XK', 2001), ('XK', 2002), ('XK', 2003), ('XK', 2004), ('XK', 2005), ('XK', 2006), ('XK', 2007), ('XK', 2008), ('XK', 2009), ('XK', 2010), ('XK', 2011), ('XK', 2012), ('XK', 2013), ('XK', 2014), ('XK', 2015), ('XK', 2016), ('XK', 2017), ('XK', 2018), ('XK', 2019), ('XK', 2020), ('XK', 2021)]
Filling gaps with averaged data.
[Mon Sep 30 16:43:20 2024]
Finished job 51.
12 of 101 steps (12%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:43:20 2024]
localrule build_industrial_production_per_country:
    input: data/ch_industrial_production_per_subsector.csv, resources/fusion35-base-cap/ammonia_production.csv, data/jrc-idees-2021, data/eurostat/Balances-April2023
    output: resources/fusion35-base-cap/industrial_production_per_country.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_country.log
    jobid: 69
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_country
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_per_country.csv; Input files updated by another job: resources/fusion35-base-cap/ammonia_production.csv
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

Build industry production:   0%|          | 0/34 [00:00<?, ? country/s]Build industry production:   3%|▎         | 1/34 [00:02<01:29,  2.71s/ country]Build industry production:   9%|▉         | 3/34 [00:05<00:50,  1.62s/ country]Build industry production:  15%|█▍        | 5/34 [00:07<00:39,  1.37s/ country]Build industry production:  18%|█▊        | 6/34 [00:07<00:30,  1.08s/ country]Build industry production:  21%|██        | 7/34 [00:09<00:36,  1.37s/ country]Build industry production:  24%|██▎       | 8/34 [00:09<00:26,  1.02s/ country]Build industry production:  26%|██▋       | 9/34 [00:12<00:33,  1.36s/ country]Build industry production:  32%|███▏      | 11/34 [00:14<00:29,  1.28s/ country]Build industry production:  38%|███▊      | 13/34 [00:16<00:25,  1.23s/ country]Build industry production:  41%|████      | 14/34 [00:17<00:20,  1.03s/ country]Build industry production:  44%|████▍     | 15/34 [00:19<00:23,  1.24s/ country]Build industry production:  47%|████▋     | 16/34 [00:19<00:18,  1.01s/ country]Build industry production:  50%|█████     | 17/34 [00:21<00:21,  1.25s/ country]Build industry production:  53%|█████▎    | 18/34 [00:21<00:15,  1.01 country/s]Build industry production:  56%|█████▌    | 19/34 [00:23<00:18,  1.26s/ country]Build industry production:  59%|█████▉    | 20/34 [00:23<00:14,  1.01s/ country]Build industry production:  62%|██████▏   | 21/34 [00:25<00:16,  1.25s/ country]Build industry production:  65%|██████▍   | 22/34 [00:26<00:11,  1.00 country/s]Build industry production:  68%|██████▊   | 23/34 [00:28<00:14,  1.32s/ country]Build industry production:  71%|███████   | 24/34 [00:28<00:09,  1.00 country/s]Build industry production:  74%|███████▎  | 25/34 [00:30<00:12,  1.39s/ country]Build industry production:  76%|███████▋  | 26/34 [00:31<00:08,  1.05s/ country]Build industry production:  79%|███████▉  | 27/34 [00:33<00:09,  1.33s/ country]Build industry production:  82%|████████▏ | 28/34 [00:33<00:06,  1.01s/ country]Build industry production:  85%|████████▌ | 29/34 [00:35<00:06,  1.34s/ country]Build industry production:  88%|████████▊ | 30/34 [00:35<00:04,  1.08s/ country]Build industry production:  91%|█████████ | 31/34 [00:37<00:03,  1.29s/ country]Build industry production:  94%|█████████▍| 32/34 [00:38<00:02,  1.05s/ country]Build industry production:  97%|█████████▋| 33/34 [00:40<00:01,  1.29s/ country]Build industry production: 100%|██████████| 34/34 [00:40<00:00,  1.03s/ country]Build industry production: 100%|██████████| 34/34 [00:40<00:00,  1.19s/ country]
INFO:__main__:Following countries have no ammonia demand: ['AL', 'BA', 'DK', 'IE', 'LU', 'LV', 'ME', 'MK', 'PT', 'SE', 'SI', 'XK']
[Mon Sep 30 16:44:02 2024]
Finished job 69.
13 of 101 steps (13%) done
Select jobs to execute...
Execute 2 jobs...

[Mon Sep 30 16:44:02 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2055.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2055.log
    jobid: 87
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2055
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2055.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv
    wildcards: planning_horizons=2055
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:44:02 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2095.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2095.log
    jobid: 105
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2095
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2095.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv
    wildcards: planning_horizons=2095
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:44:09 2024]
Finished job 105.
14 of 101 steps (14%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:09 2024]
localrule build_heat_totals:
    input: data/era5-annual-HDD-per-country.csv, resources/fusion35-base-cap/energy_totals.csv
    output: resources/fusion35-base-cap/heat_totals.csv
    log: logs/fusion35-base-cap/build_heat_totals.log
    jobid: 56
    benchmark: benchmarks/fusion35-base-cap/build_heat_totals
    reason: Missing output files: resources/fusion35-base-cap/heat_totals.csv; Input files updated by another job: resources/fusion35-base-cap/energy_totals.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 16:44:09 2024]
Finished job 87.
15 of 101 steps (15%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:09 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2035.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2035.log
    jobid: 74
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2035
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2035.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv
    wildcards: planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:44:11 2024]
Finished job 56.
16 of 101 steps (16%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:11 2024]
localrule build_industrial_production_per_country_tomorrow:
    input: resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2075.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2075.log
    jobid: 96
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_country_tomorrow_2075
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2075.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv
    wildcards: planning_horizons=2075
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:44:12 2024]
Finished job 74.
17 of 101 steps (17%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:12 2024]
localrule add_transmission_projects_and_dlr:
    input: resources/fusion35-base-cap/networks/base.nc, resources/fusion35-base-cap/transmission_projects/new_buses.csv, resources/fusion35-base-cap/transmission_projects/new_lines.csv, resources/fusion35-base-cap/transmission_projects/new_links.csv, resources/fusion35-base-cap/transmission_projects/adjust_lines.csv, resources/fusion35-base-cap/transmission_projects/adjust_links.csv
    output: resources/fusion35-base-cap/networks/base_extended.nc
    log: logs/fusion35-base-cap/add_transmission_projects_and_dlr.log
    jobid: 17
    benchmark: benchmarks/fusion35-base-cap/add_transmission_projects_and_dlr
    reason: Missing output files: resources/fusion35-base-cap/networks/base_extended.nc; Input files updated by another job: resources/fusion35-base-cap/transmission_projects/adjust_links.csv, resources/fusion35-base-cap/transmission_projects/new_links.csv, resources/fusion35-base-cap/transmission_projects/new_buses.csv, resources/fusion35-base-cap/networks/base.nc, resources/fusion35-base-cap/transmission_projects/new_lines.csv, resources/fusion35-base-cap/transmission_projects/adjust_lines.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=4000, mem_mib=3815

[Mon Sep 30 16:44:14 2024]
Finished job 96.
18 of 101 steps (18%) done
Select jobs to execute...
Waiting for more resources.
INFO:pypsa.io:Imported network base.nc has buses, carriers, lines, links, shapes, transformers
INFO:__main__:Adding transmission projects to network.
INFO:pypsa.io:Exported network 'base_extended.nc' contains: carriers, links, transformers, lines, buses, shapes
[Mon Sep 30 16:44:17 2024]
Finished job 17.
19 of 101 steps (19%) done
Execute 1 jobs...

[Mon Sep 30 16:44:17 2024]
localrule build_industrial_energy_demand_per_country_today:
    input: resources/fusion35-base-cap/transformation_output_coke.csv, data/jrc-idees-2021, resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv
    log: logs/fusion35-base-cap/build_industrial_energy_demand_per_country_today.log
    jobid: 68
    benchmark: benchmarks/fusion35-base-cap/build_industrial_energy_demand_per_country_today
    reason: Missing output files: resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv, resources/fusion35-base-cap/transformation_output_coke.csv
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

Build industrial energy demand:   0%|          | 0/25 [00:00<?, ? country/s]Build industrial energy demand:   4%|▍         | 1/25 [00:01<00:25,  1.07s/ country]Build industrial energy demand:  12%|█▏        | 3/25 [00:01<00:13,  1.65 country/s]Build industrial energy demand:  20%|██        | 5/25 [00:02<00:10,  1.92 country/s]Build industrial energy demand:  28%|██▊       | 7/25 [00:03<00:08,  2.09 country/s]Build industrial energy demand:  36%|███▌      | 9/25 [00:04<00:07,  2.13 country/s]Build industrial energy demand:  44%|████▍     | 11/25 [00:05<00:06,  2.20 country/s]Build industrial energy demand:  48%|████▊     | 12/25 [00:05<00:05,  2.57 country/s]Build industrial energy demand:  52%|█████▏    | 13/25 [00:06<00:05,  2.11 country/s]Build industrial energy demand:  56%|█████▌    | 14/25 [00:06<00:04,  2.57 country/s]Build industrial energy demand:  60%|██████    | 15/25 [00:07<00:04,  2.10 country/s]Build industrial energy demand:  64%|██████▍   | 16/25 [00:07<00:03,  2.54 country/s]Build industrial energy demand:  68%|██████▊   | 17/25 [00:08<00:03,  2.11 country/s]Build industrial energy demand:  72%|███████▏  | 18/25 [00:08<00:02,  2.50 country/s]Build industrial energy demand:  76%|███████▌  | 19/25 [00:08<00:02,  2.07 country/s]Build industrial energy demand:  80%|████████  | 20/25 [00:09<00:01,  2.59 country/s]Build industrial energy demand:  84%|████████▍ | 21/25 [00:09<00:01,  2.07 country/s]Build industrial energy demand:  88%|████████▊ | 22/25 [00:09<00:01,  2.53 country/s]Build industrial energy demand:  92%|█████████▏| 23/25 [00:10<00:00,  2.11 country/s]Build industrial energy demand:  96%|█████████▌| 24/25 [00:10<00:00,  2.47 country/s]Build industrial energy demand: 100%|██████████| 25/25 [00:11<00:00,  2.51 country/s]Build industrial energy demand: 100%|██████████| 25/25 [00:11<00:00,  2.22 country/s]
[Mon Sep 30 16:44:29 2024]
Finished job 68.
20 of 101 steps (20%) done
Select jobs to execute...
Execute 2 jobs...

[Mon Sep 30 16:44:29 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/fusion35-base-cap/industry_sector_ratios.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industry_sector_ratios_2055.csv
    log: logs/fusion35-base-cap/build_industry_sector_ratios_2055.log
    jobid: 85
    benchmark: benchmarks/fusion35-base-cap/build_industry_sector_ratios_2055
    reason: Missing output files: resources/fusion35-base-cap/industry_sector_ratios_2055.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industry_sector_ratios.csv
    wildcards: planning_horizons=2055
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:44:29 2024]
localrule simplify_network:
    input: resources/fusion35-base-cap/networks/base_extended.nc, resources/fusion35-base-cap/regions_onshore.geojson, resources/fusion35-base-cap/regions_offshore.geojson
    output: resources/fusion35-base-cap/networks/base_s.nc, resources/fusion35-base-cap/regions_onshore_base_s.geojson, resources/fusion35-base-cap/regions_offshore_base_s.geojson, resources/fusion35-base-cap/busmap_base_s.csv
    log: logs/fusion35-base-cap/simplify_network.log
    jobid: 16
    benchmark: benchmarks/fusion35-base-cap/simplify_network_b
    reason: Missing output files: resources/fusion35-base-cap/regions_offshore_base_s.geojson, resources/fusion35-base-cap/regions_onshore_base_s.geojson, resources/fusion35-base-cap/networks/base_s.nc, resources/fusion35-base-cap/busmap_base_s.csv; Input files updated by another job: resources/fusion35-base-cap/networks/base_extended.nc, resources/fusion35-base-cap/regions_offshore.geojson, resources/fusion35-base-cap/regions_onshore.geojson
    resources: tmpdir=/tmp/ge87say4, mem_mb=12000, mem_mib=11445

[Mon Sep 30 16:44:33 2024]
Finished job 85.
21 of 101 steps (21%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:33 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/fusion35-base-cap/industry_sector_ratios.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industry_sector_ratios_2075.csv
    log: logs/fusion35-base-cap/build_industry_sector_ratios_2075.log
    jobid: 94
    benchmark: benchmarks/fusion35-base-cap/build_industry_sector_ratios_2075
    reason: Missing output files: resources/fusion35-base-cap/industry_sector_ratios_2075.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industry_sector_ratios.csv
    wildcards: planning_horizons=2075
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:pypsa.io:Imported network base_extended.nc has buses, carriers, lines, links, shapes, transformers
INFO:__main__:Mapping all network lines onto a single 380kV layer
INFO:__main__:Simplifying connected link components
INFO:__main__:Joining the links converter/relation/3391954_0, relation/3391954, converter/relation/3391954_1 connecting the buses 1487, 5976, 6027, 3708 to simple link relation/3391954+2
INFO:__main__:Joining the links converter/relation/8184631_1, relation/8184631, converter/relation/8184631_0 connecting the buses 1487, 5975, 6022, 3717 to simple link relation/8184631+2
INFO:__main__:Joining the links converter/relation/9965201_1, relation/9965201, converter/relation/9965201_0 connecting the buses 4160, 6050, 6019, 3179 to simple link relation/9965201+2
INFO:__main__:Joining the links converter/relation/8185420_0, relation/8185420, converter/relation/8185420_1 connecting the buses 896, 5963, 6018, 3179 to simple link relation/8185420+2
INFO:__main__:Joining the links converter/relation/15775538_1, relation/15775538, converter/relation/15775538_0 connecting the buses 2337, 5995, 5993, 2576 to simple link relation/15775538+2
INFO:__main__:Joining the links converter/relation/8184641_0, relation/8184641, converter/relation/8184641_1 connecting the buses 2337, 5994, 6007, 2748 to simple link relation/8184641+2
INFO:__main__:Joining the links TYNDP2024_1169, relation/8185711, converter/relation/8185711_1 connecting the buses 2794, 6014, 6016, 3066 to simple link relation/8185711+2
INFO:__main__:Joining the links converter/relation/2127794_0, relation/2127794, converter/relation/2127794_1 connecting the buses 2639, 5984, 5981, 1638 to simple link relation/2127794+2
INFO:__main__:Joining the links converter/relation/15772117_1, relation/15772117, converter/relation/15772117_0 connecting the buses 1638, 5982, 5999, 5519 to simple link relation/15772117+2
INFO:__main__:Joining the links converter/relation/3391931_0, relation/3391931, converter/relation/3391931_1 connecting the buses 892, 5969, 6045, 4157 to simple link relation/3391931+2
INFO:__main__:Joining the links converter/relation/8184632_0, relation/8184632, converter/relation/8184632_1 connecting the buses 892, 5971, 6055, 4157 to simple link relation/8184632+2
INFO:__main__:Joining the links converter/relation/8184633_0, relation/8184633, converter/relation/8184633_1 connecting the buses 3844, 6024, 6026, 3784 to simple link relation/8184633+2
INFO:__main__:Joining the links converter/relation/3391794_0, relation/3391794 connecting the buses 2987, 6011, 5979 to simple link relation/3391794+1
INFO:__main__:Joining the links converter/relation/9982798_1, relation/9982798 connecting the buses 2904, 6012, 5979 to simple link relation/9982798+1
INFO:__main__:Joining the links converter/relation/16213216_0, relation/16213216, converter/relation/16213216_1 connecting the buses 653, 5953, 6031, 4188 to simple link relation/16213216+2
INFO:__main__:Joining the links converter/relation/8185664_1, relation/8185664, converter/relation/8185664_0 connecting the buses 5738, 6006, 6008, 2923 to simple link relation/8185664+2
INFO:__main__:Joining the links converter/relation/2505320_0, relation/2505320, converter/relation/2505320_1 connecting the buses 867, 6049, 5955, 560 to simple link relation/2505320+2
INFO:__main__:Joining the links converter/relation/3918230_0, relation/3918230, converter/relation/3918230_1 connecting the buses 663, 6051, 6029, 3705 to simple link relation/3918230+2
INFO:__main__:Joining the links converter/relation/13295785_0, relation/13295785, converter/relation/13295785_1 connecting the buses 4183, 6056, 5998, 2585 to simple link relation/13295785+2
INFO:__main__:Joining the links converter/relation/14126301_0, relation/14126301, converter/relation/14126301_1 connecting the buses 2492, 5985, 6020, 3162 to simple link relation/14126301+2
INFO:__main__:Joining the links converter/relation/8193755_0, relation/8193755, converter/relation/8193755_1 connecting the buses 106, 5948, 5954, 493 to simple link relation/8193755+2
INFO:__main__:Joining the links converter/relation/3392010_0, relation/3392010, converter/relation/3392010_1 connecting the buses 3439, 6053, 6052, 4217 to simple link relation/3392010+2
INFO:__main__:Joining the links converter/relation/8099179_1, relation/8099179, converter/relation/8099179_0 connecting the buses 2605, 6005, 5996, 2499 to simple link relation/8099179+2
INFO:__main__:Joining the links converter/relation/6886400_0, relation/6886400, converter/relation/6886400_1 connecting the buses 910, 5972, 6054, 1488 to simple link relation/6886400+2
INFO:__main__:Joining the links converter/relation/17631956_0, relation/17631956, converter/relation/17631956_1 connecting the buses 1004, 5974, 5973, 1078 to simple link relation/17631956+2
INFO:__main__:Joining the links converter/relation/10377412_1, relation/10377412, converter/relation/10377412_0 connecting the buses 2350, 5997, 5980, 1749 to simple link relation/10377412+2
INFO:__main__:Joining the links converter/relation/8184630_0, relation/8184630, converter/relation/8184630_1 connecting the buses 904, 6038, 6037, 1489 to simple link relation/8184630+2
INFO:__main__:Joining the links converter/relation/15781671_1, relation/15781671, converter/relation/15781671_0 connecting the buses 888, 5967, 6004, 2540 to simple link relation/15781671+2
INFO:__main__:Joining the links converter/relation/8185767_1, relation/8185767, converter/relation/8185767_0 connecting the buses 3149, 6017, 6015, 3097 to simple link relation/8185767+2
INFO:__main__:Joining the links converter/relation/8185455_1, relation/8185455, converter/relation/8185455_0 connecting the buses 4209, 6041, 6042, 3113 to simple link relation/8185455+2
INFO:__main__:Joining the links converter/relation/8185487_0, relation/8185487, converter/relation/8185487_1 connecting the buses 4114, 6046, 5947, 142 to simple link relation/8185487+2
INFO:__main__:Joining the links converter/relation/6914309_0, relation/6914309, converter/relation/6914309_1 connecting the buses 2513, 5988, 5991, 5014 to simple link relation/6914309+2
INFO:__main__:Joining the links converter/relation/9934065_1, converter/relation/9934066_1, relation/9934065, relation/9934066, converter/relation/9934065_0, converter/relation/9934066_0 connecting the buses 1348, 6044, 6043, 1690 to simple link relation/9934066+2
INFO:__main__:Joining the links converter/relation/8184629_1, relation/8184629, converter/relation/8184629_0 connecting the buses 3701, 6040, 6039, 880 to simple link relation/8184629+2
INFO:__main__:Joining the links converter/relation/5487095_1, relation/5487095, converter/relation/5487095_0 connecting the buses 887, 6048, 6047, 869 to simple link relation/5487095+2
INFO:__main__:Joining the links relation/3392001, converter/relation/3392001_1 connecting the buses 6036, 6035, 3781 to simple link relation/3392001+1
INFO:__main__:Removing stubs
[Mon Sep 30 16:44:36 2024]
Finished job 94.
22 of 101 steps (22%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:36 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/fusion35-base-cap/industry_sector_ratios.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industry_sector_ratios_2035.csv
    log: logs/fusion35-base-cap/build_industry_sector_ratios_2035.log
    jobid: 64
    benchmark: benchmarks/fusion35-base-cap/build_industry_sector_ratios_2035
    reason: Missing output files: resources/fusion35-base-cap/industry_sector_ratios_2035.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industry_sector_ratios.csv
    wildcards: planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:pyogrio._io:Created 3,670 records
INFO:pyogrio._io:Created 846 records
INFO:pypsa.io:Exported network 'base_s.nc' contains: links, lines, buses, carriers, shapes
[Mon Sep 30 16:44:40 2024]
Finished job 64.
23 of 101 steps (23%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:40 2024]
localrule build_industry_sector_ratios_intermediate:
    input: resources/fusion35-base-cap/industry_sector_ratios.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industrial_production_per_country.csv
    output: resources/fusion35-base-cap/industry_sector_ratios_2095.csv
    log: logs/fusion35-base-cap/build_industry_sector_ratios_2095.log
    jobid: 103
    benchmark: benchmarks/fusion35-base-cap/build_industry_sector_ratios_2095
    reason: Missing output files: resources/fusion35-base-cap/industry_sector_ratios_2095.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_per_country.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv, resources/fusion35-base-cap/industry_sector_ratios.csv
    wildcards: planning_horizons=2095
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:__main__:Simplified network:
Buses: 5557 to 3719
Lines: 7024 to 6128
Links: 151 to 74
[Mon Sep 30 16:44:41 2024]
Finished job 16.
24 of 101 steps (24%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:44:41 2024]
localrule build_electricity_demand_base:
    input: resources/fusion35-base-cap/networks/base_s.nc, resources/fusion35-base-cap/regions_onshore_base_s.geojson, resources/fusion35-base-cap/nuts3_shapes.geojson, resources/fusion35-base-cap/electricity_demand.csv
    output: resources/fusion35-base-cap/electricity_demand_base_s.nc
    log: logs/fusion35-base-cap/build_electricity_demand_base_s.log
    jobid: 21
    benchmark: benchmarks/fusion35-base-cap/build_electricity_demand_base_s
    reason: Missing output files: resources/fusion35-base-cap/electricity_demand_base_s.nc; Input files updated by another job: resources/fusion35-base-cap/regions_onshore_base_s.geojson, resources/fusion35-base-cap/networks/base_s.nc, resources/fusion35-base-cap/nuts3_shapes.geojson, resources/fusion35-base-cap/electricity_demand.csv
    resources: tmpdir=/tmp/ge87say4, mem_mb=5000, mem_mib=4769

[Mon Sep 30 16:44:46 2024]
Finished job 103.
25 of 101 steps (25%) done
Select jobs to execute...
Waiting for more resources.
INFO:pypsa.io:Imported network base_s.nc has buses, carriers, lines, links, shapes
[Mon Sep 30 16:45:29 2024]
Finished job 21.
26 of 101 steps (26%) done
Execute 1 jobs...

[Mon Sep 30 16:45:29 2024]
localrule build_population_layouts:
    input: resources/fusion35-base-cap/nuts3_shapes.geojson, /dss/dssfs02/lwp-dss-0001/pn39ci/pn39ci-dss-0000/input_files/API_SP.URB.TOTL.IN.ZS_DS2_en_csv_v2_1978.csv, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/pop_layout_urban.nc, resources/fusion35-base-cap/pop_layout_rural.nc
    log: logs/fusion35-base-cap/build_population_layouts.log
    jobid: 47
    benchmark: benchmarks/fusion35-base-cap/build_population_layouts
    reason: Missing output files: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/pop_layout_rural.nc, resources/fusion35-base-cap/pop_layout_urban.nc; Input files updated by another job: resources/fusion35-base-cap/nuts3_shapes.geojson
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/geopandas/geoseries.py:720: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  val = getattr(super(), mtd)(*args, **kwargs)
[Mon Sep 30 16:45:45 2024]
Finished job 47.
27 of 101 steps (27%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:45:45 2024]
localrule cluster_network:
    input: resources/fusion35-base-cap/networks/base_s.nc, resources/fusion35-base-cap/regions_onshore_base_s.geojson, resources/fusion35-base-cap/regions_offshore_base_s.geojson, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/electricity_demand_base_s.nc
    output: resources/fusion35-base-cap/networks/base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/linemap_base_s_39.csv
    log: logs/fusion35-base-cap/cluster_network_base_s_39.log
    jobid: 15
    benchmark: benchmarks/fusion35-base-cap/cluster_network_base_s_39
    reason: Missing output files: resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/networks/base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/busmap_base_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/networks/base_s.nc, resources/fusion35-base-cap/electricity_demand_base_s.nc, resources/fusion35-base-cap/regions_offshore_base_s.geojson, resources/fusion35-base-cap/regions_onshore_base_s.geojson, resources/fusion35-base-cap/busmap_base_s.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s.nc has buses, carriers, lines, links, shapes
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/xarray/core/dataarray.py:3173: DeprecationWarning: Deleting a single level of a MultiIndex is deprecated. Previously, this deleted all levels of a MultiIndex. Please also drop the following variables: {'dim_0'} to avoid an error in the future.
  ds = self._to_temp_dataset().drop_vars(names, errors=errors)
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.io: Writing time: 0.01s
WARNING:linopy.solvers:Dual values of MILP couldn't be parsed
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 39 primals, 0 duals
Objective: -3.90e+01
Solver model: available
Solver message: 2

INFO:pyogrio._io:Created 39 records
INFO:pyogrio._io:Created 30 records
INFO:pypsa.io:Exported network 'base_s_39.nc' contains: buses, carriers, lines, links
INFO:__main__:Clustered network:
Buses: 3719 to 39
Lines: 6128 to 73
Links: 74 to 45
[Mon Sep 30 16:46:10 2024]
Finished job 15.
28 of 101 steps (28%) done
Select jobs to execute...
Execute 2 jobs...

[Mon Sep 30 16:46:10 2024]
localrule build_salt_cavern_potentials:
    input: data/bundle/h2_salt_caverns_GWh_per_sqkm.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson
    output: resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv
    log: logs/fusion35-base-cap/build_salt_cavern_potentials_s_39.log
    jobid: 62
    benchmark: benchmarks/fusion35-base-cap/build_salt_cavern_potentials_s_39
    reason: Missing output files: resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 16:46:10 2024]
localrule build_clustered_population_layouts:
    input: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/pop_layout_urban.nc, resources/fusion35-base-cap/pop_layout_rural.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/pop_layout_base_s_39.csv
    log: logs/fusion35-base-cap/build_clustered_population_layouts_s_39.log
    jobid: 54
    benchmark: benchmarks/fusion35-base-cap/build_clustered_population_layouts/s_39
    reason: Missing output files: resources/fusion35-base-cap/pop_layout_base_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/pop_layout_rural.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/pop_layout_urban.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

[Mon Sep 30 16:46:13 2024]
Finished job 62.
29 of 101 steps (29%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:13 2024]
localrule build_powerplants:
    input: resources/fusion35-base-cap/networks/base_s_39.nc, data/custom_powerplants.csv
    output: resources/fusion35-base-cap/powerplants_s_39.csv
    log: logs/fusion35-base-cap/build_powerplants_s_39.log
    jobid: 44
    benchmark: benchmarks/fusion35-base-cap/build_powerplants_s_39
    reason: Missing output files: resources/fusion35-base-cap/powerplants_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/networks/base_s_39.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=7000, mem_mib=6676

[Mon Sep 30 16:46:19 2024]
Finished job 54.
30 of 101 steps (30%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:19 2024]
localrule build_district_heat_share:
    input: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    output: resources/fusion35-base-cap/district_heat_share_base_s_39_2075.csv
    log: logs/fusion35-base-cap/build_district_heat_share_39_2075.log
    jobid: 97
    reason: Missing output files: resources/fusion35-base-cap/district_heat_share_base_s_39_2075.csv; Input files updated by another job: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2075
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:pypsa.io:Imported network base_s_39.nc has buses, carriers, lines, links
INFO:powerplantmatching.collection:Retrieving data from https://raw.githubusercontent.com/PyPSA/powerplantmatching/v0.5.19/powerplants.csv
INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Mon Sep 30 16:46:21 2024]
Finished job 97.
31 of 101 steps (31%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:21 2024]
localrule build_district_heat_share:
    input: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    output: resources/fusion35-base-cap/district_heat_share_base_s_39_2035.csv
    log: logs/fusion35-base-cap/build_district_heat_share_39_2035.log
    jobid: 76
    reason: Missing output files: resources/fusion35-base-cap/district_heat_share_base_s_39_2035.csv; Input files updated by another job: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:powerplantmatching.collection:Store data at /dss/dsshome1/0C/ge87say4/.local/share/powerplantmatching/data/out/default/matched_data_red.csv
INFO:__main__:Increase district heating share by a progress factor of 45.00% resulting in new average share of 25.65%
[Mon Sep 30 16:46:24 2024]
Finished job 76.
32 of 101 steps (32%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:24 2024]
localrule build_district_heat_share:
    input: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    output: resources/fusion35-base-cap/district_heat_share_base_s_39_2055.csv
    log: logs/fusion35-base-cap/build_district_heat_share_39_2055.log
    jobid: 88
    reason: Missing output files: resources/fusion35-base-cap/district_heat_share_base_s_39_2055.csv; Input files updated by another job: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2055
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

WARNING:_helpers:Investment key 2055 not found in dictionary {2020: 0.0, 2025: 0.15, 2030: 0.3, 2035: 0.45, 2040: 0.6, 2045: 0.8, 2050: 1.0, 2060: 1.0, 2065: 1.0, 2070: 1.0, 2075: 1.0, 2080: 1.0, 2085: 1.0, 2090: 1.0, 2095: 1.0, 2100: 1.0}.
WARNING:_helpers:Interpolate linearly between the next lower and next higher year.
INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Mon Sep 30 16:46:28 2024]
Finished job 88.
33 of 101 steps (33%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:28 2024]
localrule build_industrial_distribution_key:
    input: resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/pop_layout_base_s_39.csv, data/Industrial_Database.csv, data/gem/Global-Steel-Plant-Tracker-April-2024-Standard-Copy-V1.xlsx, data/ammonia_plants.csv, data/cement-plants-noneu.csv, data/refineries-noneu.csv
    output: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv
    log: logs/fusion35-base-cap/build_industrial_distribution_key_39.log
    jobid: 71
    benchmark: benchmarks/fusion35-base-cap/build_industrial_distribution_key/s_39
    reason: Missing output files: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:35 2024]
Finished job 71.
34 of 101 steps (34%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:35 2024]
localrule build_industrial_production_per_node:
    input: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2055.csv
    output: resources/fusion35-base-cap/industrial_production_base_s_39_2055.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_node_39_2055.log
    jobid: 86
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_node/s_39_2055
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_base_s_39_2055.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2055.csv
    wildcards: clusters=39, planning_horizons=2055
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:37 2024]
Finished job 86.
35 of 101 steps (35%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:37 2024]
localrule build_industrial_production_per_node:
    input: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2035.csv
    output: resources/fusion35-base-cap/industrial_production_base_s_39_2035.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_node_39_2035.log
    jobid: 70
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_node/s_39_2035
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_base_s_39_2035.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2035.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:37 2024]
Finished job 44.
36 of 101 steps (36%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:37 2024]
localrule build_industrial_energy_demand_per_node_today:
    input: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv
    output: resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv
    log: logs/fusion35-base-cap/build_industrial_energy_demand_per_node_today_39.log
    jobid: 75
    benchmark: benchmarks/fusion35-base-cap/build_industrial_energy_demand_per_node_today/s_39
    reason: Missing output files: resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_per_country_today.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:39 2024]
Finished job 70.
37 of 101 steps (37%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:39 2024]
localrule build_industrial_production_per_node:
    input: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2075.csv
    output: resources/fusion35-base-cap/industrial_production_base_s_39_2075.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_node_39_2075.log
    jobid: 95
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_node/s_39_2075
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_base_s_39_2075.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2075.csv
    wildcards: clusters=39, planning_horizons=2075
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:39 2024]
Finished job 75.
38 of 101 steps (38%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:39 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/fusion35-base-cap/industry_sector_ratios_2055.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2055.csv, resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv
    output: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2055.csv
    log: logs/fusion35-base-cap/build_industrial_energy_demand_per_node_39_2055.log
    jobid: 84
    benchmark: benchmarks/fusion35-base-cap/build_industrial_energy_demand_per_node/s_39_2055
    reason: Missing output files: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2055.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_production_base_s_39_2055.csv, resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv, resources/fusion35-base-cap/industry_sector_ratios_2055.csv
    wildcards: clusters=39, planning_horizons=2055
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:40 2024]
Finished job 84.
39 of 101 steps (39%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:40 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/fusion35-base-cap/industry_sector_ratios_2035.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2035.csv, resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv
    output: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2035.csv
    log: logs/fusion35-base-cap/build_industrial_energy_demand_per_node_39_2035.log
    jobid: 63
    benchmark: benchmarks/fusion35-base-cap/build_industrial_energy_demand_per_node/s_39_2035
    reason: Missing output files: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2035.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2035.csv, resources/fusion35-base-cap/industry_sector_ratios_2035.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:40 2024]
Finished job 95.
40 of 101 steps (40%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:41 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/fusion35-base-cap/industry_sector_ratios_2075.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2075.csv, resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv
    output: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2075.csv
    log: logs/fusion35-base-cap/build_industrial_energy_demand_per_node_39_2075.log
    jobid: 93
    benchmark: benchmarks/fusion35-base-cap/build_industrial_energy_demand_per_node/s_39_2075
    reason: Missing output files: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2075.csv; Input files updated by another job: resources/fusion35-base-cap/industry_sector_ratios_2075.csv, resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2075.csv
    wildcards: clusters=39, planning_horizons=2075
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:41 2024]
Finished job 63.
41 of 101 steps (41%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:41 2024]
localrule build_industrial_production_per_node:
    input: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2095.csv
    output: resources/fusion35-base-cap/industrial_production_base_s_39_2095.csv
    log: logs/fusion35-base-cap/build_industrial_production_per_node_39_2095.log
    jobid: 104
    benchmark: benchmarks/fusion35-base-cap/build_industrial_production_per_node/s_39_2095
    reason: Missing output files: resources/fusion35-base-cap/industrial_production_base_s_39_2095.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_distribution_key_base_s_39.csv, resources/fusion35-base-cap/industrial_production_per_country_tomorrow_2095.csv
    wildcards: clusters=39, planning_horizons=2095
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:42 2024]
Finished job 93.
42 of 101 steps (42%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:42 2024]
localrule build_district_heat_share:
    input: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    output: resources/fusion35-base-cap/district_heat_share_base_s_39_2095.csv
    log: logs/fusion35-base-cap/build_district_heat_share_39_2095.log
    jobid: 106
    reason: Missing output files: resources/fusion35-base-cap/district_heat_share_base_s_39_2095.csv; Input files updated by another job: resources/fusion35-base-cap/district_heat_share.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    wildcards: clusters=39, planning_horizons=2095
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

[Mon Sep 30 16:46:43 2024]
Finished job 104.
43 of 101 steps (43%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:43 2024]
localrule build_industrial_energy_demand_per_node:
    input: resources/fusion35-base-cap/industry_sector_ratios_2095.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2095.csv, resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv
    output: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2095.csv
    log: logs/fusion35-base-cap/build_industrial_energy_demand_per_node_39_2095.log
    jobid: 102
    benchmark: benchmarks/fusion35-base-cap/build_industrial_energy_demand_per_node/s_39_2095
    reason: Missing output files: resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2095.csv; Input files updated by another job: resources/fusion35-base-cap/industrial_energy_demand_today_base_s_39.csv, resources/fusion35-base-cap/industrial_production_base_s_39_2095.csv, resources/fusion35-base-cap/industry_sector_ratios_2095.csv
    wildcards: clusters=39, planning_horizons=2095
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:__main__:Increase district heating share by a progress factor of 100.00% resulting in new average share of 41.39%
[Mon Sep 30 16:46:45 2024]
Finished job 102.
44 of 101 steps (44%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:45 2024]
localrule plot_power_network_clustered:
    input: resources/fusion35-base-cap/networks/base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: resources/fusion35-base-cap/maps/power-network-s-39.pdf
    jobid: 107
    benchmark: benchmarks/fusion35-base-cap/plot_power_network_clustered/base_s_39
    reason: Missing output files: resources/fusion35-base-cap/maps/power-network-s-39.pdf; Input files updated by another job: resources/fusion35-base-cap/networks/base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=4000, mem_mib=3815

[Mon Sep 30 16:46:45 2024]
Finished job 106.
45 of 101 steps (45%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:45 2024]
localrule cluster_gas_network:
    input: resources/fusion35-base-cap/gas_network.csv, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson
    output: resources/fusion35-base-cap/gas_network_base_s_39.csv
    log: logs/fusion35-base-cap/cluster_gas_network_39.log
    jobid: 29
    reason: Missing output files: resources/fusion35-base-cap/gas_network_base_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/gas_network.csv, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=4000, mem_mib=3815

INFO:pypsa.io:Imported network base_s_39.nc has buses, carriers, lines, links
[Mon Sep 30 16:46:49 2024]
Finished job 29.
46 of 101 steps (46%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:49 2024]
localrule build_population_weighted_energy_totals:
    input: resources/fusion35-base-cap/heat_totals.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    output: resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv
    log: logs/fusion35-base-cap/build_population_weighted_heat_totals_39.log
    jobid: 55
    reason: Missing output files: resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/heat_totals.csv
    wildcards: kind=heat, clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Mon Sep 30 16:46:50 2024]
Finished job 55.
47 of 101 steps (47%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:50 2024]
localrule build_shipping_demand:
    input: data/attributed_ports.json, resources/fusion35-base-cap/europe_shape.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/energy_totals.csv
    output: resources/fusion35-base-cap/shipping_demand_s_39.csv
    log: logs/fusion35-base-cap/build_shipping_demand_s_39.log
    jobid: 57
    reason: Missing output files: resources/fusion35-base-cap/shipping_demand_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/energy_totals.csv, resources/fusion35-base-cap/europe_shape.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 16:46:51 2024]
Finished job 57.
48 of 101 steps (48%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:51 2024]
localrule build_population_weighted_energy_totals:
    input: resources/fusion35-base-cap/energy_totals.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    output: resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv
    log: logs/fusion35-base-cap/build_population_weighted_energy_totals_39.log
    jobid: 50
    reason: Missing output files: resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/energy_totals.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv
    wildcards: kind=energy, clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 16:46:52 2024]
Finished job 50.
49 of 101 steps (49%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:52 2024]
localrule build_gas_input_locations:
    input: data/gem/Europe-Gas-Tracker-2024-05.xlsx, data/gas_network/scigrid-gas/data/IGGIELGN_BorderPoints.geojson, data/gas_network/scigrid-gas/data/IGGIELGN_Storages.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson
    output: resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv
    log: logs/fusion35-base-cap/build_gas_input_locations_s_39.log
    jobid: 32
    reason: Missing output files: resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv; Input files updated by another job: resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 16:46:55 2024]
Finished job 107.
50 of 101 steps (50%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:46:55 2024]
localrule build_existing_heating_distribution:
    input: data/existing_infrastructure/existing_heating_raw.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2035.csv
    output: resources/fusion35-base-cap/existing_heating_distribution_base_s_39_2035.csv
    log: logs/fusion35-base-cap/build_existing_heating_distribution_base_s_39_2035.log
    jobid: 79
    benchmark: benchmarks/fusion35-base-cap/build_existing_heating_distribution/base_s_39_2035
    reason: Missing output files: resources/fusion35-base-cap/existing_heating_distribution_base_s_39_2035.csv; Input files updated by another job: resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2035.csv, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv
    wildcards: clusters=39, planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 16:46:56 2024]
Finished job 79.
51 of 101 steps (50%) done
Select jobs to execute...
Waiting for more resources.
INFO:pyogrio._io:Created 986 records
[Mon Sep 30 16:46:57 2024]
Finished job 32.
52 of 101 steps (51%) done
Execute 1 jobs...

[Mon Sep 30 16:46:57 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, data/bundle/gebco/GEBCO_2014_2D.nc, resources/fusion35-base-cap/shipdensity_raster.tif, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/availability_matrix_39_offwind-dc.nc
    log: logs/fusion35-base-cap/determine_availability_matrix_39_offwind-dc.log
    jobid: 26
    benchmark: benchmarks/fusion35-base-cap/determine_availability_matrix_39_offwind-dc
    reason: Missing output files: resources/fusion35-base-cap/availability_matrix_39_offwind-dc.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/shipdensity_raster.tif, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-dc
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for offwind-dc...
INFO:__main__:Completed landuse availability calculation for offwind-dc (61.44s)
[Mon Sep 30 16:48:01 2024]
Finished job 26.
53 of 101 steps (52%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:48:01 2024]
localrule build_solar_thermal_profiles:
    input: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc
    log: logs/fusion35-base-cap/build_solar_thermal_profiles_total_s_39.log
    jobid: 48
    benchmark: benchmarks/fusion35-base-cap/build_solar_thermal_profiles/total_39
    reason: Missing output files: resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc; Input files updated by another job: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

[Mon Sep 30 16:54:53 2024]
Finished job 48.
54 of 101 steps (53%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:54:53 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/availability_matrix_39_solar-hsat.nc
    log: logs/fusion35-base-cap/determine_availability_matrix_39_solar-hsat.log
    jobid: 40
    benchmark: benchmarks/fusion35-base-cap/determine_availability_matrix_39_solar-hsat
    reason: Missing output files: resources/fusion35-base-cap/availability_matrix_39_solar-hsat.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar-hsat
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for solar-hsat...
INFO:__main__:Completed landuse availability calculation for solar-hsat (65.39s)
[Mon Sep 30 16:56:03 2024]
Finished job 40.
55 of 101 steps (54%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 16:56:03 2024]
localrule build_renewable_profiles:
    input: resources/fusion35-base-cap/availability_matrix_39_solar-hsat.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_39_solar-hsat.nc
    log: logs/fusion35-base-cap/build_renewable_profile_39_solar-hsat.log
    jobid: 39
    benchmark: benchmarks/fusion35-base-cap/build_renewable_profiles_39_solar-hsat
    reason: Missing output files: resources/fusion35-base-cap/profile_39_solar-hsat.nc; Input files updated by another job: resources/fusion35-base-cap/availability_matrix_39_solar-hsat.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar-hsat
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate average capacity factor for technology solar-hsat...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed average capacity factor calculation for technology solar-hsat (422.41s)
INFO:__main__:Calculate weighted capacity factor time series for model CSi for technology solar-hsat...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed weighted capacity factor time series calculation for model CSi for technology solar-hsat (422.17s)
INFO:__main__:Calculating maximal capacity per bus for technology solar-hsat
INFO:__main__:Calculate average distances for technology solar-hsat.
[Mon Sep 30 17:10:14 2024]
Finished job 39.
56 of 101 steps (55%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:10:15 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/fusion35-base-cap/country_shapes.geojson
    output: resources/fusion35-base-cap/biomass_potentials_all_39_2095.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2095.csv
    log: logs/fusion35-base-cap/build_biomass_potentials_s_39_2095.log
    jobid: 101
    benchmark: benchmarks/fusion35-base-cap/build_biomass_potentials_s_39_2095
    reason: Missing output files: resources/fusion35-base-cap/biomass_potentials_s_39_2095.csv; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, data/ENSPRESO_BIOMASS.xlsx, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, planning_horizons=2095
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:33,  2.91s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:52,  1.77s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:44,  1.57s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:38,  1.49s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:13<00:34,  1.45s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:16<00:31,  1.43s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:28,  1.41s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:25,  1.40s/ country]Build from eurostat database:  48%|████▊     | 16/33 [00:22<00:19,  1.17s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:24<00:23,  1.47s/ country]Build from eurostat database:  55%|█████▍    | 18/33 [00:25<00:17,  1.18s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:27<00:21,  1.54s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:15,  1.20s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:30<00:18,  1.57s/ country]Build from eurostat database:  67%|██████▋   | 22/33 [00:30<00:13,  1.20s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:33<00:16,  1.60s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:33<00:10,  1.19s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:12,  1.62s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:36<00:08,  1.18s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:09,  1.61s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:39<00:05,  1.19s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:41<00:06,  1.61s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:42<00:03,  1.17s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:44<00:03,  1.65s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.28s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.41s/ country]
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpz4hpmc3k.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Mon Sep 30 17:11:20 2024]
Finished job 101.
57 of 101 steps (56%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:11:20 2024]
localrule build_daily_heat_demand:
    input: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/daily_heat_demand_total_base_s_39.nc
    log: logs/fusion35-base-cap/build_daily_heat_demand_total_s_39.loc
    jobid: 46
    benchmark: benchmarks/fusion35-base-cap/build_daily_heat_demand/total_s_39
    reason: Missing output files: resources/fusion35-base-cap/daily_heat_demand_total_base_s_39.nc; Input files updated by another job: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

[Mon Sep 30 17:12:44 2024]
Finished job 46.
58 of 101 steps (57%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:12:44 2024]
localrule build_hourly_heat_demand:
    input: data/heat_load_profile_BDEW.csv, resources/fusion35-base-cap/daily_heat_demand_total_base_s_39.nc
    output: resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc
    log: logs/fusion35-base-cap/build_hourly_heat_demand_total_s_39.loc
    jobid: 45
    benchmark: benchmarks/fusion35-base-cap/build_hourly_heat_demand/total_s_39
    reason: Missing output files: resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc; Input files updated by another job: resources/fusion35-base-cap/daily_heat_demand_total_base_s_39.nc
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 17:12:49 2024]
Finished job 45.
59 of 101 steps (58%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:12:49 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/fusion35-base-cap/country_shapes.geojson
    output: resources/fusion35-base-cap/biomass_potentials_all_39_2055.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2055.csv
    log: logs/fusion35-base-cap/build_biomass_potentials_s_39_2055.log
    jobid: 83
    benchmark: benchmarks/fusion35-base-cap/build_biomass_potentials_s_39_2055
    reason: Missing output files: resources/fusion35-base-cap/biomass_potentials_s_39_2055.csv; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, data/ENSPRESO_BIOMASS.xlsx, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, planning_horizons=2055
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:34,  2.96s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:55,  1.83s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:45,  1.61s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.53s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:35,  1.49s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:32,  1.46s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:20<00:29,  1.45s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:25,  1.43s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:22,  1.43s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:20,  1.43s/ country]Build from eurostat database:  61%|██████    | 20/33 [00:28<00:15,  1.19s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:18,  1.50s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:34<00:14,  1.47s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:11,  1.45s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:08,  1.44s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:05,  1.43s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:02,  1.43s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.22s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.42s/ country]
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpm4a6uvw2.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Mon Sep 30 17:13:52 2024]
Finished job 83.
60 of 101 steps (59%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:13:52 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/fusion35-base-cap/country_shapes.geojson
    output: resources/fusion35-base-cap/biomass_potentials_all_39_2035.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2035.csv
    log: logs/fusion35-base-cap/build_biomass_potentials_s_39_2035.log
    jobid: 60
    benchmark: benchmarks/fusion35-base-cap/build_biomass_potentials_s_39_2035
    reason: Missing output files: resources/fusion35-base-cap/biomass_potentials_s_39_2035.csv; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, data/ENSPRESO_BIOMASS.xlsx, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, planning_horizons=2035
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for 2035, interpolating linearly between 2030 and 2040.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:34,  2.94s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:53,  1.78s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:44,  1.59s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.53s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:35,  1.47s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:16<00:32,  1.46s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:28,  1.44s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:25,  1.43s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:22,  1.43s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:19,  1.42s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:16,  1.42s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:33<00:14,  1.41s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:11,  1.41s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:08,  1.41s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:05,  1.41s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:02,  1.40s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.22s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.41s/ country]
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpx_si1f3z.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Mon Sep 30 17:15:05 2024]
Finished job 60.
61 of 101 steps (60%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:15:05 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/availability_matrix_39_onwind.nc
    log: logs/fusion35-base-cap/determine_availability_matrix_39_onwind.log
    jobid: 42
    benchmark: benchmarks/fusion35-base-cap/determine_availability_matrix_39_onwind
    reason: Missing output files: resources/fusion35-base-cap/availability_matrix_39_onwind.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=onwind
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for onwind...
INFO:__main__:Completed landuse availability calculation for onwind (99.21s)
[Mon Sep 30 17:16:46 2024]
Finished job 42.
62 of 101 steps (61%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:16:46 2024]
localrule build_renewable_profiles:
    input: resources/fusion35-base-cap/availability_matrix_39_onwind.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_39_onwind.nc
    log: logs/fusion35-base-cap/build_renewable_profile_39_onwind.log
    jobid: 41
    benchmark: benchmarks/fusion35-base-cap/build_renewable_profiles_39_onwind
    reason: Missing output files: resources/fusion35-base-cap/profile_39_onwind.nc; Input files updated by another job: resources/fusion35-base-cap/availability_matrix_39_onwind.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=onwind
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/distributed/node.py:187: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 38497 instead
  warnings.warn(
INFO:__main__:Calculate average capacity factor for technology onwind...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology onwind (104.61s)
INFO:__main__:Calculate weighted capacity factor time series for model Vestas_V112_3MW for technology onwind...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model Vestas_V112_3MW for technology onwind (103.13s)
INFO:__main__:Calculating maximal capacity per bus for technology onwind
INFO:__main__:Calculate average distances for technology onwind.
[Mon Sep 30 17:20:21 2024]
Finished job 41.
63 of 101 steps (62%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:20:21 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, data/bundle/gebco/GEBCO_2014_2D.nc, resources/fusion35-base-cap/shipdensity_raster.tif, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/availability_matrix_39_offwind-ac.nc
    log: logs/fusion35-base-cap/determine_availability_matrix_39_offwind-ac.log
    jobid: 7
    benchmark: benchmarks/fusion35-base-cap/determine_availability_matrix_39_offwind-ac
    reason: Missing output files: resources/fusion35-base-cap/availability_matrix_39_offwind-ac.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/shipdensity_raster.tif, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-ac
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for offwind-ac...
INFO:__main__:Completed landuse availability calculation for offwind-ac (63.15s)
[Mon Sep 30 17:21:27 2024]
Finished job 7.
64 of 101 steps (63%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:21:27 2024]
localrule build_renewable_profiles:
    input: resources/fusion35-base-cap/availability_matrix_39_offwind-ac.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_39_offwind-ac.nc
    log: logs/fusion35-base-cap/build_renewable_profile_39_offwind-ac.log
    jobid: 6
    benchmark: benchmarks/fusion35-base-cap/build_renewable_profiles_39_offwind-ac
    reason: Missing output files: resources/fusion35-base-cap/profile_39_offwind-ac.nc; Input files updated by another job: resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/availability_matrix_39_offwind-ac.nc, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-ac
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:correction_factor is set as 0.8855
INFO:__main__:Calculate average capacity factor for technology offwind-ac...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology offwind-ac (102.56s)
INFO:__main__:Calculate weighted capacity factor time series for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-ac...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-ac (103.37s)
INFO:__main__:Calculating maximal capacity per bus for technology offwind-ac
INFO:__main__:Calculate average distances for technology offwind-ac.
[Mon Sep 30 17:25:00 2024]
Finished job 6.
65 of 101 steps (64%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:25:00 2024]
localrule build_biomass_potentials:
    input: data/ENSPRESO_BIOMASS.xlsx, data/eurostat/Balances-April2023, data/nuts/NUTS_RG_03M_2013_4326_LEVL_2.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, data/bundle/nama_10r_3popgdp.tsv.gz, data/ch_cantons.csv, data/bundle/je-e-21.03.02.xls, resources/fusion35-base-cap/country_shapes.geojson
    output: resources/fusion35-base-cap/biomass_potentials_all_39_2075.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2075.csv
    log: logs/fusion35-base-cap/build_biomass_potentials_s_39_2075.log
    jobid: 92
    benchmark: benchmarks/fusion35-base-cap/build_biomass_potentials_s_39_2075
    reason: Missing output files: resources/fusion35-base-cap/biomass_potentials_s_39_2075.csv; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, data/ENSPRESO_BIOMASS.xlsx, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, planning_horizons=2075
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=1000, mem_mib=954

INFO:__main__:No biomass potentials for years after 2050, using 2050.
Build from eurostat database:   0%|          | 0/33 [00:00<?, ? country/s]Build from eurostat database:   3%|▎         | 1/33 [00:02<01:34,  2.94s/ country]Build from eurostat database:   9%|▉         | 3/33 [00:05<00:54,  1.80s/ country]Build from eurostat database:  15%|█▌        | 5/33 [00:08<00:44,  1.60s/ country]Build from eurostat database:  21%|██        | 7/33 [00:11<00:39,  1.52s/ country]Build from eurostat database:  27%|██▋       | 9/33 [00:14<00:35,  1.48s/ country]Build from eurostat database:  30%|███       | 10/33 [00:14<00:27,  1.19s/ country]Build from eurostat database:  33%|███▎      | 11/33 [00:17<00:33,  1.54s/ country]Build from eurostat database:  39%|███▉      | 13/33 [00:19<00:29,  1.49s/ country]Build from eurostat database:  45%|████▌     | 15/33 [00:22<00:26,  1.46s/ country]Build from eurostat database:  52%|█████▏    | 17/33 [00:25<00:23,  1.44s/ country]Build from eurostat database:  58%|█████▊    | 19/33 [00:28<00:20,  1.44s/ country]Build from eurostat database:  64%|██████▎   | 21/33 [00:31<00:17,  1.43s/ country]Build from eurostat database:  70%|██████▉   | 23/33 [00:33<00:14,  1.42s/ country]Build from eurostat database:  73%|███████▎  | 24/33 [00:34<00:10,  1.19s/ country]Build from eurostat database:  76%|███████▌  | 25/33 [00:36<00:11,  1.48s/ country]Build from eurostat database:  79%|███████▉  | 26/33 [00:36<00:08,  1.17s/ country]Build from eurostat database:  82%|████████▏ | 27/33 [00:39<00:09,  1.54s/ country]Build from eurostat database:  85%|████████▍ | 28/33 [00:39<00:05,  1.17s/ country]Build from eurostat database:  88%|████████▊ | 29/33 [00:42<00:06,  1.58s/ country]Build from eurostat database:  91%|█████████ | 30/33 [00:42<00:03,  1.18s/ country]Build from eurostat database:  94%|█████████▍| 31/33 [00:45<00:03,  1.63s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.23s/ country]Build from eurostat database: 100%|██████████| 33/33 [00:46<00:00,  1.41s/ country]
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpbz32650x.build_biomass_potentials.py:338: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df = df.join(df_wo_ch.filter(like="unsustainable")).fillna(0)
[Mon Sep 30 17:26:03 2024]
Finished job 92.
66 of 101 steps (65%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:26:03 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/availability_matrix_39_solar.nc
    log: logs/fusion35-base-cap/determine_availability_matrix_39_solar.log
    jobid: 38
    benchmark: benchmarks/fusion35-base-cap/determine_availability_matrix_39_solar
    reason: Missing output files: resources/fusion35-base-cap/availability_matrix_39_solar.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for solar...
INFO:__main__:Completed landuse availability calculation for solar (66.46s)
[Mon Sep 30 17:27:11 2024]
Finished job 38.
67 of 101 steps (66%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:27:11 2024]
localrule build_renewable_profiles:
    input: resources/fusion35-base-cap/availability_matrix_39_solar.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_39_solar.nc
    log: logs/fusion35-base-cap/build_renewable_profile_39_solar.log
    jobid: 37
    benchmark: benchmarks/fusion35-base-cap/build_renewable_profiles_39_solar
    reason: Missing output files: resources/fusion35-base-cap/profile_39_solar.nc; Input files updated by another job: resources/fusion35-base-cap/availability_matrix_39_solar.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=solar
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate average capacity factor for technology solar...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed average capacity factor calculation for technology solar (410.11s)
INFO:__main__:Calculate weighted capacity factor time series for model CSi for technology solar...
INFO:atlite.convert:Convert and aggregate 'pv'.
INFO:__main__:Completed weighted capacity factor time series calculation for model CSi for technology solar (413.27s)
INFO:__main__:Calculating maximal capacity per bus for technology solar
INFO:__main__:Calculate average distances for technology solar.
[Mon Sep 30 17:41:02 2024]
Finished job 37.
68 of 101 steps (67%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:41:02 2024]
localrule determine_availability_matrix:
    input: data/bundle/corine/g250_clc06_V18_5.tif, data/bundle/natura/natura.tiff, data/bundle/gebco/GEBCO_2014_2D.nc, resources/fusion35-base-cap/shipdensity_raster.tif, resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/availability_matrix_39_offwind-float.nc
    log: logs/fusion35-base-cap/determine_availability_matrix_39_offwind-float.log
    jobid: 28
    benchmark: benchmarks/fusion35-base-cap/determine_availability_matrix_39_offwind-float
    reason: Missing output files: resources/fusion35-base-cap/availability_matrix_39_offwind-float.nc; Input files updated by another job: resources/fusion35-base-cap/country_shapes.geojson, resources/fusion35-base-cap/regions_offshore_base_s_39.geojson, resources/fusion35-base-cap/shipdensity_raster.tif, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-float
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:Calculate landuse availability for offwind-float...
INFO:__main__:Completed landuse availability calculation for offwind-float (70.16s)
[Mon Sep 30 17:42:35 2024]
Finished job 28.
69 of 101 steps (68%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:42:35 2024]
localrule build_renewable_profiles:
    input: resources/fusion35-base-cap/availability_matrix_39_offwind-float.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_39_offwind-float.nc
    log: logs/fusion35-base-cap/build_renewable_profile_39_offwind-float.log
    jobid: 27
    benchmark: benchmarks/fusion35-base-cap/build_renewable_profiles_39_offwind-float
    reason: Missing output files: resources/fusion35-base-cap/profile_39_offwind-float.nc; Input files updated by another job: resources/fusion35-base-cap/availability_matrix_39_offwind-float.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-float
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:correction_factor is set as 0.8855
INFO:__main__:Calculate average capacity factor for technology offwind-float...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology offwind-float (102.55s)
INFO:__main__:Calculate weighted capacity factor time series for model NREL_ReferenceTurbine_5MW_offshore for technology offwind-float...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model NREL_ReferenceTurbine_5MW_offshore for technology offwind-float (103.08s)
INFO:__main__:Calculating maximal capacity per bus for technology offwind-float
INFO:__main__:Calculate average distances for technology offwind-float.
[Mon Sep 30 17:46:10 2024]
Finished job 27.
70 of 101 steps (69%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:46:10 2024]
localrule build_renewable_profiles:
    input: resources/fusion35-base-cap/availability_matrix_39_offwind-dc.nc, resources/fusion35-base-cap/offshore_shapes.geojson, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/profile_39_offwind-dc.nc
    log: logs/fusion35-base-cap/build_renewable_profile_39_offwind-dc.log
    jobid: 25
    benchmark: benchmarks/fusion35-base-cap/build_renewable_profiles_39_offwind-dc
    reason: Missing output files: resources/fusion35-base-cap/profile_39_offwind-dc.nc; Input files updated by another job: resources/fusion35-base-cap/availability_matrix_39_offwind-dc.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/offshore_shapes.geojson
    wildcards: clusters=39, technology=offwind-dc
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

INFO:__main__:correction_factor is set as 0.8855
INFO:__main__:Calculate average capacity factor for technology offwind-dc...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed average capacity factor calculation for technology offwind-dc (101.92s)
INFO:__main__:Calculate weighted capacity factor time series for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-dc...
INFO:atlite.convert:Convert and aggregate 'wind'.
INFO:__main__:Completed weighted capacity factor time series calculation for model NREL_ReferenceTurbine_2020ATB_5.5MW for technology offwind-dc (103.45s)
INFO:__main__:Calculating maximal capacity per bus for technology offwind-dc
INFO:__main__:Calculate average distances for technology offwind-dc.
[Mon Sep 30 17:49:44 2024]
Finished job 25.
71 of 101 steps (70%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:49:44 2024]
localrule build_temperature_profiles:
    input: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, cutouts/europe-2013-sarah3-era5.nc
    output: resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc
    log: logs/fusion35-base-cap/build_temperature_profiles_total_s_39.log
    jobid: 59
    benchmark: benchmarks/fusion35-base-cap/build_temperature_profiles/total_39
    reason: Missing output files: resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc; Input files updated by another job: resources/fusion35-base-cap/pop_layout_total.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

[Mon Sep 30 17:52:46 2024]
Finished job 59.
72 of 101 steps (71%) done
Select jobs to execute...
Execute 2 jobs...

[Mon Sep 30 17:52:46 2024]
localrule add_electricity:
    input: resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/profile_hydro.nc, data/nuclear_p_max_pu.csv, resources/fusion35-base-cap/networks/base_s_39.nc, resources/fusion35-base-cap/costs_2030.csv, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/powerplants_s_39.csv, data/hydro_capacities.csv, data/unit_commitment.csv, resources/fusion35-base-cap/electricity_demand_base_s.nc, resources/fusion35-base-cap/busmap_base_s_39.csv
    output: resources/fusion35-base-cap/networks/base_s_39_elec.nc
    log: logs/fusion35-base-cap/add_electricity_39.log
    jobid: 36
    benchmark: benchmarks/fusion35-base-cap/add_electricity_39
    reason: Missing output files: resources/fusion35-base-cap/networks/base_s_39_elec.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/networks/base_s_39.nc, resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/powerplants_s_39.csv, resources/fusion35-base-cap/electricity_demand_base_s.nc, resources/fusion35-base-cap/profile_hydro.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

[Mon Sep 30 17:52:46 2024]
localrule build_central_heating_temperature_profiles:
    input: resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: resources/fusion35-base-cap/central_heating_forward_temperature_profiles_base_s_39.nc, resources/fusion35-base-cap/central_heating_return_temperature_profiles_base_s_39.nc
    log: logs/fusion35-base-cap/build_central_heating_temperature_profiles_s_39.log
    jobid: 78
    benchmark: benchmarks/fusion35-base-cap/build_central_heating_temperature_profiles/s_39
    reason: Missing output files: resources/fusion35-base-cap/central_heating_forward_temperature_profiles_base_s_39.nc, resources/fusion35-base-cap/central_heating_return_temperature_profiles_base_s_39.nc; Input files updated by another job: resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

[Mon Sep 30 17:52:50 2024]
Finished job 78.
73 of 101 steps (72%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:52:50 2024]
localrule build_cop_profiles:
    input: resources/fusion35-base-cap/central_heating_forward_temperature_profiles_base_s_39.nc, resources/fusion35-base-cap/central_heating_return_temperature_profiles_base_s_39.nc, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: resources/fusion35-base-cap/cop_profiles_base_s_39.nc
    log: logs/fusion35-base-cap/build_cop_profiles_s_39.log
    jobid: 77
    benchmark: benchmarks/fusion35-base-cap/build_cop_profiles/s_39
    reason: Missing output files: resources/fusion35-base-cap/cop_profiles_base_s_39.nc; Input files updated by another job: resources/fusion35-base-cap/central_heating_forward_temperature_profiles_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson, resources/fusion35-base-cap/central_heating_return_temperature_profiles_base_s_39.nc
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=20000, mem_mib=19074

[Mon Sep 30 17:52:52 2024]
Finished job 77.
74 of 101 steps (73%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:52:52 2024]
localrule build_transport_demand:
    input: resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/transport_data.csv, data/bundle/emobility/KFZ__count, data/bundle/emobility/Pkw__count, resources/fusion35-base-cap/temp_air_total_base_s_39.nc
    output: resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv
    log: logs/fusion35-base-cap/build_transport_demand_s_39.log
    jobid: 58
    reason: Missing output files: resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv; Input files updated by another job: resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/transport_data.csv
    wildcards: clusters=39
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 17:52:57 2024]
Finished job 58.
75 of 101 steps (74%) done
INFO:pypsa.io:Imported network base_s_39.nc has buses, carriers, lines, links
INFO:__main__:Load data scaled by factor 1.0.
INFO:__main__:Adding 117 generators with capacities [GW]pp 
carrier
CCGT          194.06
OCGT            0.05
biomass        21.47
coal           66.74
geothermal      0.06
lignite        51.18
nuclear       110.66
oil             3.40
Name: p_nom, dtype: float64
INFO:__main__:Added connection cost of 2477-61731 Eur/MW/a to offwind-float
INFO:__main__:Added connection cost of 2783-21962 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 10695-41095 Eur/MW/a to offwind-dc
WARNING:__main__:Assuming max_hours=6 for hydro reservoirs in the countries: AL, ME, MK, XK
INFO:__main__:Skipping renewable capacity estimation because they are added later in rule `add_existing_baseyear` with foresight mode 'myopic'.
ERROR:pypsa.io:Error, new components for Carrier are not unique
WARNING:__main__:tech_colors for carriers [''] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_elec.nc' contains: stores, carriers, lines, links, loads, buses, storage_units, generators
[Mon Sep 30 17:53:15 2024]
Finished job 36.
76 of 101 steps (75%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:53:15 2024]
localrule prepare_network:
    input: resources/fusion35-base-cap/networks/base_s_39_elec.nc, resources/fusion35-base-cap/costs_2030.csv
    output: resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc
    log: logs/fusion35-base-cap/prepare_network_base_s_39_elec_lvopt_.log
    jobid: 35
    benchmark: benchmarks/fusion35-base-cap/prepare_network_base_s_39_elec_lvopt_
    reason: Missing output files: resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc; Input files updated by another job: resources/fusion35-base-cap/networks/base_s_39_elec.nc
    wildcards: clusters=39, ll=vopt, opts=
    resources: tmpdir=/tmp/ge87say4, mem_mb=4000, mem_mib=3815

INFO:pypsa.io:Imported network base_s_39_elec.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:N-1 security margin of lines set to 0.7
INFO:__main__:Limiting line extensions to 20000 MW
INFO:__main__:Limiting link extensions to 30000 MW
INFO:pypsa.io:Exported network 'base_s_39_elec_lvopt_.nc' contains: carriers, loads, generators, buses, storage_units, stores, links, lines
[Mon Sep 30 17:53:19 2024]
Finished job 35.
77 of 101 steps (76%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:53:19 2024]
localrule time_aggregation:
    input: resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc
    output: resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv
    log: logs/fusion35-base-cap/time_aggregation_base_s_39_elec_lvopt__.log
    jobid: 34
    benchmark: benchmarks/fusion35-base-cap/time_aggregation_base_s_39_elec_lvopt__
    reason: Missing output files: resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv; Input files updated by another job: resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=
    resources: tmpdir=/tmp/ge87say4, mem_mb=5000, mem_mib=4769

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Averaging every 3h hours
[Mon Sep 30 17:53:23 2024]
Finished job 34.
78 of 101 steps (77%) done
Select jobs to execute...
Execute 2 jobs...

[Mon Sep 30 17:53:23 2024]
localrule prepare_sector_network:
    input: resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2055.csv, resources/fusion35-base-cap/costs_2055.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2055.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2055.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2055.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2055.nc
    log: results/fusion35-base-cap/logs/prepare_sector_network_base_s_39_lvopt___2055.log
    jobid: 82
    benchmark: results/fusion35-base-cap/benchmarks/prepare_sector_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2055.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2055.csv, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/biomass_potentials_s_39_2055.csv, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/district_heat_share_base_s_39_2055.csv, resources/fusion35-base-cap/co2_totals.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2055.csv, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 17:53:23 2024]
localrule prepare_sector_network:
    input: resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2075.csv, resources/fusion35-base-cap/costs_2075.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2075.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2075.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2075.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2075.nc
    log: results/fusion35-base-cap/logs/prepare_sector_network_base_s_39_lvopt___2075.log
    jobid: 91
    benchmark: results/fusion35-base-cap/benchmarks/prepare_sector_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2075.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2075.csv, resources/fusion35-base-cap/co2_totals.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/district_heat_share_base_s_39_2075.csv, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2075.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/biomass_potentials_s_39_2075.csv, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing storage_units with carrier ['H2', 'battery']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Removing storage_units with carrier ['H2', 'battery']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Adding electricity generation
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:Add land transport
INFO:__main__:Add land transport
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add heat sector
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add biomass
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding fusion generation.
INFO:__main__:Adding fusion generation.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmp7x4y8og0.prepare_sector_network.py:4343: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpg3sv_f3i.prepare_sector_network.py:4343: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral air heat pump', 'rural biomass boiler', 'rural water tanks charger', 'urban decentral biomass boiler', 'rural water tanks discharger', 'rural resistive heater', 'urban decentral resistive heater', 'rural ground heat pump', 'rural gas boiler', 'rural air heat pump', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'urban decentral gas boiler'] not defined in config.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'rural biomass boiler', 'urban decentral resistive heater', 'rural resistive heater', 'rural water tanks charger', 'urban decentral water tanks discharger', 'rural water tanks discharger', 'rural air heat pump', 'urban decentral biomass boiler', 'urban decentral water tanks charger', 'urban decentral gas boiler', 'urban decentral air heat pump', 'rural ground heat pump', 'rural gas boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: loads, generators, lines, stores, global_constraints, buses, carriers, links, storage_units
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: loads, storage_units, stores, generators, links, buses, global_constraints, lines, carriers
[Mon Sep 30 17:53:37 2024]
Finished job 82.
79 of 101 steps (78%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:53:37 2024]
localrule prepare_sector_network:
    input: resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2095.csv, resources/fusion35-base-cap/costs_2095.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2095.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2095.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2095.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2095.nc
    log: results/fusion35-base-cap/logs/prepare_sector_network_base_s_39_lvopt___2095.log
    jobid: 100
    benchmark: results/fusion35-base-cap/benchmarks/prepare_sector_network/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2095.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc, resources/fusion35-base-cap/biomass_potentials_s_39_2095.csv, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2095.csv, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2095.csv, resources/fusion35-base-cap/co2_totals.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2095.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 17:53:37 2024]
Finished job 91.
80 of 101 steps (79%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:53:37 2024]
localrule prepare_sector_network:
    input: resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, data/eurostat/Balances-April2023, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/co2_totals.csv, data/bundle/eea/UNFCCC_v23.csv, resources/fusion35-base-cap/biomass_potentials_s_39_2035.csv, resources/fusion35-base-cap/costs_2035.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2035.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2035.csv, resources/fusion35-base-cap/district_heat_share_base_s_39_2035.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2035.nc
    log: results/fusion35-base-cap/logs/prepare_sector_network_base_s_39_lvopt___2035.log
    jobid: 5
    benchmark: results/fusion35-base-cap/benchmarks/prepare_sector_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2035.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/solar_thermal_total_base_s_39.nc, resources/fusion35-base-cap/temp_air_total_base_s_39.nc, resources/fusion35-base-cap/industrial_production_base_s_39_2035.csv, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/biomass_potentials_s_39_2035.csv, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/co2_totals.csv, resources/fusion35-base-cap/transport_demand_s_39.csv, resources/fusion35-base-cap/shipping_demand_s_39.csv, resources/fusion35-base-cap/pop_weighted_heat_totals_s_39.csv, resources/fusion35-base-cap/industrial_energy_demand_base_s_39_2035.csv, resources/fusion35-base-cap/hourly_heat_demand_total_base_s_39.nc, resources/fusion35-base-cap/district_heat_share_base_s_39_2035.csv, resources/fusion35-base-cap/gas_input_locations_s_39_simplified.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/transport_data_s_39.csv, resources/fusion35-base-cap/salt_cavern_potentials_s_39.csv, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/networks/base_s_39_elec_lvopt_.nc, resources/fusion35-base-cap/gas_network_base_s_39.csv, resources/fusion35-base-cap/dsm_profile_s_39.csv, resources/fusion35-base-cap/gas_input_locations_s_39.geojson, resources/fusion35-base-cap/avail_profile_s_39.csv, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/snapshot_weightings_base_s_39_elec_lvopt__.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/temp_soil_total_base_s_39.nc, resources/fusion35-base-cap/pop_weighted_energy_totals_s_39.csv, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing storage_units with carrier ['H2', 'battery']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
INFO:pypsa.io:Imported network base_s_39_elec_lvopt_.nc has buses, carriers, generators, lines, links, loads, storage_units, stores
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Removing buses with carrier ['H2', 'battery']
INFO:__main__:Removing links with carrier ['H2 electrolysis', 'H2 fuel cell', 'battery charger', 'battery discharger']
INFO:__main__:Removing generators with carrier ['CCGT', 'OCGT', 'biomass', 'coal', 'geothermal', 'lignite', 'oil']
INFO:__main__:Removing storage_units with carrier ['H2', 'battery']
INFO:__main__:Removing stores with carrier ['H2', 'battery']
INFO:__main__:Adding electricity generation
INFO:__main__:Added connection cost of 8556-32876 Eur/MW/a to offwind-dc
INFO:__main__:Added connection cost of 2226-17570 Eur/MW/a to offwind-ac
INFO:__main__:Added connection cost of 1982-49385 Eur/MW/a to offwind-float
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU oil refining'], dtype='object')
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
WARNING:pypsa.components:Bus has no attribute location, ignoring this passed value.
INFO:__main__:Add land transport
INFO:__main__:Adding electricity generation
INFO:__main__:Add hydrogen storage
INFO:__main__:Adding hydrogen fuel cell for re-electrification.
INFO:__main__:Add hydrogen underground storage
INFO:__main__:Add options for new hydrogen pipelines.
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 100%
INFO:__main__:ice share: 0%
INFO:__main__:Add land transport
INFO:__main__:Add heat sector
INFO:__main__:fuel_cell share: 0%
INFO:__main__:electric share: 45.0%
INFO:__main__:ice share: 55.00000000000001%
INFO:__main__:Assumed space heat reduction of 29.00%
INFO:__main__:Add heat sector
INFO:__main__:Assumed space heat reduction of 11.00%
INFO:__main__:Add biomass
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add biomass
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add methanol
INFO:__main__:Add industrial demand
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding fusion generation.
WARNING:pypsa.io:The following Link have buses which are not defined:
Index(['EU naphtha for industry'], dtype='object')
INFO:__main__:Add possibility to use industrial waste heat in district heating
INFO:__main__:Add agriculture, forestry and fishing sector.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.0
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Adding fusion generation.
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmpj563p0kl.prepare_sector_network.py:4343: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:__main__:Cluster residential and service heat buses.
INFO:__main__:Adding CO2 budget limit as per unit of 1990 levels of 0.15
INFO:__main__:Limiting new HVAC and HVDC extensions to 20000 MW
INFO:__main__:Deducting distribution losses from electricity demand: 3.0%
INFO:__main__:Inserting gas distribution grid with investment cost factor of 1.0
INFO:__main__:Specified losses for DC transmission (static: 0.98, per 1000km: 0.977, compression per 1000km: 0). Splitting bidirectional links.
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/scripts/tmp8w8m_rr0.prepare_sector_network.py:4343: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  n.links["reversed"] = n.links["reversed"].fillna(False).infer_objects(copy=False)
INFO:__main__:Specified losses for H2 pipeline transmission (static: 1, per 1000km: 1, compression per 1000km: 0.018). Splitting bidirectional links.
INFO:__main__:Specified losses for electricity distribution grid transmission (static: 0.97, per 1000km: 1, compression per 1000km: 0). Splitting bidirectional links.
INFO:__main__:Removing 0 line(s) with properties conflicting with transmission losses functionality.
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: global_constraints, links, stores, buses, lines, storage_units, carriers, generators, loads
INFO:prepare_network:Modify capital_cost of electricity distribution grid by factor 1.0 
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural solar thermal', 'rural water tanks', 'urban decentral heat', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral resistive heater', 'rural resistive heater', 'rural air heat pump', 'urban decentral gas boiler', 'rural water tanks charger', 'urban decentral biomass boiler', 'urban decentral water tanks charger', 'rural biomass boiler', 'rural water tanks discharger', 'urban decentral air heat pump', 'urban decentral water tanks discharger', 'rural gas boiler', 'rural ground heat pump'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: stores, links, loads, storage_units, global_constraints, lines, generators, carriers, buses
[Mon Sep 30 17:53:48 2024]
Finished job 5.
81 of 101 steps (80%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:53:48 2024]
localrule add_existing_baseyear:
    input: results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/powerplants_s_39.csv, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/costs_2035.csv, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/existing_heating_distribution_base_s_39_2035.csv, resources/fusion35-base-cap/heating_efficiencies.csv
    output: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2035.nc
    log: results/fusion35-base-cap/logs/add_existing_baseyear_base_s_39_lvopt___2035.log
    jobid: 4
    benchmark: results/fusion35-base-cap/benchmarks/add_existing_baseyear/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2035.nc; Input files updated by another job: resources/fusion35-base-cap/cop_profiles_base_s_39.nc, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/heating_efficiencies.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, resources/fusion35-base-cap/pop_layout_base_s_39.csv, resources/fusion35-base-cap/powerplants_s_39.csv, resources/fusion35-base-cap/existing_heating_distribution_base_s_39_2035.csv, resources/fusion35-base-cap/busmap_base_s.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    resources: tmpdir=/tmp/ge87say4, mem_mb=2000, mem_mib=1908

[Mon Sep 30 17:53:49 2024]
Finished job 100.
82 of 101 steps (81%) done
INFO:pypsa.io:Imported network base_s_39_lvopt___2035.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
WARNING:__main__:There are 1 assets with build year after last power grouping year 2025. These assets are dropped and not considered.Consider to redefine the grouping years to keep them.
INFO:prepare_sector_network:Cluster residential and service heat buses.
WARNING:add_electricity:tech_colors for carriers ['', 'none', 'rural air heat pump', 'rural biomass boiler', 'rural gas boiler', 'rural ground heat pump', 'rural resistive heater', 'rural solar thermal', 'rural water tanks', 'rural water tanks charger', 'rural water tanks discharger', 'urban decentral air heat pump', 'urban decentral biomass boiler', 'urban decentral gas boiler', 'urban decentral heat', 'urban decentral resistive heater', 'urban decentral solar thermal', 'urban decentral water tanks', 'urban decentral water tanks charger', 'urban decentral water tanks discharger', 'rural oil boiler', 'urban decentral oil boiler'] not defined in config.
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: buses, storage_units, loads, links, stores, generators, global_constraints, lines, carriers
[Mon Sep 30 17:54:06 2024]
Finished job 4.
83 of 101 steps (82%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 17:54:06 2024]
localrule solve_sector_network_myopic:
    input: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/costs_2035.csv
    output: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, results/fusion35-base-cap/configs/config.base_s_39_lvopt___2035.yaml
    log: results/fusion35-base-cap/logs/base_s_39_lvopt___2035_solver.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2035_memory.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2035_python.log
    jobid: 3
    benchmark: results/fusion35-base-cap/benchmarks/solve_sector_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc; Input files updated by another job: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2035.nc
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=30000, mem_mib=28611, runtime=360

host: teramem2
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/shadow/tmp2hbbe0as/.snakemake/scripts/tmpk7cj5fx8.solve_network.py:568: SyntaxWarning: invalid escape sequence '\.'
  float_regex = "[0-9]*\.?[0-9]+"
INFO:pypsa.io:Imported network base_s_39_lvopt___2035.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
WARNING:__main__:Existing capacities larger than technical potential for Index(['BE0 0 offwind-ac-2035', 'DE0 0 offwind-ac-2035',
       'GB4 0 offwind-ac-2035', 'NL0 0 offwind-ac-2035', 'ES2 0 solar-2035',
       'FR6 0 solar-2035', 'ES2 0 onwind-2035'],
      dtype='object', name='Generator'),                        adjust technical potential to existing capacities
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=33094) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency4', 'efficiency3', 'efficiency2'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['y', 'x'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency4', 'efficiency3', 'efficiency2'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['y', 'x'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
INFO:__main__:Adding solar potential constraint.
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.model:Solver logs written to `results/fusion35-base-cap/logs/base_s_39_lvopt___2035_solver.log`.
INFO:linopy.model:Solver options:
 - threads: 8
 - method: 2
 - crossover: 0
 - BarConvTol: 1e-06
 - Seed: 123
 - AggFill: 0
 - PreDual: 0
 - GURO_PAR_BARDENSETHRESH: 200
INFO:linopy.io:Writing objective.
Writing constraints.:   0%|[38;2;128;191;255m          [0m| 0/43 [00:00<?, ?it/s]Writing constraints.:  21%|[38;2;128;191;255m██        [0m| 9/43 [00:02<00:08,  3.99it/s]Writing constraints.:  23%|[38;2;128;191;255m██▎       [0m| 10/43 [00:04<00:17,  1.86it/s]Writing constraints.:  26%|[38;2;128;191;255m██▌       [0m| 11/43 [00:07<00:28,  1.14it/s]Writing constraints.:  28%|[38;2;128;191;255m██▊       [0m| 12/43 [00:11<00:45,  1.47s/it]Writing constraints.:  30%|[38;2;128;191;255m███       [0m| 13/43 [00:12<00:41,  1.39s/it]Writing constraints.:  33%|[38;2;128;191;255m███▎      [0m| 14/43 [00:13<00:38,  1.33s/it]Writing constraints.:  35%|[38;2;128;191;255m███▍      [0m| 15/43 [00:16<00:51,  1.83s/it]Writing constraints.:  37%|[38;2;128;191;255m███▋      [0m| 16/43 [00:20<01:01,  2.27s/it]Writing constraints.:  40%|[38;2;128;191;255m███▉      [0m| 17/43 [00:33<02:19,  5.35s/it]Writing constraints.:  42%|[38;2;128;191;255m████▏     [0m| 18/43 [00:54<04:04,  9.77s/it]Writing constraints.:  44%|[38;2;128;191;255m████▍     [0m| 19/43 [00:55<02:50,  7.09s/it]Writing constraints.:  47%|[38;2;128;191;255m████▋     [0m| 20/43 [00:55<01:57,  5.11s/it]Writing constraints.:  49%|[38;2;128;191;255m████▉     [0m| 21/43 [00:57<01:30,  4.10s/it]Writing constraints.:  51%|[38;2;128;191;255m█████     [0m| 22/43 [00:59<01:17,  3.67s/it]Writing constraints.:  53%|[38;2;128;191;255m█████▎    [0m| 23/43 [01:00<00:53,  2.70s/it]Writing constraints.:  56%|[38;2;128;191;255m█████▌    [0m| 24/43 [01:00<00:38,  2.01s/it]Writing constraints.:  58%|[38;2;128;191;255m█████▊    [0m| 25/43 [01:01<00:27,  1.51s/it]Writing constraints.:  60%|[38;2;128;191;255m██████    [0m| 26/43 [01:01<00:19,  1.17s/it]Writing constraints.:  63%|[38;2;128;191;255m██████▎   [0m| 27/43 [01:01<00:14,  1.08it/s]Writing constraints.:  65%|[38;2;128;191;255m██████▌   [0m| 28/43 [01:02<00:11,  1.32it/s]Writing constraints.:  67%|[38;2;128;191;255m██████▋   [0m| 29/43 [01:19<01:20,  5.76s/it]Writing constraints.:  70%|[38;2;128;191;255m██████▉   [0m| 30/43 [01:46<02:36, 12.01s/it]Writing constraints.:  72%|[38;2;128;191;255m███████▏  [0m| 31/43 [01:46<01:43,  8.59s/it]Writing constraints.:  74%|[38;2;128;191;255m███████▍  [0m| 32/43 [01:47<01:09,  6.35s/it]Writing constraints.:  77%|[38;2;128;191;255m███████▋  [0m| 33/43 [01:52<00:57,  5.80s/it]Writing constraints.:  79%|[38;2;128;191;255m███████▉  [0m| 34/43 [01:52<00:37,  4.21s/it]Writing constraints.:  81%|[38;2;128;191;255m████████▏ [0m| 35/43 [01:53<00:25,  3.20s/it]Writing constraints.:  84%|[38;2;128;191;255m████████▎ [0m| 36/43 [01:54<00:17,  2.49s/it]Writing constraints.:  86%|[38;2;128;191;255m████████▌ [0m| 37/43 [01:55<00:11,  2.00s/it]Writing constraints.:  88%|[38;2;128;191;255m████████▊ [0m| 38/43 [01:56<00:08,  1.65s/it]Writing constraints.: 100%|[38;2;128;191;255m██████████[0m| 43/43 [01:56<00:00,  2.70s/it]
Writing continuous variables.:   0%|[38;2;128;191;255m          [0m| 0/15 [00:00<?, ?it/s]Writing continuous variables.:  33%|[38;2;128;191;255m███▎      [0m| 5/15 [00:02<00:05,  1.86it/s]Writing continuous variables.:  40%|[38;2;128;191;255m████      [0m| 6/15 [00:02<00:04,  2.08it/s]Writing continuous variables.:  47%|[38;2;128;191;255m████▋     [0m| 7/15 [00:11<00:18,  2.34s/it]Writing continuous variables.:  53%|[38;2;128;191;255m█████▎    [0m| 8/15 [00:12<00:14,  2.01s/it]Writing continuous variables.:  60%|[38;2;128;191;255m██████    [0m| 9/15 [00:12<00:09,  1.52s/it]Writing continuous variables.:  67%|[38;2;128;191;255m██████▋   [0m| 10/15 [00:12<00:05,  1.16s/it]Writing continuous variables.:  73%|[38;2;128;191;255m███████▎  [0m| 11/15 [00:12<00:03,  1.12it/s]Writing continuous variables.:  80%|[38;2;128;191;255m████████  [0m| 12/15 [00:12<00:02,  1.49it/s]Writing continuous variables.:  87%|[38;2;128;191;255m████████▋ [0m| 13/15 [00:13<00:01,  1.29it/s]Writing continuous variables.:  93%|[38;2;128;191;255m█████████▎[0m| 14/15 [00:14<00:00,  1.59it/s]Writing continuous variables.: 100%|[38;2;128;191;255m██████████[0m| 15/15 [00:14<00:00,  1.05it/s]
INFO:linopy.io: Writing time: 142.04s
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 11352490 primals, 24043509 duals
Objective: 7.05e+11
Solver model: available
Solver message: 2

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Generator-ext-p-lower, Generator-ext-p-upper, Line-ext-s-lower, Line-ext-s-upper, Link-fix-p-lower, Link-fix-p-upper, Link-ext-p-lower, Link-ext-p-upper, Store-fix-e-lower, Store-fix-e-upper, Store-ext-e-lower, Store-ext-e-upper, StorageUnit-fix-p_dispatch-lower, StorageUnit-fix-p_dispatch-upper, StorageUnit-fix-p_store-lower, StorageUnit-fix-p_store-upper, StorageUnit-fix-state_of_charge-lower, StorageUnit-fix-state_of_charge-upper, Kirchhoff-Voltage-Law, StorageUnit-energy_balance, Store-energy_balance, Line-loss_upper, Line-loss_tangents-1--1, Line-loss_tangents-1-1, Line-loss_tangents-2--1, Line-loss_tangents-2-1, solar_potential were not assigned to the network.
INFO:__main__:Maximum memory usage: (27880.46484375, 1727722893.7344384)
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2035.nc' contains: global_constraints, storage_units, loads, carriers, stores, links, generators, buses, lines
[Mon Sep 30 21:04:35 2024]
Finished job 3.
84 of 101 steps (83%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 21:04:35 2024]
localrule plot_hydrogen_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2035.pdf
    log: results/fusion35-base-cap/logs/plot_hydrogen_network/base_s_39_lvopt___2035.log
    jobid: 112
    benchmark: results/fusion35-base-cap/benchmarks/plot_hydrogen_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2035.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s_39_lvopt___2035.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Mon Sep 30 21:05:22 2024]
Finished job 112.
85 of 101 steps (84%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 21:05:22 2024]
localrule add_brownfield:
    input: resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2055.nc, results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/costs_2055.csv, resources/fusion35-base-cap/cop_profiles_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2055.nc
    log: results/fusion35-base-cap/logs/add_brownfield_base_s_39_lvopt___2055.log
    jobid: 81
    benchmark: results/fusion35-base-cap/benchmarks/add_brownfield/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2055.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/busmap_base_s.csv, results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:__main__:Preparing brownfield from the file results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc
INFO:pypsa.io:Imported network base_s_39_lvopt___2055.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:pypsa.io:Imported network base_s_39_lvopt___2035.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:__main__:Preparing brownfield for the year 2055
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: links, lines, generators, buses, global_constraints, loads, carriers, storage_units, stores
[Mon Sep 30 21:05:28 2024]
Finished job 81.
86 of 101 steps (85%) done
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 30 21:05:28 2024]
localrule solve_sector_network_myopic:
    input: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/costs_2055.csv
    output: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, results/fusion35-base-cap/configs/config.base_s_39_lvopt___2055.yaml
    log: results/fusion35-base-cap/logs/base_s_39_lvopt___2055_solver.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2055_memory.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2055_python.log
    jobid: 80
    benchmark: results/fusion35-base-cap/benchmarks/solve_sector_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc; Input files updated by another job: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2055.nc
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=30000, mem_mib=28611, runtime=360

host: teramem2
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/shadow/tmpap9_fim5/.snakemake/scripts/tmpfr0ts_x5.solve_network.py:568: SyntaxWarning: invalid escape sequence '\.'
  float_regex = "[0-9]*\.?[0-9]+"
INFO:pypsa.io:Imported network base_s_39_lvopt___2055.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
WARNING:__main__:Existing capacities larger than technical potential for Index(['ES2 0 solar-2055'], dtype='object', name='Generator'),                        adjust technical potential to existing capacities
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=66988) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index(['IE4 0 CCGT-2015', 'IT5 0 CCGT-2015', 'AT0 0 CCGT-2020',
       'DE0 0 CCGT-2020', 'ES0 0 CCGT-2020', 'FR0 0 CCGT-2020',
       'GB3 0 CCGT-2020', 'HU0 0 CCGT-2020', 'NL0 0 CCGT-2020',
       'PL0 0 CCGT-2020', 'RO0 0 CCGT-2020', 'DE0 0 CCGT-2025',
       'FR0 0 CCGT-2025', 'GB3 0 CCGT-2025', 'GR0 0 CCGT-2025',
       'HR0 0 CCGT-2025', 'IE4 0 CCGT-2025', 'IT0 0 CCGT-2025',
       'NL0 0 CCGT-2025', 'PL0 0 CCGT-2025', 'RO0 0 CCGT-2025',
       'RS0 0 CCGT-2025', 'SI0 0 CCGT-2025'],
      dtype='object', name='Link')
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency3', 'efficiency4', 'efficiency2'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['x', 'y'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
WARNING:pypsa.consistency:The following links have carriers which are not defined:
Index(['IE4 0 CCGT-2015', 'IT5 0 CCGT-2015', 'AT0 0 CCGT-2020',
       'DE0 0 CCGT-2020', 'ES0 0 CCGT-2020', 'FR0 0 CCGT-2020',
       'GB3 0 CCGT-2020', 'HU0 0 CCGT-2020', 'NL0 0 CCGT-2020',
       'PL0 0 CCGT-2020', 'RO0 0 CCGT-2020', 'DE0 0 CCGT-2025',
       'FR0 0 CCGT-2025', 'GB3 0 CCGT-2025', 'GR0 0 CCGT-2025',
       'HR0 0 CCGT-2025', 'IE4 0 CCGT-2025', 'IT0 0 CCGT-2025',
       'NL0 0 CCGT-2025', 'PL0 0 CCGT-2025', 'RO0 0 CCGT-2025',
       'RS0 0 CCGT-2025', 'SI0 0 CCGT-2025'],
      dtype='object', name='Link')
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency3', 'efficiency4', 'efficiency2'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['x', 'y'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
INFO:__main__:Adding solar potential constraint.
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.model:Solver logs written to `results/fusion35-base-cap/logs/base_s_39_lvopt___2055_solver.log`.
INFO:linopy.model:Solver options:
 - threads: 8
 - method: 2
 - crossover: 0
 - BarConvTol: 1e-06
 - Seed: 123
 - AggFill: 0
 - PreDual: 0
 - GURO_PAR_BARDENSETHRESH: 200
INFO:linopy.io:Writing objective.
Writing constraints.:   0%|[38;2;128;191;255m          [0m| 0/43 [00:00<?, ?it/s]Writing constraints.:  21%|[38;2;128;191;255m██        [0m| 9/43 [00:01<00:04,  8.19it/s]Writing constraints.:  23%|[38;2;128;191;255m██▎       [0m| 10/43 [00:02<00:08,  3.83it/s]Writing constraints.:  26%|[38;2;128;191;255m██▌       [0m| 11/43 [00:04<00:20,  1.57it/s]Writing constraints.:  28%|[38;2;128;191;255m██▊       [0m| 12/43 [00:08<00:38,  1.25s/it]Writing constraints.:  30%|[38;2;128;191;255m███       [0m| 13/43 [00:09<00:36,  1.21s/it]Writing constraints.:  33%|[38;2;128;191;255m███▎      [0m| 14/43 [00:10<00:34,  1.18s/it]Writing constraints.:  35%|[38;2;128;191;255m███▍      [0m| 15/43 [00:12<00:38,  1.36s/it]Writing constraints.:  37%|[38;2;128;191;255m███▋      [0m| 16/43 [00:14<00:41,  1.53s/it]Writing constraints.:  40%|[38;2;128;191;255m███▉      [0m| 17/43 [00:27<02:02,  4.72s/it]Writing constraints.:  42%|[38;2;128;191;255m████▏     [0m| 18/43 [00:48<03:50,  9.21s/it]Writing constraints.:  44%|[38;2;128;191;255m████▍     [0m| 19/43 [00:49<02:42,  6.77s/it]Writing constraints.:  47%|[38;2;128;191;255m████▋     [0m| 20/43 [00:49<01:54,  4.98s/it]Writing constraints.:  49%|[38;2;128;191;255m████▉     [0m| 21/43 [00:51<01:27,  4.00s/it]Writing constraints.:  51%|[38;2;128;191;255m█████     [0m| 22/43 [00:54<01:15,  3.60s/it]Writing constraints.:  53%|[38;2;128;191;255m█████▎    [0m| 23/43 [00:54<00:52,  2.64s/it]Writing constraints.:  56%|[38;2;128;191;255m█████▌    [0m| 24/43 [00:54<00:37,  1.96s/it]Writing constraints.:  58%|[38;2;128;191;255m█████▊    [0m| 25/43 [00:55<00:26,  1.48s/it]Writing constraints.:  60%|[38;2;128;191;255m██████    [0m| 26/43 [00:55<00:19,  1.15s/it]Writing constraints.:  63%|[38;2;128;191;255m██████▎   [0m| 27/43 [00:55<00:14,  1.10it/s]Writing constraints.:  65%|[38;2;128;191;255m██████▌   [0m| 28/43 [00:56<00:11,  1.34it/s]Writing constraints.:  67%|[38;2;128;191;255m██████▋   [0m| 29/43 [01:11<01:11,  5.10s/it]Writing constraints.:  70%|[38;2;128;191;255m██████▉   [0m| 30/43 [01:35<02:17, 10.60s/it]Writing constraints.:  72%|[38;2;128;191;255m███████▏  [0m| 31/43 [01:35<01:31,  7.61s/it]Writing constraints.:  74%|[38;2;128;191;255m███████▍  [0m| 32/43 [01:36<01:02,  5.64s/it]Writing constraints.:  77%|[38;2;128;191;255m███████▋  [0m| 33/43 [01:41<00:54,  5.47s/it]Writing constraints.:  79%|[38;2;128;191;255m███████▉  [0m| 34/43 [01:42<00:35,  3.98s/it]Writing constraints.:  81%|[38;2;128;191;255m████████▏ [0m| 35/43 [01:43<00:24,  3.03s/it]Writing constraints.:  84%|[38;2;128;191;255m████████▎ [0m| 36/43 [01:43<00:16,  2.38s/it]Writing constraints.:  86%|[38;2;128;191;255m████████▌ [0m| 37/43 [01:44<00:11,  1.91s/it]Writing constraints.:  88%|[38;2;128;191;255m████████▊ [0m| 38/43 [01:45<00:07,  1.58s/it]Writing constraints.: 100%|[38;2;128;191;255m██████████[0m| 43/43 [01:45<00:00,  2.46s/it]
Writing continuous variables.:   0%|[38;2;128;191;255m          [0m| 0/15 [00:00<?, ?it/s]Writing continuous variables.:  33%|[38;2;128;191;255m███▎      [0m| 5/15 [00:02<00:04,  2.45it/s]Writing continuous variables.:  40%|[38;2;128;191;255m████      [0m| 6/15 [00:02<00:03,  2.65it/s]Writing continuous variables.:  47%|[38;2;128;191;255m████▋     [0m| 7/15 [00:09<00:16,  2.07s/it]Writing continuous variables.:  53%|[38;2;128;191;255m█████▎    [0m| 8/15 [00:10<00:12,  1.85s/it]Writing continuous variables.:  60%|[38;2;128;191;255m██████    [0m| 9/15 [00:11<00:08,  1.41s/it]Writing continuous variables.:  67%|[38;2;128;191;255m██████▋   [0m| 10/15 [00:11<00:05,  1.07s/it]Writing continuous variables.:  73%|[38;2;128;191;255m███████▎  [0m| 11/15 [00:11<00:03,  1.21it/s]Writing continuous variables.:  80%|[38;2;128;191;255m████████  [0m| 12/15 [00:11<00:01,  1.60it/s]Writing continuous variables.:  87%|[38;2;128;191;255m████████▋ [0m| 13/15 [00:12<00:01,  1.24it/s]Writing continuous variables.:  93%|[38;2;128;191;255m█████████▎[0m| 14/15 [00:13<00:00,  1.55it/s]Writing continuous variables.: 100%|[38;2;128;191;255m██████████[0m| 15/15 [00:13<00:00,  1.14it/s]
INFO:linopy.io: Writing time: 129.2s
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 10523207 primals, 22236026 duals
Objective: 1.47e+11
Solver model: available
Solver message: 2

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Generator-ext-p-lower, Generator-ext-p-upper, Line-ext-s-lower, Line-ext-s-upper, Link-fix-p-lower, Link-fix-p-upper, Link-ext-p-lower, Link-ext-p-upper, Store-fix-e-lower, Store-fix-e-upper, Store-ext-e-lower, Store-ext-e-upper, StorageUnit-fix-p_dispatch-lower, StorageUnit-fix-p_dispatch-upper, StorageUnit-fix-p_store-lower, StorageUnit-fix-p_store-upper, StorageUnit-fix-state_of_charge-lower, StorageUnit-fix-state_of_charge-upper, Kirchhoff-Voltage-Law, StorageUnit-energy_balance, Store-energy_balance, Line-loss_upper, Line-loss_tangents-1--1, Line-loss_tangents-1-1, Line-loss_tangents-2--1, Line-loss_tangents-2-1, solar_potential were not assigned to the network.
INFO:__main__:Maximum memory usage: (26893.9609375, 1727738784.4434528)
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2055.nc' contains: carriers, lines, generators, storage_units, buses, stores, global_constraints, links, loads
[Tue Oct  1 01:29:06 2024]
Finished job 80.
87 of 101 steps (86%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 01:29:06 2024]
localrule plot_hydrogen_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2055.pdf
    log: results/fusion35-base-cap/logs/plot_hydrogen_network/base_s_39_lvopt___2055.log
    jobid: 113
    benchmark: results/fusion35-base-cap/benchmarks/plot_hydrogen_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2055.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s_39_lvopt___2055.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Tue Oct  1 01:30:18 2024]
Finished job 113.
88 of 101 steps (87%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 01:30:18 2024]
localrule add_brownfield:
    input: resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2075.nc, results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/costs_2075.csv, resources/fusion35-base-cap/cop_profiles_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2075.nc
    log: results/fusion35-base-cap/logs/add_brownfield_base_s_39_lvopt___2075.log
    jobid: 90
    benchmark: results/fusion35-base-cap/benchmarks/add_brownfield/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2075.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_onwind.nc, results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:__main__:Preparing brownfield from the file results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc
INFO:pypsa.io:Imported network base_s_39_lvopt___2075.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:pypsa.io:Imported network base_s_39_lvopt___2055.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:__main__:Preparing brownfield for the year 2075
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: loads, carriers, stores, lines, buses, links, generators, storage_units, global_constraints
[Tue Oct  1 01:30:25 2024]
Finished job 90.
89 of 101 steps (88%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 01:30:25 2024]
localrule plot_power_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-costs-all_2035.pdf
    log: results/fusion35-base-cap/logs/plot_power_network/base_s_39_lvopt___2035.log
    jobid: 108
    benchmark: results/fusion35-base-cap/benchmarks/plot_power_network/base_s_39_lvopt___2035
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-costs-all_2035.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2035.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2035
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s_39_lvopt___2035.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:__main__:Dropping non-buses ['', 'EU agriculture', 'EU biogas', 'EU coal', 'EU industry', 'EU kerosene', 'EU land', 'EU lignite', 'EU methanol', 'EU naphtha', 'EU oil', 'EU process', 'EU shipping', 'EU solid', 'EU uranium', 'H2 pipeline', 'gas for', 'process', 'solid']
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Tue Oct  1 01:30:40 2024]
Finished job 108.
90 of 101 steps (89%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 01:30:40 2024]
localrule solve_sector_network_myopic:
    input: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/costs_2075.csv
    output: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, results/fusion35-base-cap/configs/config.base_s_39_lvopt___2075.yaml
    log: results/fusion35-base-cap/logs/base_s_39_lvopt___2075_solver.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2075_memory.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2075_python.log
    jobid: 89
    benchmark: results/fusion35-base-cap/benchmarks/solve_sector_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc; Input files updated by another job: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2075.nc
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=30000, mem_mib=28611, runtime=360

host: teramem2
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/shadow/tmpkwuo0b5u/.snakemake/scripts/tmp6twnx775.solve_network.py:568: SyntaxWarning: invalid escape sequence '\.'
  float_regex = "[0-9]*\.?[0-9]+"
INFO:pypsa.io:Imported network base_s_39_lvopt___2075.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=112116) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency4', 'efficiency2', 'efficiency3'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['y', 'x'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency4', 'efficiency2', 'efficiency3'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['y', 'x'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
INFO:__main__:Adding solar potential constraint.
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.model:Solver logs written to `results/fusion35-base-cap/logs/base_s_39_lvopt___2075_solver.log`.
INFO:linopy.model:Solver options:
 - threads: 8
 - method: 2
 - crossover: 0
 - BarConvTol: 1e-06
 - Seed: 123
 - AggFill: 0
 - PreDual: 0
 - GURO_PAR_BARDENSETHRESH: 200
INFO:linopy.io:Writing objective.
Writing constraints.:   0%|[38;2;128;191;255m          [0m| 0/43 [00:00<?, ?it/s]Writing constraints.:  21%|[38;2;128;191;255m██        [0m| 9/43 [00:00<00:01, 17.22it/s]Writing constraints.:  26%|[38;2;128;191;255m██▌       [0m| 11/43 [00:03<00:13,  2.41it/s]Writing constraints.:  28%|[38;2;128;191;255m██▊       [0m| 12/43 [00:07<00:28,  1.08it/s]Writing constraints.:  30%|[38;2;128;191;255m███       [0m| 13/43 [00:08<00:28,  1.04it/s]Writing constraints.:  33%|[38;2;128;191;255m███▎      [0m| 14/43 [00:09<00:28,  1.01it/s]Writing constraints.:  35%|[38;2;128;191;255m███▍      [0m| 15/43 [00:11<00:29,  1.07s/it]Writing constraints.:  37%|[38;2;128;191;255m███▋      [0m| 16/43 [00:12<00:31,  1.17s/it]Writing constraints.:  40%|[38;2;128;191;255m███▉      [0m| 17/43 [00:25<01:51,  4.27s/it]Writing constraints.:  42%|[38;2;128;191;255m████▏     [0m| 18/43 [00:46<03:37,  8.72s/it]Writing constraints.:  44%|[38;2;128;191;255m████▍     [0m| 19/43 [00:47<02:34,  6.46s/it]Writing constraints.:  47%|[38;2;128;191;255m████▋     [0m| 20/43 [00:47<01:49,  4.75s/it]Writing constraints.:  49%|[38;2;128;191;255m████▉     [0m| 21/43 [00:49<01:24,  3.84s/it]Writing constraints.:  51%|[38;2;128;191;255m█████     [0m| 22/43 [00:51<01:12,  3.47s/it]Writing constraints.:  53%|[38;2;128;191;255m█████▎    [0m| 23/43 [00:52<00:51,  2.56s/it]Writing constraints.:  56%|[38;2;128;191;255m█████▌    [0m| 24/43 [00:52<00:36,  1.91s/it]Writing constraints.:  58%|[38;2;128;191;255m█████▊    [0m| 25/43 [00:52<00:25,  1.44s/it]Writing constraints.:  60%|[38;2;128;191;255m██████    [0m| 26/43 [00:53<00:19,  1.12s/it]Writing constraints.:  63%|[38;2;128;191;255m██████▎   [0m| 27/43 [00:53<00:14,  1.13it/s]Writing constraints.:  65%|[38;2;128;191;255m██████▌   [0m| 28/43 [00:54<00:11,  1.35it/s]Writing constraints.:  67%|[38;2;128;191;255m██████▋   [0m| 29/43 [01:09<01:13,  5.27s/it]Writing constraints.:  70%|[38;2;128;191;255m██████▉   [0m| 30/43 [01:29<02:04,  9.58s/it]Writing constraints.:  72%|[38;2;128;191;255m███████▏  [0m| 31/43 [01:30<01:22,  6.89s/it]Writing constraints.:  74%|[38;2;128;191;255m███████▍  [0m| 32/43 [01:31<00:56,  5.15s/it]Writing constraints.:  77%|[38;2;128;191;255m███████▋  [0m| 33/43 [01:36<00:50,  5.04s/it]Writing constraints.:  79%|[38;2;128;191;255m███████▉  [0m| 34/43 [01:36<00:33,  3.67s/it]Writing constraints.:  81%|[38;2;128;191;255m████████▏ [0m| 35/43 [01:37<00:22,  2.82s/it]Writing constraints.:  84%|[38;2;128;191;255m████████▎ [0m| 36/43 [01:38<00:15,  2.22s/it]Writing constraints.:  86%|[38;2;128;191;255m████████▌ [0m| 37/43 [01:39<00:10,  1.81s/it]Writing constraints.:  88%|[38;2;128;191;255m████████▊ [0m| 38/43 [01:39<00:07,  1.52s/it]Writing constraints.: 100%|[38;2;128;191;255m██████████[0m| 43/43 [01:39<00:00,  2.32s/it]
Writing continuous variables.:   0%|[38;2;128;191;255m          [0m| 0/15 [00:00<?, ?it/s]Writing continuous variables.:  33%|[38;2;128;191;255m███▎      [0m| 5/15 [00:01<00:03,  2.84it/s]Writing continuous variables.:  40%|[38;2;128;191;255m████      [0m| 6/15 [00:02<00:02,  3.01it/s]Writing continuous variables.:  47%|[38;2;128;191;255m████▋     [0m| 7/15 [00:09<00:15,  1.97s/it]Writing continuous variables.:  53%|[38;2;128;191;255m█████▎    [0m| 8/15 [00:10<00:12,  1.75s/it]Writing continuous variables.:  60%|[38;2;128;191;255m██████    [0m| 9/15 [00:10<00:08,  1.33s/it]Writing continuous variables.:  67%|[38;2;128;191;255m██████▋   [0m| 10/15 [00:10<00:05,  1.02s/it]Writing continuous variables.:  73%|[38;2;128;191;255m███████▎  [0m| 11/15 [00:10<00:03,  1.26it/s]Writing continuous variables.:  80%|[38;2;128;191;255m████████  [0m| 12/15 [00:10<00:01,  1.67it/s]Writing continuous variables.:  87%|[38;2;128;191;255m████████▋ [0m| 13/15 [00:12<00:01,  1.33it/s]Writing continuous variables.:  93%|[38;2;128;191;255m█████████▎[0m| 14/15 [00:12<00:00,  1.65it/s]Writing continuous variables.: 100%|[38;2;128;191;255m██████████[0m| 15/15 [00:12<00:00,  1.21it/s]
INFO:linopy.io: Writing time: 121.85s
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 9883727 primals, 21024226 duals
Objective: 4.80e+11
Solver model: available
Solver message: 2

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Generator-ext-p-lower, Generator-ext-p-upper, Line-ext-s-lower, Line-ext-s-upper, Link-fix-p-lower, Link-fix-p-upper, Link-ext-p-lower, Link-ext-p-upper, Store-fix-e-lower, Store-fix-e-upper, Store-ext-e-lower, Store-ext-e-upper, StorageUnit-fix-p_dispatch-lower, StorageUnit-fix-p_dispatch-upper, StorageUnit-fix-p_store-lower, StorageUnit-fix-p_store-upper, StorageUnit-fix-state_of_charge-lower, StorageUnit-fix-state_of_charge-upper, Kirchhoff-Voltage-Law, StorageUnit-energy_balance, Store-energy_balance, Line-loss_upper, Line-loss_tangents-1--1, Line-loss_tangents-1-1, Line-loss_tangents-2--1, Line-loss_tangents-2-1, solar_potential were not assigned to the network.
INFO:__main__:Maximum memory usage: (25606.140625, 1727755265.2147877)
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2075.nc' contains: global_constraints, links, stores, carriers, storage_units, loads, lines, generators, buses
[Tue Oct  1 06:03:45 2024]
Finished job 89.
91 of 101 steps (90%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 06:03:46 2024]
localrule plot_power_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-costs-all_2075.pdf
    log: results/fusion35-base-cap/logs/plot_power_network/base_s_39_lvopt___2075.log
    jobid: 110
    benchmark: results/fusion35-base-cap/benchmarks/plot_power_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-costs-all_2075.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s_39_lvopt___2075.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:__main__:Dropping non-buses ['', 'EU agriculture', 'EU biogas', 'EU coal', 'EU industry', 'EU kerosene', 'EU lignite', 'EU methanol', 'EU naphtha', 'EU oil', 'EU process', 'EU shipping', 'EU solid', 'EU uranium', 'H2 pipeline', 'gas for', 'process', 'solid']
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Tue Oct  1 06:04:33 2024]
Finished job 110.
92 of 101 steps (91%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 06:04:33 2024]
localrule plot_hydrogen_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2075.pdf
    log: results/fusion35-base-cap/logs/plot_hydrogen_network/base_s_39_lvopt___2075.log
    jobid: 114
    benchmark: results/fusion35-base-cap/benchmarks/plot_hydrogen_network/base_s_39_lvopt___2075
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2075.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2075
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s_39_lvopt___2075.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Tue Oct  1 06:04:45 2024]
Finished job 114.
93 of 101 steps (92%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 06:04:45 2024]
localrule plot_power_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-costs-all_2055.pdf
    log: results/fusion35-base-cap/logs/plot_power_network/base_s_39_lvopt___2055.log
    jobid: 109
    benchmark: results/fusion35-base-cap/benchmarks/plot_power_network/base_s_39_lvopt___2055
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-costs-all_2055.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2055.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2055
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:pypsa.io:Imported network base_s_39_lvopt___2055.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:__main__:Dropping non-buses ['', 'EU agriculture', 'EU biogas', 'EU coal', 'EU industry', 'EU kerosene', 'EU lignite', 'EU methanol', 'EU naphtha', 'EU oil', 'EU process', 'EU shipping', 'EU solid', 'EU uranium', 'H2 pipeline', 'gas for', 'process', 'solid']
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/site-packages/cartopy/mpl/feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as "never".
  warnings.warn('facecolor will have no effect as it has been '
[Tue Oct  1 06:04:59 2024]
Finished job 109.
94 of 101 steps (93%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 06:04:59 2024]
localrule add_brownfield:
    input: resources/fusion35-base-cap/profile_39_solar.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2095.nc, results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/costs_2095.csv, resources/fusion35-base-cap/cop_profiles_base_s_39.nc
    output: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2095.nc
    log: results/fusion35-base-cap/logs/add_brownfield_base_s_39_lvopt___2095.log
    jobid: 99
    benchmark: results/fusion35-base-cap/benchmarks/add_brownfield/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2095.nc; Input files updated by another job: resources/fusion35-base-cap/profile_39_offwind-dc.nc, resources/fusion35-base-cap/profile_39_onwind.nc, resources/fusion35-base-cap/profile_39_solar-hsat.nc, resources/fusion35-base-cap/profile_39_offwind-float.nc, results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc, resources/fusion35-base-cap/profile_39_solar.nc, results/fusion35-base-cap/prenetworks/base_s_39_lvopt___2095.nc, resources/fusion35-base-cap/profile_39_offwind-ac.nc, resources/fusion35-base-cap/cop_profiles_base_s_39.nc, resources/fusion35-base-cap/busmap_base_s.csv, resources/fusion35-base-cap/busmap_base_s_39.csv
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

INFO:__main__:Preparing brownfield from the file results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2075.nc
INFO:pypsa.io:Imported network base_s_39_lvopt___2095.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:pypsa.io:Imported network base_s_39_lvopt___2075.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
INFO:__main__:Preparing brownfield for the year 2095
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: links, stores, storage_units, global_constraints, generators, carriers, lines, buses, loads
[Tue Oct  1 06:05:05 2024]
Finished job 99.
95 of 101 steps (94%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 06:05:05 2024]
localrule solve_sector_network_myopic:
    input: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2095.nc, resources/fusion35-base-cap/costs_2095.csv
    output: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2095.nc, results/fusion35-base-cap/configs/config.base_s_39_lvopt___2095.yaml
    log: results/fusion35-base-cap/logs/base_s_39_lvopt___2095_solver.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2095_memory.log, results/fusion35-base-cap/logs/base_s_39_lvopt___2095_python.log
    jobid: 98
    benchmark: results/fusion35-base-cap/benchmarks/solve_sector_network/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2095.nc; Input files updated by another job: results/fusion35-base-cap/prenetworks-brownfield/base_s_39_lvopt___2095.nc
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=30000, mem_mib=28611, runtime=360

host: teramem2
/dss/dsshome1/0C/ge87say4/pypsa-eur-current/.snakemake/shadow/tmpqxteuoy2/.snakemake/scripts/tmpphwsp762.solve_network.py:568: SyntaxWarning: invalid escape sequence '\.'
  float_regex = "[0-9]*\.?[0-9]+"
INFO:pypsa.io:Imported network base_s_39_lvopt___2095.nc has buses, carriers, generators, global_constraints, lines, links, loads, storage_units, stores
/dss/dsshome1/0C/ge87say4/miniforge3/envs/pypsa-eur/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=158451) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency4', 'efficiency2', 'efficiency3'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['y', 'x'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['efficiency4', 'efficiency2', 'efficiency3'] of component 'Link'.
WARNING:pypsa.consistency:Encountered nan's in static data for columns ['y', 'x'] of component 'Bus'.
WARNING:pypsa.consistency:The following buses have no attached components, which can break the lopf:
{'EU'}
INFO:__main__:Adding solar potential constraint.
INFO:linopy.model: Solve problem using Gurobi solver
INFO:linopy.model:Solver logs written to `results/fusion35-base-cap/logs/base_s_39_lvopt___2095_solver.log`.
INFO:linopy.model:Solver options:
 - threads: 8
 - method: 2
 - crossover: 0
 - BarConvTol: 1e-06
 - Seed: 123
 - AggFill: 0
 - PreDual: 0
 - GURO_PAR_BARDENSETHRESH: 200
INFO:linopy.io:Writing objective.
Writing constraints.:   0%|[38;2;128;191;255m          [0m| 0/43 [00:00<?, ?it/s]Writing constraints.:  21%|[38;2;128;191;255m██        [0m| 9/43 [00:00<00:02, 13.32it/s]Writing constraints.:  26%|[38;2;128;191;255m██▌       [0m| 11/43 [00:03<00:14,  2.26it/s]Writing constraints.:  28%|[38;2;128;191;255m██▊       [0m| 12/43 [00:07<00:28,  1.07it/s]Writing constraints.:  30%|[38;2;128;191;255m███       [0m| 13/43 [00:08<00:28,  1.05it/s]Writing constraints.:  33%|[38;2;128;191;255m███▎      [0m| 14/43 [00:09<00:28,  1.02it/s]Writing constraints.:  35%|[38;2;128;191;255m███▍      [0m| 15/43 [00:11<00:33,  1.19s/it]Writing constraints.:  37%|[38;2;128;191;255m███▋      [0m| 16/43 [00:13<00:37,  1.39s/it]Writing constraints.:  40%|[38;2;128;191;255m███▉      [0m| 17/43 [00:26<01:53,  4.35s/it]Writing constraints.:  42%|[38;2;128;191;255m████▏     [0m| 18/43 [00:47<03:37,  8.71s/it]Writing constraints.:  44%|[38;2;128;191;255m████▍     [0m| 19/43 [00:48<02:36,  6.51s/it]Writing constraints.:  47%|[38;2;128;191;255m████▋     [0m| 20/43 [00:48<01:51,  4.85s/it]Writing constraints.:  49%|[38;2;128;191;255m████▉     [0m| 21/43 [00:50<01:26,  3.92s/it]Writing constraints.:  51%|[38;2;128;191;255m█████     [0m| 22/43 [00:53<01:14,  3.54s/it]Writing constraints.:  53%|[38;2;128;191;255m█████▎    [0m| 23/43 [00:53<00:52,  2.60s/it]Writing constraints.:  56%|[38;2;128;191;255m█████▌    [0m| 24/43 [00:53<00:36,  1.94s/it]Writing constraints.:  58%|[38;2;128;191;255m█████▊    [0m| 25/43 [00:54<00:26,  1.47s/it]Writing constraints.:  60%|[38;2;128;191;255m██████    [0m| 26/43 [00:54<00:19,  1.13s/it]Writing constraints.:  63%|[38;2;128;191;255m██████▎   [0m| 27/43 [00:54<00:14,  1.11it/s]Writing constraints.:  65%|[38;2;128;191;255m██████▌   [0m| 28/43 [00:55<00:11,  1.36it/s]Writing constraints.:  67%|[38;2;128;191;255m██████▋   [0m| 29/43 [01:08<01:03,  4.51s/it]Writing constraints.:  70%|[38;2;128;191;255m██████▉   [0m| 30/43 [01:34<02:21, 10.91s/it]Writing constraints.:  72%|[38;2;128;191;255m███████▏  [0m| 31/43 [01:34<01:33,  7.82s/it]Writing constraints.:  74%|[38;2;128;191;255m███████▍  [0m| 32/43 [01:36<01:03,  5.79s/it]Writing constraints.:  77%|[38;2;128;191;255m███████▋  [0m| 33/43 [01:41<00:56,  5.62s/it]Writing constraints.:  79%|[38;2;128;191;255m███████▉  [0m| 34/43 [01:41<00:36,  4.08s/it]Writing constraints.:  81%|[38;2;128;191;255m████████▏ [0m| 35/43 [01:42<00:24,  3.10s/it]Writing constraints.:  84%|[38;2;128;191;255m████████▎ [0m| 36/43 [01:43<00:16,  2.42s/it]Writing constraints.:  86%|[38;2;128;191;255m████████▌ [0m| 37/43 [01:44<00:11,  1.94s/it]Writing constraints.:  88%|[38;2;128;191;255m████████▊ [0m| 38/43 [01:45<00:08,  1.61s/it]Writing constraints.: 100%|[38;2;128;191;255m██████████[0m| 43/43 [01:45<00:00,  2.44s/it]
Writing continuous variables.:   0%|[38;2;128;191;255m          [0m| 0/15 [00:00<?, ?it/s]Writing continuous variables.:  33%|[38;2;128;191;255m███▎      [0m| 5/15 [00:01<00:03,  2.75it/s]Writing continuous variables.:  40%|[38;2;128;191;255m████      [0m| 6/15 [00:02<00:03,  2.92it/s]Writing continuous variables.:  47%|[38;2;128;191;255m████▋     [0m| 7/15 [00:09<00:16,  2.03s/it]Writing continuous variables.:  53%|[38;2;128;191;255m█████▎    [0m| 8/15 [00:10<00:12,  1.83s/it]Writing continuous variables.:  60%|[38;2;128;191;255m██████    [0m| 9/15 [00:10<00:08,  1.39s/it]Writing continuous variables.:  67%|[38;2;128;191;255m██████▋   [0m| 10/15 [00:11<00:05,  1.07s/it]Writing continuous variables.:  73%|[38;2;128;191;255m███████▎  [0m| 11/15 [00:11<00:03,  1.22it/s]Writing continuous variables.:  80%|[38;2;128;191;255m████████  [0m| 12/15 [00:11<00:01,  1.61it/s]Writing continuous variables.:  87%|[38;2;128;191;255m████████▋ [0m| 13/15 [00:12<00:01,  1.26it/s]Writing continuous variables.:  93%|[38;2;128;191;255m█████████▎[0m| 14/15 [00:12<00:00,  1.56it/s]Writing continuous variables.: 100%|[38;2;128;191;255m██████████[0m| 15/15 [00:12<00:00,  1.16it/s]
INFO:linopy.io: Writing time: 127.96s
INFO:linopy.constants: Optimization successful: 
Status: ok
Termination condition: optimal
Solution: 10426847 primals, 22014106 duals
Objective: 1.43e+11
Solver model: available
Solver message: 2

INFO:pypsa.optimization.optimize:The shadow-prices of the constraints Generator-fix-p-lower, Generator-fix-p-upper, Generator-ext-p-lower, Generator-ext-p-upper, Line-ext-s-lower, Line-ext-s-upper, Link-fix-p-lower, Link-fix-p-upper, Link-ext-p-lower, Link-ext-p-upper, Store-fix-e-lower, Store-fix-e-upper, Store-ext-e-lower, Store-ext-e-upper, StorageUnit-fix-p_dispatch-lower, StorageUnit-fix-p_dispatch-upper, StorageUnit-fix-p_store-lower, StorageUnit-fix-p_store-upper, StorageUnit-fix-state_of_charge-lower, StorageUnit-fix-state_of_charge-upper, Kirchhoff-Voltage-Law, StorageUnit-energy_balance, Store-energy_balance, Line-loss_upper, Line-loss_tangents-1--1, Line-loss_tangents-1-1, Line-loss_tangents-2--1, Line-loss_tangents-2-1, solar_potential were not assigned to the network.
INFO:__main__:Maximum memory usage: (28022.16796875, 1727781209.002935)
INFO:pypsa.io:Exported network 'base_s_39_lvopt___2095.nc' contains: lines, storage_units, carriers, loads, global_constraints, links, buses, stores, generators
[Tue Oct  1 13:16:15 2024]
Finished job 98.
96 of 101 steps (95%) done
Select jobs to execute...
Execute 1 jobs...

[Tue Oct  1 13:16:15 2024]
localrule plot_hydrogen_network:
    input: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2095.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    output: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2095.pdf
    log: results/fusion35-base-cap/logs/plot_hydrogen_network/base_s_39_lvopt___2095.log
    jobid: 115
    benchmark: results/fusion35-base-cap/benchmarks/plot_hydrogen_network/base_s_39_lvopt___2095
    reason: Missing output files: results/fusion35-base-cap/maps/base_s_39_lvopt__-h2_network_2095.pdf; Input files updated by another job: results/fusion35-base-cap/postnetworks/base_s_39_lvopt___2095.nc, resources/fusion35-base-cap/regions_onshore_base_s_39.geojson
    wildcards: clusters=39, ll=vopt, opts=, sector_opts=, planning_horizons=2095
    threads: 2
    resources: tmpdir=/tmp/ge87say4, mem_mb=10000, mem_mib=9537

